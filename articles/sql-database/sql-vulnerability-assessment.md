---
title: Sårbarhetsbedömning för SQL
description: Lär dig hur du konfigurerar SQL Vulnerability Assessment på Azure SQL Database och tolkar utvärderingsrapporterna.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 04/19/2020
tags: azure-synapse
ms.openlocfilehash: 80629898b56f81fc738cb30df63766ea39adea6d
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 04/21/2020
ms.locfileid: "81684258"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>SQL Vulnerability Assessment hjälper dig att identifiera databassäkerhetsproblem

SQL Vulnerability Assessment är en lättkonfigurerad tjänst som kan identifiera, spåra och hjälpa dig att åtgärda potentiella databassäkerhetsproblem. Du kan använda den för att proaktivt förbättra din databassäkerhet.

Sårbarhetsbedömning är en del av [erbjudandet advanced data security,](sql-database-advanced-data-security.md) som är ett enhetligt paket för avancerade SQL-säkerhetsfunktioner. Sårbarhetsbedömning kan nås och hanteras via den centrala SQL Advanced Data Security-portalen.

> [!NOTE]
> Sårbarhetsbedömning stöds för Azure SQL Database, Azure SQL Database-hanterad instans och Azure Synapse Analytics. För enkelhetens skull används SQL Database i den här artikeln när du refererar till någon av dessa hanterade databastjänster.

## <a name="vulnerability-assessment"></a>Sårbarhetsbedömning

SQL Vulnerability Assessment är en tjänst som ger insyn i ditt säkerhetstillstånd. Sårbarhetsbedömning innehåller åtgärder som kan vidtas för att lösa säkerhetsproblem och förbättra databassäkerheten. Det kan hjälpa dig: 

- Uppfylla efterlevnadskrav som kräver databassökningsrapporter.
- Uppfylla standarder för datasekretess.
- Övervaka en dynamisk databasmiljö där ändringar är svåra att spåra.

Sårbarhetsbedömning är en skanningstjänst som är inbyggd i Azure SQL Database. Tjänsten använder en kunskapsbas med regler som flaggar säkerhetsproblem. Det belyser avvikelser från bästa praxis, till exempel felkonfigurationer, överdrivna behörigheter och oskyddade känsliga data.

Reglerna baseras på Microsofts bästa praxis och fokuserar på de säkerhetsproblem som utgör de största riskerna för databasen och dess värdefulla data. De täcker problem på databasnivå och säkerhetsproblem på servernivå, till exempel serverbrandväggsinställningar och behörigheter på servernivå. Dessa regler representerar också många av kraven från olika tillsynsmyndigheter för att uppfylla deras efterlevnadsstandarder.

Resultaten av genomsökningen inkluderar användbara steg för att lösa varje problem och tillhandahålla anpassade reparationsskript där det är tillämpligt. Du kan anpassa en utvärderingsrapport för din miljö genom att ange en godtagbar originalplan för:
* Behörighetskonfigurationer.
* Funktionskonfigurationer.
* Databasinställningar.

## <a name="implement-vulnerability-assessment"></a>Implementera sårbarhetsbedömning

Följande steg implementerar sårbarhetsbedömning på SQL Database.

### <a name="1-run-a-scan"></a>1. Kör en genomsökning

Välj **Avancerad datasäkerhet**under rubriken **Säkerhet** i fönstret Azure SQL Database . Klicka sedan på **Välj lagring** i fönstret Bedömning **av säkerhetsproblem** för att öppna fönstret Inställningar för bedömning av säkerhetsproblem för hela SQL-servern.

Konfigurera ett lagringskonto där dina sökresultat för alla databaser på servern lagras. Information om lagringskonton finns i [Om Azure-lagringskonton](../storage/common/storage-create-storage-account.md). När lagring har konfigurerats väljer du **Skanna** för att söka igenom databasen efter säkerhetsproblem.

![Skanna en databas](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Skanningen är lätt och säker. Det tar några sekunder att köra och är helt skrivskyddad. Databasen ändras inte.

### <a name="2-view-the-report"></a>2. Visa rapporten

När genomsökningen är klar visas din skanningsrapport automatiskt i Azure-portalen. Rapporten innehåller en översikt över ditt säkerhetstillstånd. Den listar hur många problem som hittades och deras respektive allvarlighetsgrad. Resultaten inkluderar varningar om avvikelser från metodtips och en ögonblicksbild av dina säkerhetsrelaterade inställningar, till exempel databasens huvudnamn och roller och tillhörande behörigheter. Skanningsrapporten innehåller också en karta över känsliga data som upptäckts i databasen. Den innehåller rekommendationer för att klassificera dessa data med hjälp av [dataidentifiering och klassificering](sql-database-data-discovery-and-classification.md).

![Visa rapporten](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analysera resultaten och lösa problem

Granska dina resultat och ta reda på resultaten i rapporten som är verkliga säkerhetsproblem i din miljö. Öka detaljnivån till varje misslyckat resultat för att förstå effekten av konstaterandet och varför varje säkerhetskontroll misslyckades. Använd den åtgärdsinformation som kan åtgärdas i rapporten för att lösa problemet.

![Analysera rapporten](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Ställ in din baslinje

När du granskar dina utvärderingsresultat kan du markera specifika resultat som en godtagbar *baslinje* i din miljö. Baslinjen är i huvudsak en anpassning av hur resultaten rapporteras. Resultat som matchar baslinjen betraktas som passerar i efterföljande genomsökningar. När du har fastställt ditt grundläggande säkerhetstillstånd rapporterar sårbarhetsbedömning endast avvikelser från originalplanen. På så sätt kan du fokusera din uppmärksamhet på relevanta frågor.

![Ange baslinje](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Kör en ny genomsökning för att se din anpassade spårningsrapport

När du har konfigurerat **regelbaslinjerna**kör du en ny genomsökning för att visa den anpassade rapporten. Sårbarhetsbedömningen rapporterar nu bara de säkerhetsproblem som avviker från det godkända baslinjetillståndet.

![Visa din anpassade rapport](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Sårbarhetsbedömning kan nu användas för att övervaka att databasen alltid har en hög säkerhetsnivå och att dina organisationsprinciper uppfylls. Om efterlevnadsrapporter krävs kan rapporter om sårbarhetsbedömning vara till hjälp för att underlätta efterlevnadsprocessen.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Ställ in periodiska återkommande genomsökningar

Gå till inställningarna för sårbarhetsbedömning om du vill aktivera **Regelbundna återkommande genomsökningar**. Den här inställningen konfigurerar sårbarhetsbedömning för att automatiskt köra en genomsökning på databasen en gång i veckan. En sammanfattning av skanningsresultatet skickas till de e-postadresser du anger.

![Visa din anpassade rapport](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Exportera en bedömningsrapport

Välj **Exportera skanningsresultat** om du vill skapa en nedladdningsbar Excel-rapport över skanningsresultatet. Den här rapporten innehåller en sammanfattningsflik som visar en sammanfattning av utvärderingen. Rapporten innehåller alla misslyckade kontroller. Den innehåller också en **resultatflik** som innehåller hela uppsättningen resultat från genomsökningen. Resultaten inkluderar alla kontroller som kördes och resultatinformation för varje.

### <a name="8-view-scan-history"></a>8. Visa skanningshistorik

Välj **Sökhistorik** i fönstret Sårbarhetsbedömning om du vill visa en historik över alla genomsökningar som tidigare körts i den här databasen. Välj en viss genomsökning i listan om du vill visa de detaljerade resultaten av genomsökningen.

Sårbarhetsbedömning kan nu användas för att övervaka att databasen alltid har en hög säkerhetsnivå och att dina organisationsprinciper uppfylls. Om efterlevnadsrapporter krävs kan rapporter om sårbarhetsbedömning vara till hjälp för att underlätta efterlevnadsprocessen.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Hantera sårbarhetsbedömningar med hjälp av Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> PowerShell Azure Resource Manager-modulen stöds fortfarande av Azure SQL Database, men all framtida utveckling är för Az.Sql-modulen. För dessa cmdlets finns i [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Argumenten för kommandona i Az-modulen och i AzureRm-modulerna är i stort sett identiska.

Du kan använda Azure PowerShell-cmdlets för att programmässigt hantera dina sårbarhetsbedömningar. Cmdlets som stöds är:

| Cmdlet-namn som en länk | Beskrivning |
| :-------------------- | :---------- |
| [Klar-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Rensar baslinjen för regeln för sårbarhetsbedömning.<br/>Ställ först in baslinjen innan du använder den här cmdleten för att rensa den. |
| [Klar-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Rensar inställningarna för sårbarhetsbedömning i en databas. |
| [Konvertera-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konverterar undersökningsresultat för sårbarhetsbedömning till en Excel-fil. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Hämtar regeln för sårbarhetsbedömning för en viss regel. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Hämtar alla sårbarhetsbedömningsskanningsposter som är associerade med en viss databas. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Returnerar inställningarna för sårbarhetsbedömning för en databas. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Anger regeln för sårbarhetsbedömning. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Utlöser början av en sårbarhetsbedömning. |
| [Uppdatering-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Uppdaterar inställningarna för sårbarhetsbedömning i en databas. |
| &nbsp; | &nbsp; |

Ett skriptexempel finns i [Azure SQL Vulnerability Assessment PowerShell-stöd](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Hantera baslinjeregler för säkerhetsproblembedömning med hjälp av Resource Manager-mallar

Om du vill konfigurera baslinjer för säkerhetsproblembedömning `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` med hjälp av Azure Resource Manager-mallar använder du typen.

Kontrollera att du `vulnerabilityAssessments` har aktiverat på datorn som kör SQL Server innan du lägger till baslinjer.

Här är ett exempel på att definiera baslinjeregeln VA2065 till masterdb och VA1143 till userdb som resurser i en Resource Manager-mall:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

För huvuddatabas och användardatabas definieras resursnamnen på olika sätt:

* Huvuddatabas - "namn": "[concat(parametrar("server_name"),"/", parametrar("database_name") , '/default/VA2065/<b>master</b>')]".
* Användardatabas - "namn": "[concat(parametrar("server_name"),"/", parametrar("database_name") , '/default/VA2065/<b>default</b>')]".
 
 
 Om du vill hantera booleska typer som true/false ställer du in baslinjeresultatet med binär indata som "1"/"0".
 
```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Nästa steg  

- Läs mer om [avancerad datasäkerhet](sql-database-advanced-data-security.md).
- Läs mer om [dataidentifiering och klassificering](sql-database-data-discovery-and-classification.md).
