---
title: Microsoft Antimalware för Azure | Microsoft-dokument
description: Den här artikeln innehåller en arkitektonisk översikt över Microsoft Antimalware för Azure, inklusive scenarier och konfigurationer som stöds för att aktivera, konfigurera och distribuera skydd för Azure Cloud Services och Virtuella datorer. Vi täcker grundläggande konfigurations-, hanterings- och övervakningsfunktioner som är tillgängliga via Microsoft Azure-api:et för tjänsthantering, PowerShell-skript, Azure-portalen och Visual Studio.
services: security
documentationcenter: na
author: barclayn
manager: barbkess
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/26/2019
ms.author: barclayn
ms.openlocfilehash: 2b0a8ff9160f5f311bbe3f74afcd4ff8eddf62f4
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/28/2020
ms.locfileid: "79282593"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft Antimalware för Azure Cloud Services och virtuella datorer

Microsoft Antimalware för Azure är ett kostnadsfritt realtidsskydd som hjälper till att identifiera och ta bort virus, spionprogram och annan skadlig programvara. Det genererar aviseringar när kända skadliga eller oönskade program försöker installera sig själv eller köras på dina Azure-system.

Lösningen bygger på samma plattform mot skadlig kod \[som\]Microsoft Security Essentials MSE , Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune och Windows Defender. Microsoft Antimalware för Azure är en lösning med en agent för program och klientmiljöer som utformats för att köras i bakgrunden utan mänsklig inblandning. Skydd kan distribueras baserat på behoven hos programarbetsbelastningar, med antingen grundläggande säker standard eller avancerad anpassad konfiguration, inklusive övervakning mot skadlig kod.

När du distribuerar och aktiverar Microsoft Antimalware för Azure för dina program är följande kärnfunktioner tillgängliga:

* **Realtidsskydd** – övervakar aktivitet i molntjänster och virtuella datorer för att upptäcka och blockera körning av skadlig kod.
* **Schemalagd skanning** - Söker regelbundet för att upptäcka skadlig kod, inklusive program som körs aktivt.
* **Åtgärder för att åtgärda skadlig kod** – vidtar automatiskt åtgärder mot upptäckt skadlig kod, till exempel att ta bort eller placera skadliga filer och rensa skadliga registerposter.
* **Signaturuppdateringar** - installerar automatiskt de senaste skyddssignaturerna (virusdefinitioner) för att säkerställa att skyddet är uppdaterat på en förutbestämd frekvens.
* **Uppdateringar av antimalware-motorn** – uppdaterar automatiskt Microsoft Antimalware-motorn.
* **Uppdateringar** av plattformen mot skadlig kod – uppdaterar automatiskt Microsoft Antimalware-plattformen.
* **Aktivt skydd** – rapporterar telemetrimetadata om upptäckta hot och misstänkta resurser till Microsoft Azure för att säkerställa snabba svar på det växande hotlandskapet, samt möjliggör synkron signaturleverans i realtid via Microsoft Active Protection System (MAPS).
* **Exempelrapportering** – innehåller och rapporterar exempel till Microsoft Antimalware-tjänsten för att förfina tjänsten och aktivera felsökning.
* **Undantag** – gör det möjligt för program- och tjänstadministratörer att konfigurera undantag för filer, processer och enheter.  
* **Händelsesamling mot skadlig kod** – registrerar hälsotillståndet mot skadlig programvara, misstänkta aktiviteter och reparationsåtgärder som vidtas i händelseloggen för operativsystemet och samlar in dem i kundens Azure Storage-konto.

> [!NOTE]
> Microsoft Antimalware kan också distribueras med Azure Security Center. Läs [Installera slutpunktsskydd i Azure Security Center](../../security-center/security-center-install-endpoint-protection.md) för mer information.

## <a name="architecture"></a>Arkitektur

Microsoft Antimalware för Azure innehåller Microsoft Antimalware Client and Service, Antimalware classic deployment model, Antimalware PowerShell-cmdlets och Azure Diagnostics Extension. Microsoft Antimalware stöds i operativsystemet Windows Server 2008 R2, Windows Server 2012 och Windows Server 2012 R2. Det stöds inte på operativsystemet Windows Server 2008 och stöds inte heller i Linux.

Microsoft Antimalware Client and Service installeras som standard i inaktiverat tillstånd i alla azure-gästoperativsystemfamiljer som stöds på Cloud Services-plattformen. Microsoft Antimalware Client and Service installeras inte som standard i plattformen för virtuella datorer och är tillgänglig som en valfri funktion via Azure-portalen och Visual Studio Virtual Machine-konfigurationen under Säkerhetstillägg.

När du använder Azure App Service har den underliggande tjänsten som är värd för webbappen Microsoft Antimalware aktiverat på den. Detta används för att skydda Azure App Service-infrastrukturen och körs inte på kundinnehåll.

> [!NOTE]
> Windows Defender är den inbyggda antimalware som är aktiverad i Windows Server 2016. Windows Defender-gränssnittet är också aktiverat som standard på vissa SKU I Windows Server 2016 [SKU finns här för mer information](https://docs.microsoft.com/windows/threat-protection/windows-defender-antivirus/windows-defender-antivirus-on-windows-server-2016). Azure VM Antimalware-tillägget kan fortfarande läggas till i en Windows Server 2016 Azure VM med Windows Defender, men i det här scenariot kommer tillägget att tillämpa alla valfria [konfigurationsprinciper](https://gallery.technet.microsoft.com/Antimalware-For-Azure-5ce70efe) som ska användas av Windows Defender, tillägget kommer inte att distribuera några ytterligare antimalware-tjänster.
> Du kan läsa mer om den här uppdateringen [här](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="microsoft-antimalware-workflow"></a>Microsofts arbetsflöde mot skadlig kod

Azure-tjänstadministratören kan aktivera Skadlig kod för Azure med en standard eller anpassad konfiguration för dina virtuella datorer och molntjänster med följande alternativ:

* Virtuella datorer – i Azure-portalen, under **säkerhetstillägg**
* Virtuella datorer – Använda konfigurationen av virtuella visual studio-datorer i Server Explorer
* Virtuella datorer och molntjänster – Med den [klassiska distributionsmodellen](https://msdn.microsoft.com/library/azure/ee460799.aspx) mot skadlig kod
* Virtuella datorer och molntjänster – använda PowerShell-cmdlets mot skadlig kod

Azure-portalen eller PowerShell-cmdletsen skickar paketfilen för Antimalware-tillägg till Azure-systemet på en förutbestämd fast plats. Azure Guest Agent (eller Fabric Agent) startar Antimalware-tillägget och tillämpar konfigurationsinställningarna för skadlig kod som anges som indata. Det här steget aktiverar tjänsten Antimalware med antingen standardinställningar eller anpassade konfigurationsinställningar. Om ingen anpassad konfiguration tillhandahålls aktiveras tjänsten mot skadlig kod med standardkonfigurationsinställningarna. Mer information finns i *konfigurationsavsnittet mot skadlig kod* i [Microsoft Antimalware för Azure.](https://aka.ms/amazsamples "Microsoft Antimalware för Azure Cloud Services och virtuella datorer kodexempel")

När microsoft Antimalware-klienten har körts hämtar den senaste skyddsmotorn och signaturdefinitionerna från Internet och läser in dem på Azure-systemet. Microsoft Antimalware-tjänsten skriver tjänstrelaterade händelser till systemoperoshändelseloggen under händelsekällan "Microsoft Antimalware". Händelser inkluderar hälsotillståndet för Antimalware-klienten, skydds- och reparationsstatus, nya och gamla konfigurationsinställningar, motoruppdateringar och signaturdefinitioner och andra.

Du kan aktivera övervakning mot skadlig kod för din molntjänst eller virtuella dator så att händelserna mot skadlig kod skrivs när de produceras till ditt Azure-lagringskonto. Antimalware-tjänsten använder Azure Diagnostics-tillägget för att samla in Antimalware-händelser från Azure-systemet i tabeller i kundens Azure Storage-konto.

Distributionsarbetsflödet inklusive konfigurationssteg och alternativ som stöds för ovanstående scenarier dokumenteras i avsnittet [Distributionsscenarier för skadlig kod](#antimalware-deployment-scenarios) i det här dokumentet.

![Microsoft Antimalware i Azure](./media/antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> Du kan dock använda Powershell/API:er och Azure Resource Manager-mallar för att distribuera skalningsuppsättningar för virtuella datorer med tillägget Microsoft Anti-Malware.  Om du vill installera ett tillägg på en virtuell dator som redan körs kan du använda exempelpytonormskriptet [vmssextn.py](https://github.com/gbowerman/vmsstools). Det här skriptet får det befintliga tillägget config på skalningsuppsättningen och lägger till ett tillägg i listan över befintliga tillägg på vm-skalningsuppsättningarna.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Standardkonfiguration mot och anpassad skadlig kod

Standardkonfigurationsinställningarna tillämpas för att aktivera skadlig kod för Azure Cloud Services eller virtuella datorer när du inte tillhandahåller anpassade konfigurationsinställningar. Standardkonfigurationsinställningarna har föroptimerats för körning i Azure-miljön. Du kan också anpassa dessa standardkonfigurationsinställningar enligt vad som krävs för din Azure-program- eller tjänstdistribution och tillämpa dem för andra distributionsscenarier.

I följande tabell sammanfattas de konfigurationsinställningar som är tillgängliga för tjänsten Antimalware. Standardkonfigurationsinställningarna markeras under kolumnen "Standard" nedan.

![Tabell 1](./media/antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Scenarier för distribution mot skadlig kod

Scenarierna för att aktivera och konfigurera skadlig kod, inklusive övervakning för Azure Cloud Services och virtuella datorer, beskrivs i det här avsnittet.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Virtuella datorer - aktivera och konfigurera antimalware

#### <a name="deployment-while-creating-a-vm-using-the-azure-portal"></a>Distribution När du skapar en virtuell dator med Azure-portalen

Så här aktiverar och konfigurerar du Microsoft Antimalware för virtuella Azure-datorer med Hjälp av Azure-portalen när du etablerar en virtuell dator:

1. Logga in på Azure Portal på <https://portal.azure.com>.
2. Om du vill skapa en ny virtuell dator navigerar du till **virtuella datorer,** väljer **Lägg till**och väljer **Windows Server**.
3. Välj den version av Windows-servern som du vill använda.
4. Välj **Skapa**.
    ![Skapa en virtuell dator](./media/antimalware/create-vm.PNG)
5. Ange ett **namn,** **användarnamn,** **lösenord**och skapa en ny resursgrupp eller välj en befintlig resursgrupp.
6. Välj **Ok**.
7. Välj en vm-storlek.
8. I nästa avsnitt gör du lämpliga val för dina behov och väljer avsnittet **Tillägg.**
9. Välj **Lägg till tillägg**
10. Under **Ny resurs**väljer du Microsoft **Antimalware**.
11. Välj **Skapa**
12. I avsnittsfilen **Installera** kan platser och processuteslutningar konfigureras samt andra skanningsalternativ. Välj **OK**.
13. Välj **OK**.
14. Tillbaka i avsnittet **Inställningar** väljer du **Ok**.
15. På skärmen **Skapa** väljer du **Ok**.

#### <a name="deployment-using-the-visual-studio-virtual-machine-configuration"></a>Distribution med visual studio-konfigurationen för virtuella datorer

Så här aktiverar och konfigurerar du Microsoft Antimalware-tjänsten med Visual Studio:

1. Anslut till Microsoft Azure i Visual Studio.

2. Välj din virtuella dator i noden **virtuella datorer** i **Server Explorer**

   ![Konfiguration av virtuella datorer i Visual Studio](./media/antimalware/sec-azantimal-fig5.PNG)

3. Högerklicka **konfigurera** för att visa konfigurationssidan för den virtuella datorn

4. Välj **Microsoft Antimalware-tillägg** i listrutan under **Installerade tillägg** och klicka på Lägg **till** för att konfigurera med standardkonfigurationen mot skadlig kod.
    ![Installerade tillägg](./media/antimalware/sec-azantimal-fig6.PNG)
5. Om du vill anpassa standardkonfigurationen mot skadlig kod väljer du (markera) tillägget Antimalware i listan med installerade tillägg och klickar på **Konfigurera**.

6. Ersätt standardkonfigurationen mot skadlig kod med din anpassade konfiguration i JSON-format som stöds i den **offentliga konfigurationstextrutan** och klicka på OK.

7. Klicka på knappen **Uppdatera** om du vill skicka konfigurationsuppdateringarna till den virtuella datorn.

    ![Konfigurationstillägg för virtuell dator](./media/antimalware/sec-azantimal-fig7.PNG)

> [!NOTE]
>Visual Studio-konfigurationen för virtuella datorer för skadlig kod stöder endast konfigurationen av JSON-format. Konfigurationsinställningsmallen Antimalware JSON ingår i [Microsoft Antimalware For Azure - Kodexempel](https://aka.ms/amazsamples "Microsoft Antimalware för Azure – kodexempel"), som visar konfigurationsinställningarna för antimalware som stöds.

#### <a name="deployment-using-powershell-cmdlets"></a>Distribution med PowerShell-cmdletar

Ett Azure-program eller -tjänst kan aktivera och konfigurera Microsoft Antimalware för virtuella Azure-datorer med PowerShell-cmdletar.

Så här aktiverar och konfigurerar du Microsofts skadlig kod med PowerShell-cmdlets mot skadlig kod:

1. Konfigurera PowerShell-miljö - Se dokumentationen på<https://github.com/Azure/azure-powershell>
2. Använd [cmdlet set-AzureVMMicrosoftAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) för att aktivera och konfigurera Microsoft Antimalware för din virtuella dator.

> [!NOTE]
>Azure Virtual Machines-konfigurationen för antimalware stöder endast konfiguration av JSON-format. Konfigurationsinställningsmallen Antimalware JSON ingår i [Microsoft Antimalware For Azure - Kodexempel](https://aka.ms/amazsamples "Microsoft Antimalware för Azure – kodexempel"), som visar konfigurationsinställningarna för antimalware som stöds.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Aktivera och konfigurera antimalware med PowerShell-cmdlets

Ett Azure-program eller -tjänst kan aktivera och konfigurera Microsoft Antimalware för Azure Cloud Services med PowerShell-cmdlets. Observera att Microsoft Antimalware är installerat i inaktiverat tillstånd på Cloud Services-plattformen och kräver en åtgärd av ett Azure-program för att aktivera det.

Så här aktiverar och konfigurerar du Microsoft Antimalware med PowerShell-cmdletar:

1. Konfigurera PowerShell-miljö - Se dokumentationen på<https://github.com/Azure/azure-powershell>
2. Använd [cmdlet set-AzureServiceAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) för att aktivera och konfigurera Microsoft Antimalware för din molntjänst.

Konfigurationsinställningsmallen för xml-kod mot skadlig kod ingår i [Microsoft Antimalware för Azure - kodexempel](https://aka.ms/amazsamples "Microsoft Antimalware för Azure – kodexempel"), som visar konfigurationsinställningarna för skadlig kod mot skadlig kod.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Molntjänster och virtuella datorer – konfiguration med PowerShell-cmdlets

Ett Azure-program eller -tjänst kan hämta Microsoft Antimalware-konfigurationen för molntjänster och virtuella datorer med PowerShell-cmdletar.

Så här hämtar du Microsoft Antimalware-konfigurationen med PowerShell-cmdlets:

1. Konfigurera PowerShell-miljö - Se dokumentationen på<https://github.com/Azure/azure-powershell>
2. **För virtuella datorer:** Använd [Get-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azurevmmicrosoftantimalwareextension) för att få konfigurationen mot skadlig kod.
3. **För molntjänster:** Använd [Get-AzureServiceAntimalwareConfig Antimalware cmdlet](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureserviceantimalwareconfig) för att hämta konfigurationen mot skadlig kod.

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Ta bort konfiguration mot skadlig kod med PowerShell-cmdletar

Ett Azure-program eller -tjänst kan ta bort antimalware-konfigurationen och alla associerade antimalware-övervakningskonfiguration från relevanta Azure Antimalware- och diagnostiktjänsttillägg som är associerade med molntjänsten eller den virtuella datorn.

Så här tar du bort Microsoft Antimalware med PowerShell-cmdletar:

1. Konfigurera PowerShell-miljö - Se dokumentationen på<https://github.com/Azure/azure-powershell>
2. **För virtuella datorer:** Använd [Cmdlet remove-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azurevmmicrosoftantimalwareextension).
3. **För molntjänster:** Använd [cmdlet remove-AzureServiceAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azureserviceantimalwareextension).

Så här **aktiverar** du händelsesamling mot skadlig kod för en virtuell dator med Azure Preview Portal:

1. Klicka på någon del av övervakningslinsen i bladet Virtuell dator
2. Klicka på kommandot Diagnostik på bladet Metriska
3. Välj **Status** på och kontrollera alternativet för Windows-händelsesystem
4. . Du kan välja att avmarkera alla andra alternativ i listan eller låta dem vara aktiverade enligt dina programtjänstbehov.
5. Antimalware-händelsekategorierna "Error", "Warning", "Informational", etc., samlas in i ditt Azure Storage-konto.

Händelser mot skadlig kod samlas in från Windows-händelsesystemloggarna till ditt Azure Storage-konto. Du kan konfigurera lagringskontot för din virtuella dator för att samla in antimalware-händelser genom att välja lämpligt lagringskonto.

![Mått och diagnostik](./media/antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Mer information om hur du loggar för Azure Antimalware finns i [Aktivera diagnostikloggning för Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Aktivera och konfigurera övervakning mot skadlig kod med powerShell-cmdlets

Du kan aktivera insamling av Microsoft Antimalware-händelser för din molntjänst eller virtuella dator med Azure Diagnostics via PowerShell-cmdlets mot skadlig kod. Azure Diagnostics-tillägget kan konfigureras för att samla in händelser från systemhändelseloggkällan "Microsoft Antimalware" till ditt Azure Storage-konto. Antimalware-händelsekategorierna "Error", "Warning", "Informational", etc., samlas in i ditt Azure Storage-konto.

Så här aktiverar du insamling av antimalware-händelser till ditt Azure Storage-konto med PowerShell-cmdletar:

1. Konfigurera powershell-miljö - se<https://github.com/Azure/azure-powershell>
2. **För virtuella datorer** - Använd alternativet [Set-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) med alternativet Övervakning PÅ.
3. **För molntjänster** – Använd [set-AzureServiceAntimalwareExtension Antimalware cmdlet](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) med alternativet Övervakning PÅ.

Du kan visa råa antimalware-händelser genom att titta på tabellen *WADWindowsEventLogsTable* i ditt Azure Storage-konto som du har konfigurerat för att aktivera övervakning mot skadlig kod. Detta kan vara användbart för att verifiera att Antimalware-händelsesamling fungerar, inklusive att få insikt i Antimalware-tjänstens hälsa. Mer information, inklusive exempelkod om hur du extraherar antimalware-händelser från ditt lagringskonto, finns i [Microsoft Antimalware For Azure - Kodexempel](https://aka.ms/amazsamples "Microsoft Antimalware för Azure – kodexempel").
