---
title: 'SAP p√• Azure: planerings-och implementerings guide'
description: Azure Virtual Machines planera och implementera SAP-NetWeaver
services: virtual-machines-linux,virtual-machines-windows
documentationcenter: ''
author: MSSedusch
manager: juergent
editor: ''
tags: azure-resource-manager
keywords: ''
ms.assetid: d7c59cc1-b2d0-4d90-9126-628f9c7a5538
ms.service: virtual-machines-linux
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 02/13/2020
ms.author: sedusch
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 48e06ed31de35ad29a0fda271feaaf50b5efaf8a
ms.sourcegitcommit: f15f548aaead27b76f64d73224e8f6a1a0fc2262
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 02/26/2020
ms.locfileid: "77616821"
---
# <a name="azure-virtual-machines-planning-and-implementation-for-sap-netweaver"></a>Azure Virtual Machines planera och implementera SAP-NetWeaver

[767598]:https://launchpad.support.sap.com/#/notes/767598
[773830]:https://launchpad.support.sap.com/#/notes/773830
[826037]:https://launchpad.support.sap.com/#/notes/826037
[965908]:https://launchpad.support.sap.com/#/notes/965908
[1031096]:https://launchpad.support.sap.com/#/notes/1031096
[1139904]:https://launchpad.support.sap.com/#/notes/1139904
[1173395]:https://launchpad.support.sap.com/#/notes/1173395
[1245200]:https://launchpad.support.sap.com/#/notes/1245200
[1409604]: https://launchpad.support.sap.com/#/notes/1409604
[1558958]:https://launchpad.support.sap.com/#/notes/1558958
[1585981]:https://launchpad.support.sap.com/#/notes/1585981
[1588316]:https://launchpad.support.sap.com/#/notes/1588316
[1590719]:https://launchpad.support.sap.com/#/notes/1590719
[1597355]: https://launchpad.support.sap.com/#/notes/1597355
[1605680]:https://launchpad.support.sap.com/#/notes/1605680
[1619720]: https://launchpad.support.sap.com/#/notes/1619720
[1619726]:https://launchpad.support.sap.com/#/notes/1619726
[1619967]:https://launchpad.support.sap.com/#/notes/1619967
[1750510]:https://launchpad.support.sap.com/#/notes/1750510
[1752266]:https://launchpad.support.sap.com/#/notes/1752266
[1757924]:https://launchpad.support.sap.com/#/notes/1757924
[1757928]:https://launchpad.support.sap.com/#/notes/1757928
[1758182]:https://launchpad.support.sap.com/#/notes/1758182
[1758496]:https://launchpad.support.sap.com/#/notes/1758496
[1772688]:https://launchpad.support.sap.com/#/notes/1772688
[1814258]:https://launchpad.support.sap.com/#/notes/1814258
[1882376]:https://launchpad.support.sap.com/#/notes/1882376
[1909114]: https://launchpad.support.sap.com/#/notes/1909114
[1922555]:https://launchpad.support.sap.com/#/notes/1922555
[1928533]: https://launchpad.support.sap.com/#/notes/1928533
[1941500]:https://launchpad.support.sap.com/#/notes/1941500
[1956005]:https://launchpad.support.sap.com/#/notes/1956005
[1973241]:https://launchpad.support.sap.com/#/notes/1973241
[1984787]: https://launchpad.support.sap.com/#/notes/1984787
[1999351]: https://launchpad.support.sap.com/#/notes/1999351
[2002167]: https://launchpad.support.sap.com/#/notes/2002167
[2015553]: https://launchpad.support.sap.com/#/notes/2015553
[2039619]:https://launchpad.support.sap.com/#/notes/2039619
[2069760]: https://launchpad.support.sap.com/#/notes/2069760
[2121797]:https://launchpad.support.sap.com/#/notes/2121797
[2134316]:https://launchpad.support.sap.com/#/notes/2134316
[2178632]: https://launchpad.support.sap.com/#/notes/2178632
[2191498]: https://launchpad.support.sap.com/#/notes/2191498
[2233094]:https://launchpad.support.sap.com/#/notes/2233094
[2243692]: https://launchpad.support.sap.com/#/notes/2243692

[azure-cli]:../../../cli-install-nodejs.md
[azure-portal]:https://portal.azure.com
[azure-ps]:/powershell/azureps-cmdlets-docs
[azure-quickstart-templates-github]:https://github.com/Azure/azure-quickstart-templates
[azure-script-ps]:https://go.microsoft.com/fwlink/p/?LinkID=395017
[azure-resource-manager/management/azure-subscription-service-limits]:../../../azure-resource-manager/management/azure-subscription-service-limits.md
[azure-resource-manager/management/azure-subscription-service-limits-subscription]:../../../azure-resource-manager/management/azure-subscription-service-limits.md#subscription-limits

[dbms-guide]:dbms-guide.md
[dbms-guide-2.1]:dbms-guide.md#c7abf1f0-c927-4a7c-9c1d-c7b5b3b7212f
[dbms-guide-2.2]:dbms-guide.md#c8e566f9-21b7-4457-9f7f-126036971a91
[dbms-guide-2.3]:dbms-guide.md#10b041ef-c177-498a-93ed-44b3441ab152
[dbms-guide-2]:dbms-guide.md#65fa79d6-a85f-47ee-890b-22e794f51a64
[dbms-guide-3]:dbms-guide.md#871dfc27-e509-4222-9370-ab1de77021c3
[dbms-guide-5.5.1]:dbms-guide.md#0fef0e79-d3fe-4ae2-85af-73666a6f7268
[dbms-guide-5.5.2]:dbms-guide.md#f9071eff-9d72-4f47-9da4-1852d782087b
[dbms-guide-5.6]:dbms-guide.md#1b353e38-21b3-4310-aeb6-a77e7c8e81c8
[dbms-guide-5.8]:dbms-guide.md#9053f720-6f3b-4483-904d-15dc54141e30
[dbms-guide-5]:dbms-guide.md#3264829e-075e-4d25-966e-a49dad878737
[dbms-guide-8.4.1]:dbms-guide.md#b48cfe3b-48e9-4f5b-a783-1d29155bd573
[dbms-guide-8.4.2]:dbms-guide.md#23c78d3b-ca5a-4e72-8a24-645d141a3f5d
[dbms-guide-8.4.3]:dbms-guide.md#77cd2fbb-307e-4cbf-a65f-745553f72d2c
[dbms-guide-8.4.4]:dbms-guide.md#f77c1436-9ad8-44fb-a331-8671342de818
[dbms-guide-900-sap-cache-server-on-premises]:dbms-guide.md#642f746c-e4d4-489d-bf63-73e80177a0a8

[dbms-guide-figure-100]:media/virtual-machines-shared-sap-dbms-guide/100_storage_account_types.png
[dbms-guide-figure-200]:media/virtual-machines-shared-sap-dbms-guide/200-ha-set-for-dbms-ha.png
[dbms-guide-figure-300]:media/virtual-machines-shared-sap-dbms-guide/300-reference-config-iaas.png
[dbms-guide-figure-400]:media/virtual-machines-shared-sap-dbms-guide/400-sql-2012-backup-to-blob-storage.png
[dbms-guide-figure-500]:media/virtual-machines-shared-sap-dbms-guide/500-sql-2012-backup-to-blob-storage-different-containers.png
[dbms-guide-figure-600]:media/virtual-machines-shared-sap-dbms-guide/600-iaas-maxdb.png
[dbms-guide-figure-700]:media/virtual-machines-shared-sap-dbms-guide/700-livecach-prod.png
[dbms-guide-figure-800]:media/virtual-machines-shared-sap-dbms-guide/800-azure-vm-sap-content-server.png
[dbms-guide-figure-900]:media/virtual-machines-shared-sap-dbms-guide/900-sap-cache-server-on-premises.png

[deployment-guide]:deployment-guide.md
[deployment-guide-2.2]:deployment-guide.md#42ee2bdb-1efc-4ec7-ab31-fe4c22769b94
[deployment-guide-3.1.2]:deployment-guide.md#3688666f-281f-425b-a312-a77e7db2dfab
[deployment-guide-3.2]:deployment-guide.md#db477013-9060-4602-9ad4-b0316f8bb281
[deployment-guide-3.3]:deployment-guide.md#54a1fc6d-24fd-4feb-9c57-ac588a55dff2
[deployment-guide-3.4]:deployment-guide.md#a9a60133-a763-4de8-8986-ac0fa33aa8c1
[deployment-guide-3]:deployment-guide.md#b3253ee3-d63b-4d74-a49b-185e76c4088e
[deployment-guide-4.1]:deployment-guide.md#604bcec2-8b6e-48d2-a944-61b0f5dee2f7
[deployment-guide-4.2]:deployment-guide.md#7ccf6c3e-97ae-4a7a-9c75-e82c37beb18e
[deployment-guide-4.3]:deployment-guide.md#31d9ecd6-b136-4c73-b61e-da4a29bbc9cc
[deployment-guide-4.4.2]:deployment-guide.md#6889ff12-eaaf-4f3c-97e1-7c9edc7f7542
[deployment-guide-4.4]:deployment-guide.md#c7cbb0dc-52a4-49db-8e03-83e7edc2927d
[deployment-guide-4.5.1]:deployment-guide.md#987cf279-d713-4b4c-8143-6b11589bb9d4
[deployment-guide-4.5.2]:deployment-guide.md#408f3779-f422-4413-82f8-c57a23b4fc2f
[deployment-guide-4.5]:deployment-guide.md#d98edcd3-f2a1-49f7-b26a-07448ceb60ca
[deployment-guide-5.1]:deployment-guide.md#bb61ce92-8c5c-461f-8c53-39f5e5ed91f2
[deployment-guide-5.2]:deployment-guide.md#e2d592ff-b4ea-4a53-a91a-e5521edb6cd1
[deployment-guide-5.3]:deployment-guide.md#fe25a7da-4e4e-4388-8907-8abc2d33cfd8

[deployment-guide-configure-monitoring-scenario-1]:deployment-guide.md#ec323ac3-1de9-4c3a-b770-4ff701def65b
[deployment-guide-configure-proxy]:deployment-guide.md#baccae00-6f79-4307-ade4-40292ce4e02d
[deployment-guide-figure-100]:media/virtual-machines-shared-sap-deployment-guide/100-deploy-vm-image.png
[deployment-guide-figure-1000]:media/virtual-machines-shared-sap-deployment-guide/1000-service-properties.png
[deployment-guide-figure-11]:deployment-guide.md#figure-11
[deployment-guide-figure-1100]:media/virtual-machines-shared-sap-deployment-guide/1100-azperflib.png
[deployment-guide-figure-1200]:media/virtual-machines-shared-sap-deployment-guide/1200-cmd-test-login.png
[deployment-guide-figure-1300]:media/virtual-machines-shared-sap-deployment-guide/1300-cmd-test-executed.png
[deployment-guide-figure-14]:deployment-guide.md#figure-14
[deployment-guide-figure-1400]:media/virtual-machines-shared-sap-deployment-guide/1400-azperflib-error-servicenotstarted.png
[deployment-guide-figure-300]:media/virtual-machines-shared-sap-deployment-guide/300-deploy-private-image.png
[deployment-guide-figure-400]:media/virtual-machines-shared-sap-deployment-guide/400-deploy-using-disk.png
[deployment-guide-figure-5]:deployment-guide.md#figure-5
[deployment-guide-figure-50]:media/virtual-machines-shared-sap-deployment-guide/50-forced-tunneling-suse.png
[deployment-guide-figure-500]:media/virtual-machines-shared-sap-deployment-guide/500-install-powershell.png
[deployment-guide-figure-6]:deployment-guide.md#figure-6
[deployment-guide-figure-600]:media/virtual-machines-shared-sap-deployment-guide/600-powershell-version.png
[deployment-guide-figure-7]:deployment-guide.md#figure-7
[deployment-guide-figure-700]:media/virtual-machines-shared-sap-deployment-guide/700-install-powershell-installed.png
[deployment-guide-figure-760]:media/virtual-machines-shared-sap-deployment-guide/760-azure-cli-version.png
[deployment-guide-figure-900]:media/virtual-machines-shared-sap-deployment-guide/900-cmd-update-executed.png
[deployment-guide-figure-azure-cli-installed]:deployment-guide.md#402488e5-f9bb-4b29-8063-1c5f52a892d0
[deployment-guide-figure-azure-cli-version]:deployment-guide.md#0ad010e6-f9b5-4c21-9c09-bb2e5efb3fda
[deployment-guide-install-vm-agent-windows]:deployment-guide.md#b2db5c9a-a076-42c6-9835-16945868e866
[deployment-guide-troubleshooting-chapter]:deployment-guide.md#564adb4f-5c95-4041-9616-6635e83a810b

[deploy-template-cli]:../../../resource-group-template-deploy-cli.md
[deploy-template-portal]:../../../resource-group-template-deploy-portal.md
[deploy-template-powershell]:../../../resource-group-template-deploy.md

[dr-guide-classic]:https://go.microsoft.com/fwlink/?LinkID=521971

[getting-started]:get-started.md
[getting-started-dbms]:get-started.md#1343ffe1-8021-4ce6-a08d-3a1553a4db82
[getting-started-deployment]:get-started.md#6aadadd2-76b5-46d8-8713-e8d63630e955
[getting-started-planning]:get-started.md#3da0389e-708b-4e82-b2a2-e92f132df89c

[getting-started-windows-classic]:../../virtual-machines-windows-classic-sap-get-started.md
[getting-started-windows-classic-dbms]:../../virtual-machines-windows-classic-sap-get-started.md#c5b77a14-f6b4-44e9-acab-4d28ff72a930
[getting-started-windows-classic-deployment]:../../virtual-machines-windows-classic-sap-get-started.md#f84ea6ce-bbb4-41f7-9965-34d31b0098ea
[getting-started-windows-classic-dr]:../../virtual-machines-windows-classic-sap-get-started.md#cff10b4a-01a5-4dc3-94b6-afb8e55757d3
[getting-started-windows-classic-ha-sios]:../../virtual-machines-windows-classic-sap-get-started.md#4bb7512c-0fa0-4227-9853-4004281b1037
[getting-started-windows-classic-planning]:../../virtual-machines-windows-classic-sap-get-started.md#f2a5e9d8-49e4-419e-9900-af783173481c

[ha-guide-classic]:https://go.microsoft.com/fwlink/?LinkId=613056

[install-extension-cli]:virtual-machines-linux-enable-aem.md

[Logo_Linux]:media/virtual-machines-shared-sap-shared/Linux.png
[Logo_Windows]:media/virtual-machines-shared-sap-shared/Windows.png

[msdn-set-Azvmaemextension]:https://msdn.microsoft.com/library/azure/mt670598.aspx

[planning-guide]:planning-guide.md  
[planning-guide-1.2]:planning-guide.md#e55d1e22-c2c8-460b-9897-64622a34fdff
[planning-guide-11]:planning-guide.md#7cf991a1-badd-40a9-944e-7baae842a058
[planning-guide-11.4.1]:planning-guide.md#5d9d36f9-9058-435d-8367-5ad05f00de77
[planning-guide-11.5]:planning-guide.md#4e165b58-74ca-474f-a7f4-5e695a93204f
[planning-guide-2.2]:planning-guide.md#f5b3b18c-302c-4bd8-9ab2-c388f1ab3d10
[planning-guide-3.1]:planning-guide.md#be80d1b9-a463-4845-bd35-f4cebdb5424a
[planning-guide-3.2.1]:planning-guide.md#df49dc09-141b-4f34-a4a2-990913b30358
[planning-guide-3.2.2]:planning-guide.md#fc1ac8b2-e54a-487c-8581-d3cc6625e560
[planning-guide-3.2.3]:planning-guide.md#18810088-f9be-4c97-958a-27996255c665
[planning-guide-3.2]:planning-guide.md#8d8ad4b8-6093-4b91-ac36-ea56d80dbf77
[planning-guide-3.3.2]:planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92
[planning-guide-5.1.1]:planning-guide.md#4d175f1b-7353-4137-9d2f-817683c26e53
[planning-guide-5.1.2]:planning-guide.md#e18f7839-c0e2-4385-b1e6-4538453a285c
[planning-guide-5.2.1]:planning-guide.md#1b287330-944b-495d-9ea7-94b83aff73ef
[planning-guide-5.2.2]:planning-guide.md#57f32b1c-0cba-4e57-ab6e-c39fe22b6ec3
[planning-guide-5.2]:planning-guide.md#6ffb9f41-a292-40bf-9e70-8204448559e7
[planning-guide-5.3.1]:planning-guide.md#6e835de8-40b1-4b71-9f18-d45b20959b79
[planning-guide-5.3.2]:planning-guide.md#a43e40e6-1acc-4633-9816-8f095d5a7b6a
[planning-guide-5.4.2]:planning-guide.md#9789b076-2011-4afa-b2fe-b07a8aba58a1
[planning-guide-5.5.1]:planning-guide.md#4efec401-91e0-40c0-8e64-f2dceadff646
[planning-guide-5.5.3]:planning-guide.md#17e0d543-7e8c-4160-a7da-dd7117a1ad9d
[planning-guide-7.1]:planning-guide.md#3e9c3690-da67-421a-bc3f-12c520d99a30
[planning-guide-7]:planning-guide.md#96a77628-a05e-475d-9df3-fb82217e8f14
[planning-guide-9.1]:planning-guide.md#6f0a47f3-a289-4090-a053-2521618a28c3
[planning-guide-azure-premium-storage]:planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92

[planning-guide-figure-100]:media/virtual-machines-shared-sap-planning-guide/100-single-vm-in-azure.png
[planning-guide-figure-1300]:media/virtual-machines-shared-sap-planning-guide/1300-ref-config-iaas-for-sap.png
[planning-guide-figure-1400]:media/virtual-machines-shared-sap-planning-guide/1400-attach-detach-disks.png
[planning-guide-figure-1600]:media/virtual-machines-shared-sap-planning-guide/1600-firewall-port-rule.png
[planning-guide-figure-1700]:media/virtual-machines-shared-sap-planning-guide/1700-single-vm-demo.png
[planning-guide-figure-1900]:media/virtual-machines-shared-sap-planning-guide/1900-vm-set-vnet.png
[planning-guide-figure-200]:media/virtual-machines-shared-sap-planning-guide/200-multiple-vms-in-azure.png
[planning-guide-figure-2100]:media/virtual-machines-shared-sap-planning-guide/2100-s2s.png
[planning-guide-figure-2200]:media/virtual-machines-shared-sap-planning-guide/2200-network-printing.png
[planning-guide-figure-2300]:media/virtual-machines-shared-sap-planning-guide/2300-sapgui-stms.png
[planning-guide-figure-2400]:media/virtual-machines-shared-sap-planning-guide/2400-vm-extension-overview.png
[planning-guide-figure-2500]:media/virtual-machines-shared-sap-planning-guide/planning-monitoring-overview-2502.png
[planning-guide-figure-2600]:media/virtual-machines-shared-sap-planning-guide/2600-sap-router-connection.png
[planning-guide-figure-2700]:media/virtual-machines-shared-sap-planning-guide/2700-exposed-sap-portal.png
[planning-guide-figure-2800]:media/virtual-machines-shared-sap-planning-guide/2800-endpoint-config.png
[planning-guide-figure-2900]:media/virtual-machines-shared-sap-planning-guide/2900-azure-ha-sap-ha.png
[planning-guide-figure-2901]:media/virtual-machines-shared-sap-planning-guide/2901-azure-ha-sap-ha-md.png
[planning-guide-figure-300]:media/virtual-machines-shared-sap-planning-guide/300-vpn-s2s.png
[planning-guide-figure-3000]:media/virtual-machines-shared-sap-planning-guide/3000-sap-ha-on-azure.png
[planning-guide-figure-3200]:media/virtual-machines-shared-sap-planning-guide/3200-sap-ha-with-sql.png
[planning-guide-figure-3201]:media/virtual-machines-shared-sap-planning-guide/3201-sap-ha-with-sql-md.png
[planning-guide-figure-400]:media/virtual-machines-shared-sap-planning-guide/400-vm-services.png
[planning-guide-figure-600]:media/virtual-machines-shared-sap-planning-guide/600-s2s-details.png
[planning-guide-figure-700]:media/virtual-machines-shared-sap-planning-guide/700-decision-tree-deploy-to-azure.png
[planning-guide-figure-800]:media/virtual-machines-shared-sap-planning-guide/800-portal-vm-overview.png
[planning-guide-microsoft-azure-networking]:planning-guide.md#61678387-8868-435d-9f8c-450b2424f5bd
[planning-guide-storage-microsoft-azure-storage-and-data-disks]:planning-guide.md#a72afa26-4bf4-4a25-8cf7-855d6032157f

[powershell-install-configure]:https://docs.microsoft.com/powershell/azure/install-az-ps
[resource-group-authoring-templates]:../../../resource-group-authoring-templates.md
[resource-group-overview]:../../../azure-resource-manager/management/overview.md
[resource-groups-networking]:../../../networking/networking-overview.md
[sap-pam]:https://support.sap.com/pam
[sap-templates-2-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-2-tier-os-disk]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-disk%2Fazuredeploy.json
[sap-templates-2-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-image%2Fazuredeploy.json
[sap-templates-3-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-3-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-user-image%2Fazuredeploy.json
[storage-azure-cli]:../../../storage/common/storage-azure-cli.md
[storage-azure-cli-copy-blobs]:../../../storage/common/storage-azure-cli.md#copy-blobs
[storage-introduction]:../../../storage/common/storage-introduction.md
[storage-powershell-guide-full-copy-vhd]:../../../storage/common/storage-powershell-guide-full.md
[storage-premium-storage-preview-portal]:../../windows/disks-types.md
[storage-redundancy]:../../../storage/common/storage-redundancy.md
[storage-scalability-targets]:../../../storage/common/scalability-targets-standard-accounts.md
[storage-use-azcopy]:../../../storage/common/storage-use-azcopy.md
[template-201-vm-from-specialized-vhd]:https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-from-specialized-vhd
[templates-101-simple-windows-vm]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-simple-windows-vm
[templates-101-vm-from-user-image]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-from-user-image
[virtual-machines-linux-attach-disk-portal]:../../linux/attach-disk-portal.md
[virtual-machines-azure-resource-manager-architecture]:../../../resource-manager-deployment-model.md
[virtual-machines-Az-versus-azuresm]:virtual-machines-linux-compare-deployment-models.md
[virtual-machines-windows-classic-configure-oracle-data-guard]:../../virtual-machines-windows-classic-configure-oracle-data-guard.md
[virtual-machines-linux-cli-deploy-templates]:../../linux/cli-deploy-templates.md
[virtual-machines-deploy-rmtemplates-powershell]:../../virtual-machines-windows-ps-manage.md
[virtual-machines-linux-agent-user-guide]:../../extensions/agent-linux.md
[virtual-machines-linux-agent-user-guide-command-line-options]:../../extensions/agent-windows.md#command-line-options
[virtual-machines-linux-capture-image]:../../linux/capture-image.md
[virtual-machines-linux-capture-image-resource-manager]:../../linux/capture-image.md
[virtual-machines-linux-capture-image-resource-manager-capture]:../../linux/capture-image.md#step-2-capture-the-vm
[virtual-machines-windows-capture-image-resource-manager]:../../windows/capture-image.md
[virtual-machines-windows-capture-image]:../../virtual-machines-windows-generalize-vhd.md
[virtual-machines-windows-capture-image-prepare-the-vm-for-image-capture]:../../virtual-machines-windows-generalize-vhd.md
[virtual-machines-linux-configure-raid]:../../linux/configure-raid.md
[virtual-machines-linux-configure-lvm]:../../linux/configure-lvm.md
[virtual-machines-linux-classic-create-upload-vhd-step-1]:../../virtual-machines-linux-classic-create-upload-vhd.md#step-1-prepare-the-image-to-be-uploaded
[virtual-machines-linux-create-upload-vhd-suse]:../../linux/suse-create-upload-vhd.md
[virtual-machines-linux-create-upload-vhd-oracle]:../../linux/oracle-create-upload-vhd.md
[virtual-machines-linux-redhat-create-upload-vhd]:../../linux/redhat-create-upload-vhd.md
[virtual-machines-linux-how-to-attach-disk]:../../linux/add-disk.md
[virtual-machines-linux-how-to-attach-disk-how-to-initialize-a-new-data-disk-in-linux]:../../linux/add-disk.md#connect-to-the-linux-vm-to-mount-the-new-disk
[virtual-machines-linux-tutorial]:../../linux/quick-create-cli.md
[virtual-machines-linux-update-agent]:../../linux/update-agent.md
[virtual-machines-manage-availability]:../../linux/manage-availability.md
[virtual-machines-ps-create-preconfigure-windows-resource-manager-vms]:virtual-machines-windows-create-powershell.md
[virtual-machines-sizes-linux]:../../linux/sizes.md
[virtual-machines-sizes-windows]:../../windows/sizes.md
[virtual-machines-windows-classic-ps-sql-alwayson-availability-groups]:./../../windows/sqlclassic/virtual-machines-windows-classic-ps-sql-alwayson-availability-groups.md
[virtual-machines-windows-classic-ps-sql-int-listener]:./../../windows/sqlclassic/virtual-machines-windows-classic-ps-sql-int-listener.md
[virtual-machines-sql-server-high-availability-and-disaster-recovery-solutions]:./../../windows/sql/virtual-machines-windows-sql-high-availability-dr.md
[virtual-machines-sql-server-infrastructure-services]:./../../windows/sql/virtual-machines-windows-sql-server-iaas-overview.md
[virtual-machines-sql-server-performance-best-practices]:./../../windows/sql/virtual-machines-windows-sql-performance.md
[virtual-machines-upload-image-windows-resource-manager]:../../virtual-machines-windows-upload-image.md
[virtual-machines-windows-tutorial]:../../virtual-machines-windows-hero-tutorial.md
[virtual-machines-workload-template-sql-alwayson]:https://azure.microsoft.com/documentation/templates/sql-server-2014-alwayson-dsc/
[virtual-network-deploy-multinic-arm-cli]:../../linux/multiple-nics.md
[virtual-network-deploy-multinic-arm-ps]:../../windows/multiple-nics.md
[virtual-network-deploy-multinic-arm-template]:../../../virtual-network/template-samples.md
[virtual-networks-configure-vnet-to-vnet-connection]:../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md
[virtual-networks-create-vnet-arm-pportal]:../../../virtual-network/manage-virtual-network.md#create-a-virtual-network
[virtual-networks-manage-dns-in-vnet]:../../../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md
[virtual-networks-multiple-nics-windows]:../../windows/multiple-nics.md
[virtual-networks-multiple-nics-linux]:../../linux/multiple-nics.md
[virtual-networks-nsg]:../../../virtual-network/security-overview.md
[virtual-networks-reserved-private-ip]:../../../virtual-network/virtual-networks-static-private-ip-arm-ps.md
[virtual-networks-static-private-ip-arm-pportal]:../../../virtual-network/virtual-networks-static-private-ip-arm-pportal.md
[virtual-networks-udr-overview]:../../../virtual-network/virtual-networks-udr-overview.md
[vpn-gateway-about-vpn-devices]:../../../vpn-gateway/vpn-gateway-about-vpn-devices.md
[vpn-gateway-create-site-to-site-rm-powershell]:../../../vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md
[vpn-gateway-cross-premises-options]:../../../vpn-gateway/vpn-gateway-about-vpngateways.md
[vpn-gateway-site-to-site-create]:../../../vpn-gateway/vpn-gateway-site-to-site-create.md
[vpn-gateway-vpn-faq]:../../../vpn-gateway/vpn-gateway-vpn-faq.md
[xplat-cli]:../../../cli-install-nodejs.md
[xplat-cli-azure-resource-manager]:../../../xplat-cli-azure-resource-manager.md
[capture-image-linux-step-2-create-vm-image]:../../linux/capture-image.md#step-2-create-vm-image



Microsoft Azure g√∂r det m√∂jligt f√∂r f√∂retag att f√∂rv√§rva ber√§knings-och lagrings resurser i minimal tid utan att de f√•r l√§ngd. Med tj√§nsten Azure Virtual Machine kan f√∂retag distribuera klassiska program, t. ex. SAP NetWeaver-baserade program till Azure och ut√∂ka sin tillf√∂rlitlighet och tillg√§nglighet utan att ytterligare resurser √§r tillg√§ngliga lokalt. Azure Virtual Machine-tj√§nster har √§ven st√∂d f√∂r anslutning mellan platser, vilket g√∂r det m√∂jligt f√∂r f√∂retag att aktivt integrera Azure-Virtual Machines i sina lokala dom√§ner, deras privata moln och deras liggande SAP-system.
I den h√§r white paper beskrivs grunderna i Microsoft Azure virtuella datorn och en genom g√•ng av planerings-och implementerings √∂verv√§ganden f√∂r SAP NetWeaver-installationer i Azure och d√§rf√∂r b√∂r dokumentet l√§sas innan du p√•b√∂rjar den faktiska distributioner av SAP NetWeaver p√• Azure.
Pappret kompletterar SAP-installations dokumentation och SAP-anteckningar, som representerar de prim√§ra resurserna f√∂r installationer och distributioner av SAP-program p√• vissa plattformar.

[!INCLUDE [updated-for-az](../../../../includes/updated-for-az.md)]

## <a name="summary"></a>Sammanfattning
Molnbaserad data behandling √§r en mycket vanlig term som anv√§nds f√∂r att f√• mer och mer betydelse inom IT-branschen, fr√•n sm√• f√∂retag till stora och multinationella f√∂retag.

Microsoft Azure √§r Cloud Services plattform fr√•n Microsoft, som erbjuder ett brett spektrum av nya m√∂jligheter. Nu kan kunderna snabbt etablera och avetablera program som en tj√§nst i molnet, s√• att de inte √§r begr√§nsade till tekniska eller budgetm√§ssiga restriktioner. I st√§llet f√∂r att investera tid och budget i maskin varu infrastruktur kan f√∂retag fokusera p√• program, aff√§rs processer och dess f√∂rdelar f√∂r kunder och anv√§ndare.

Med Microsoft Azure Virtual Machine-tj√§nsterna, erbjuder Microsoft en omfattande plattform f√∂r infrastruktur som en tj√§nst (IaaS). SAP NetWeaver-baserade program st√∂ds p√• virtuella Azure-datorer (IaaS). I det h√§r dokumentet beskrivs hur du planerar och implementerar SAP NetWeaver-baserade program inom Microsoft Azure som vilken plattform som helst.

Sj√§lva pappret fokuserar p√• tv√• huvudsakliga aspekter:

* I den f√∂rsta delen beskrivs tv√• distributions m√∂nster som st√∂ds f√∂r SAP NetWeaver-baserade program p√• Azure. Den beskriver ocks√• allm√§n hantering av Azure med SAP-distributioner i √•tanke.
* Den andra delen inneh√•ller information om hur du implementerar de olika scenarier som beskrivs i den f√∂rsta delen.

Mer resurser finns i kapitel [resurser][planning-guide-1.2] i det h√§r dokumentet.

### <a name="definitions-upfront"></a>Definitioner, framtill
I hela dokumentet anv√§nder vi f√∂ljande villkor:

* IaaS: infrastruktur som en tj√§nst
* PaaS: plattform som en tj√§nst
* SaaS: program vara som en tj√§nst
* SAP-komponent: ett enskilt SAP-program som ECC, BW, Solution Manager eller S/4HANA.  SAP-komponenter kan baseras p√• traditionella ABAP-eller Java-tekniker eller icke-NetWeaver-baserade program som aff√§rs objekt.
* SAP-milj√∂: en eller flera SAP-komponenter grupperade logiskt f√∂r att utf√∂ra en aff√§rs funktion som utveckling, QAS, utbildning, DR eller produktion.
* SAP, liggande: den h√§r termen avser hela SAP-till g√•ngar i en kunds IT-liggande. SAP-landskapet inneh√•ller alla produktions milj√∂er och icke-produktions milj√∂er.
* SAP-system: kombinationen av DBMS-skikt och program niv√• i, till exempel ett SAP ERP-utvecklingssystem, SAP BW test system, SAP CRM-produktionssystem osv. I Azure-distributioner finns det inte st√∂d f√∂r att dela upp dessa tv√• skikt mellan lokalt och Azure. Inneb√§r att ett SAP-system antingen √§r distribuerat lokalt eller distribuerat i Azure. Du kan dock distribuera de olika systemen i ett SAP-landskap till antingen Azure eller lokalt. Du kan t. ex. distribuera SAP CRM-utvecklings-och test system i Azure, men i det lokala SAP CRM-operativsystemet.
* Mellan platser eller hybrider: beskriver ett scenario d√§r virtuella datorer distribueras till en Azure-prenumeration som har plats-till-plats-, flera-plats-eller ExpressRoute-anslutning mellan lokala data Center (er) och Azure. I gemensam Azure-dokumentation beskrivs √§ven dessa typer av distributioner som olika platser eller hybrid scenarier. Orsaken till anslutningen √§r att ut√∂ka lokala dom√§ner, lokala Active Directory/OpenLDAP och lokala DNS i Azure. Det lokala landskapet ut√∂kas till Azure-till g√•ngar f√∂r prenumerationen. De virtuella datorerna kan vara en del av den lokala dom√§nen. Dom√§n anv√§ndare av den lokala dom√§nen kan komma √•t servrarna och kan k√∂ra tj√§nster p√• de virtuella datorerna (t. ex. DBMS-tj√§nster). Kommunikation och namn matchning mellan virtuella datorer som distribuerats lokalt och Azure-distribuerade virtuella datorer √§r m√∂jligt. Detta √§r det vanligaste och n√§stan exklusiva fallet som distribuerar SAP-tillg√•ngar till Azure. Mer information finns i [den h√§r][vpn-gateway-cross-premises-options] artikeln och [detta][vpn-gateway-site-to-site-create].
* Azure Monitoring Extension, f√∂rb√§ttrad √∂vervakning och Azure-till√§gg f√∂r SAP: Beskriv ett och samma objekt. Den beskriver ett VM-till√§gg som m√•ste distribueras av dig f√∂r att tillhandah√•lla grundl√§ggande data om Azure-infrastrukturen till SAP-v√§rd agenten. SAP i SAP-anteckningar kan referera till det som √∂vervaknings till√§gg eller f√∂rb√§ttrad √∂vervakning. I Azure refererar vi till det som Azure- **till√§gg f√∂r SAP**.

> [!NOTE]
> Mellan lokala eller hybrid distributioner av SAP-system d√§r Azure Virtual Machines som k√∂r SAP-system √§r medlemmar i en lokal dom√§n som st√∂ds f√∂r produktion av SAP-system. Lokala eller hybrid konfigurationer st√∂ds f√∂r att distribuera delar eller slutf√∂ra SAP-landskap till Azure. √Ñven om du k√∂r hela SAP liggande i Azure m√•ste de virtuella datorerna vara en del av den lokala dom√§nen och ADS/OpenLDAP. 
>
>



### <a name="e55d1e22-c2c8-460b-9897-64622a34fdff"></a>Resurser
Start punkten f√∂r SAP-arbetsbelastningen p√• Azure-dokumentationen finns [h√§r](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/get-started). Fr√•n och med den h√§r start punkten hittar du m√•nga artiklar som beskriver avsnitten i:

- SAP NetWeaver och Business One p√• Azure
- SAP DBMS-handb√∂cker f√∂r olika DBMS-system i Azure
- H√∂g tillg√§nglighet och haveri beredskap f√∂r SAP-arbetsbelastningar p√• Azure
- Detaljerad v√§gledning f√∂r att k√∂ra SAP HANA p√• Azure
- V√§gledning som √§r s√§rskilt f√∂r Azure HANA-stora instanser f√∂r SAP HANA-DBMS 


> [!IMPORTANT]
> N√§r det √§r m√∂jligt anv√§nds en l√§nk till de refererande SAP-installations guiderna eller annan SAP-dokumentation (referens InstGuide-01, se <http://service.sap.com/instguides>). N√§r det g√§ller f√∂ruts√§ttningarna, installations processen eller information om s√§rskilda SAP-funktioner b√∂r SAP-dokumentationen och guiderna alltid l√§sas noga, eftersom Microsoft-dokumenten bara t√§cker vissa uppgifter f√∂r SAP-program som √§r installerade och k√∂rs i en Microsoft Azure virtuell dator.
>
>

F√∂ljande SAP-anteckningar √§r relaterade till √§mnet i SAP p√• Azure:

| Antecknings nummer | Rubrik |
| --- | --- |
| [1928533] |SAP-program p√• Azure: produkter och storlek som st√∂ds |
| [2015553] |SAP p√• Microsoft Azure: st√∂d f√∂r krav |
| [1999351] |Fels√∂ka ut√∂kad Azure-√∂vervakning f√∂r SAP |
| [2178632] |Nyckel √∂vervaknings m√•tt f√∂r SAP p√• Microsoft Azure |
| [1409604] |Virtualisering i Windows: f√∂rb√§ttrad √∂vervakning |
| [2191498] |SAP p√• Linux med Azure: f√∂rb√§ttrad √∂vervakning |
| [2243692] |Linux p√• Microsoft Azure (IaaS) virtuell dator: SAP-licens problem |
| [1984787] |SUSE LINUX Enterprise Server 12: installations information |
| [2002167] |Red Hat Enterprise Linux 7. x: installation och uppgradering |
| [2069760] |Oracle Linux 7. x SAP-installation och uppgradering |
| [1597355] |Rekommendation f√∂r v√§xlings utrymme f√∂r Linux |

L√§s √§ven [SCN-wikin](https://wiki.scn.sap.com/wiki/display/HOME/SAPonLinuxNotes) som inneh√•ller alla SAP-anteckningar f√∂r Linux.

Allm√§nna standard begr√§nsningar och maximala begr√§nsningar f√∂r Azure-prenumerationer finns i [den h√§r artikeln][azure-resource-manager/management/azure-subscription-service-limits-subscription].

## <a name="possible-scenarios"></a>M√∂jliga scenarier
SAP visas ofta som ett av de mest verksamhets kritiska programmen i f√∂retag. Arkitekturen och √•tg√§rderna i dessa program √§r huvudsakligen komplexa och s√§kerst√§ller att du uppfyller kraven p√• tillg√§nglighet och prestanda √§r viktigt.

D√§rf√∂r m√•ste f√∂retag t√§nka noga om vilken moln leverant√∂r som ska v√§ljas f√∂r att k√∂ra aff√§rs kritiska aff√§rs processer p√•. Azure √§r den perfekta offentliga moln plattformen f√∂r aff√§rs kritiska SAP-program och aff√§rs processer. Med tanke p√• den stora m√§ngden Azure-infrastruktur kan n√§stan alla befintliga SAP-NetWeaver och S/4HANA-system finnas i Azure idag. Azure tillhandah√•ller virtuella datorer med m√•nga terabyte minne och mer √§n 200 processorer. Ut√∂ver att Azure erbjuder [Hana-stora instanser](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture), som till√•ter skalbara Hana-distributioner p√• upp till 24TB och skalbara Hana-distributioner p√• upp till 120 TB. En kan ange idag att n√§stan alla lokala SAP-scenarier kan k√∂ras i Azure ocks√•. 

En grov Beskrivning av scenarierna och vissa scenarier som inte st√∂ds finns i dokumentet SAP- [arbetsbelastning i scenarier med virtuella Azure-datorer som st√∂ds](./sap-planning-supported-configurations.md).

Kontrol lera de h√§r scenarierna och n√•gra av de villkor som har angetts som ej st√∂ds i den h√§nvisade dokumentationen genom att planera och utveckla den arkitektur som du vill distribuera till Azure.

√ñvergripande det vanligaste distributions m√∂nstret √§r ett scenario med flera platser som visas

![VPN med plats-till-plats-anslutning (mellan platser)][planning-guide-figure-300]

Anledningen till att m√•nga kunder kan till√§mpa ett distributions m√∂nster f√∂r flera platser √§r att det √§r s√• stort att det √§r genomskinligt f√∂r alla program att ut√∂kas lokalt till Azure med Azure ExpressRoute och behandla Azure som ett virtuellt Data Center. N√§r fler och fler till g√•ngar flyttas till Azure kommer den Azure-distribuerade infrastrukturen och n√§tverks infrastrukturen att v√§xa och de lokala resurserna kommer att minska i enlighet med detta. Allt som √§r transparent f√∂r anv√§ndare och program.

F√∂r att kunna distribuera SAP-system till antingen Azure IaaS eller IaaS i allm√§nhet √§r det viktigt att f√∂rst√• de betydande skillnaderna mellan erbjudandena f√∂r traditionella Outsourcer eller v√§rdar och IaaS-erbjudanden. Den traditionella v√§rddatorn eller utl√∂saren anpassar infrastrukturen (n√§tverk, lagring och server typ) till arbets belastningen som en kund vill vara v√§rd f√∂r, det √§r i st√§llet kundens eller partnerns ansvar att karakterisera arbets belastningen och v√§lja r√§tt Azure komponenter f√∂r virtuella datorer, lagring och n√§tverk f√∂r IaaS-distributioner.

F√∂r att kunna samla in data f√∂r planering av distributionen till Azure √§r det viktigt att:

- Utv√§rdera vilka SAP-produkter som st√∂ds k√∂rs p√• virtuella Azure-datorer
- Utv√§rdera vilka speciella operativ system versioner som st√∂ds av vissa virtuella Azure-datorer f√∂r dessa SAP-produkter
- Utv√§rdera vilka DBMS-versioner som st√∂ds f√∂r dina SAP-produkter med vissa virtuella Azure-datorer
- Utv√§rdera om n√•gra av de n√∂dv√§ndiga OS/DBMS-versionerna kr√§ver att du utf√∂r SAP-version, uppgradering av support paket och kernel-uppgraderingar f√∂r att komma till en konfiguration som st√∂ds
- Utv√§rdera om du beh√∂ver flytta till olika operativ system f√∂r att kunna distribuera p√• Azure.

Information om SAP-komponenter som st√∂ds p√• Azure, Azure-infrastrukturs enheter som st√∂ds och relaterade operativ Systems versioner och DBMS-versioner beskrivs i artikeln [vilka SAP-program som st√∂ds f√∂r Azure-distributioner](./sap-supported-product-on-azure.md). Resultat som erh√•lls fr√•n utv√§rderingen av giltiga SAP-versioner, operativ system och DBMS-versioner har stor p√•verkan p√• anstr√§ngningarna att flytta SAP-system till Azure. Resultat fr√•n den h√§r utv√§rderingen √§r att definiera om det skulle kunna vara betydande f√∂rberedelse anstr√§ngningar i fall d√§r SAP release-uppgraderingar eller √§ndringar av operativ system beh√∂vs.



## <a name="first-steps-planning-a-deployment"></a>F√∂rsta stegen planera en distribution
Det f√∂rsta steget i distributions planeringen √§r att inte s√∂ka efter virtuella datorer som √§r tillg√§ngliga f√∂r att k√∂ra SAP. Det f√∂rsta steget kan vara en tids kr√§vande, men viktigast √§r att arbeta med efterlevnads-och s√§kerhets team i f√∂retaget p√• vilka gr√§ns villkor som g√§ller f√∂r att distribuera vilken typ av SAP-arbetsbelastning eller aff√§rs process till ett offentligt moln. Om ditt f√∂retag distribuerar annan program vara innan du i Azure, kan processen vara l√§tt. Om ditt f√∂retag √§r mer i b√∂rjan av resan kan det finnas st√∂rre diskussioner som √§r n√∂dv√§ndiga f√∂r att ta reda p√• gr√§ns villkoren, s√§kerhets villkor, som g√∂r att vissa SAP-data och SAP-aff√§rsprocesser kan hanteras i ett offentligt moln.

Som anv√§ndbar hj√§lp kan du peka p√• [Microsoft Compliance-erbjudanden](https://docs.microsoft.com/microsoft-365/compliance/offering-home) f√∂r en lista √∂ver efterlevnadsprinciper som Microsoft kan tillhandah√•lla. 

Andra fr√•gor som data kryptering f√∂r data i rest eller annan kryptering i Azure-tj√§nsten dokumenteras i [√ñversikt √∂ver Azure-kryptering](https://docs.microsoft.com/azure/security/fundamentals/encryption-overview).

Funktionen underskattar inte den h√§r fasen av projektet i planeringen. Endast n√§r du har avtal och regler kring det h√§r avsnittet m√•ste du g√• till n√§sta steg, som √§r planeringen av den n√§tverks arkitektur som du distribuerar i Azure.



## <a name="microsoft-azure-virtual-machine-services"></a>Microsoft Azure tj√§nster f√∂r virtuella datorer
Microsoft Azures plattformen √§r en plattform f√∂r moln tj√§nster p√• Internet som √§r v√§rd f√∂r och drivs i Microsoft Data Center. Plattformen inneh√•ller Microsoft Azure virtuella dator tj√§nster (infrastruktur som en tj√§nst eller IaaS) och en upps√§ttning funktioner f√∂r att PaaS-funktioner (Platform as a Service).

Azure-plattformen minskar behovet av upp-front-teknik och infrastruktur ink√∂p. Det f√∂ren klar underh√•ll och drift program genom att tillhandah√•lla ber√§knings-och lagrings utrymme p√• beg√§ran f√∂r att vara v√§rd f√∂r, skala och hantera webb program och anslutna program. Infrastruktur hantering automatiseras med en plattform som √§r utformad f√∂r h√∂g tillg√§nglighet och dynamisk skalning f√∂r att matcha anv√§ndnings behov med alternativet f√∂r en pris modell enligt principen betala per anv√§ndning.

![Placering av Microsoft Azure virtuella dator tj√§nster][planning-guide-figure-400]

Med Azure Virtual Machine-tj√§nster √§r det m√∂jligt f√∂r Microsoft att distribuera anpassade Server avbildningar till Azure som IaaS-instanser. Virtual Machines i Azure baseras p√• virtuella h√•rd diskar (VHD) och kan k√∂ra olika operativ system som g√§st operativ system.

I ett drifts perspektiv erbjuder Azure Virtual Machine-tj√§nsten liknande upplevelser som virtuella datorer som distribueras lokalt. Det har dock stor nytta av att du inte beh√∂ver k√∂pa, administrera och hantera infrastrukturen. Utvecklare och administrat√∂rer har fullst√§ndig kontroll √∂ver operativ system avbildningen p√• de h√§r virtuella datorerna. Administrat√∂rer kan logga in via fj√§rr anslutning p√• de virtuella datorerna f√∂r att utf√∂ra underh√•lls-och fel s√∂knings aktiviteter samt program distributions uppgifter. Vad g√§ller distribution √§r de enda begr√§nsningarna storlekarna och funktionerna i virtuella Azure-datorer. Dessa storlekar kanske inte √§r lika detaljerade i konfigurationen eftersom det kan g√∂ras lokalt. Det finns ett urval av VM-typer som representerar en kombination av:

* Antal virtuella processorer
* Minne
* Antal virtuella h√•rd diskar som kan kopplas
* N√§tverks-och lagrings bandbredd

Storlek och begr√§nsningar f√∂r olika storlekar p√• virtuella datorer som erbjuds kan visas i en tabell i [den h√§r artikeln (Linux)][virtual-machines-sizes-linux] och [den h√§r artikeln (Windows)][virtual-machines-sizes-windows].

Det √§r inte s√§kert att alla olika VM-serier erbjuds i var och en av Azure-regionerna. T√§nk ocks√• p√• att inte alla virtuella datorer eller VM-serier √§r certifierade f√∂r SAP.

> [!IMPORTANT]
> F√∂r anv√§ndning av SAP NetWeaver, S/4HANA och SAP HANA, st√∂ds bara den delm√§ngd av VM-typer och konfigurationer som anges i SAP anm√§rkning [1928533] . F√∂r SAP HANA certifierade Azure-enheter kontrollerar du [SAP HANA maskin varu katalog](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#categories=Microsoft%20Azure)
>

Microsoft Azures plattformen √§r en plattform f√∂r flera innehavare. Det leder till att lagring, n√§tverk och andra resurser delas mellan klienter. Intelligent begr√§nsning och kvot logik anv√§nds f√∂r att f√∂rhindra att en klient p√•verkar prestandan hos en annan klient (sv√•r granne) p√• ett drastiskt s√§tt. S√§rskilt f√∂r att certifiera Azure-plattformen f√∂r SAP HANA m√•ste Microsoft bevisa resurs isoleringen f√∂r de fall d√§r flera virtuella datorer kan k√∂ras p√• samma v√§rd regelbundet till SAP. √Ñven om logiken i Azure f√∂rs√∂ker beh√•lla varianser i bandbredden som √§r sm√•, √§r det mycket delade plattformar att introducera st√∂rre varianser i tillg√§nglighet f√∂r resurs/bandbredd √§n kunder kan uppleva i sina lokala distributioner. Sannolikheten att ett SAP-system p√• Azure kan uppleva st√∂rre varianser √§n i ett lokalt system m√•ste tas med i ber√§kningen.

Kunderna m√•ste d√§rf√∂r vara bekant med de olika funktionerna i de Azure-typer som st√∂ds med SAP i f√∂ljande omr√•den:

* PROCESSOR-och minnes resurser f√∂r olika VM-typer 
* IOPS-bandbredd f√∂r olika VM-typer
* N√§tverksfunktioner f√∂r olika VM-typer

De flesta av dessa data hittar du [h√§r (Linux)][virtual-machines-sizes-linux] och [h√§r (Windows)][virtual-machines-sizes-windows].


### <a name="be80d1b9-a463-4845-bd35-f4cebdb5424a"></a>Azure-regioner
Virtual Machines distribueras till s√• kallade *Azure-regioner*. En Azure-region kan vara en eller flera data Center som finns n√§ra varandra. F√∂r de flesta regionerna i v√§rlden har Microsoft minst tv√• Azure-regioner. I Europa finns det till exempel en Azure-region i *Nord Europa* och *en av V√§steuropa*. S√•dana tv√• Azure-regioner i ett geografiskt politisk region skiljs √•t med tillr√§ckligt stort avst√•nd s√• att fysiska eller tekniska haveri effekter inte p√•verkar b√•de Azure-regioner i samma geografiskt politisk region. Eftersom Microsoft st√§ndigt skapar nya Azure-regioner i olika politiska regioner globalt, v√§xer antalet regioner st√§ndigt och fr√•n och med dec 2015 uppn√•s antalet 20 Azure-regioner med ytterligare regioner som redan har meddelats. Du som kund kan distribuera SAP-system i alla dessa regioner, inklusive de tv√• Azure-regionerna i Kina. Aktuell information om Azure-regioner finns p√• f√∂ljande webbplats: <https://azure.microsoft.com/regions/>

### <a name="8d8ad4b8-6093-4b91-ac36-ea56d80dbf77"></a>Koncept f√∂r Microsoft Azure virtuell dator
Microsoft Azure erbjuder en IaaS-l√∂sning (Infrastructure as a Service) som fungerar som v√§rd f√∂r Virtual Machines med liknande funktioner som en lokal virtualiseringsl√∂sning. Du kan skapa Virtual Machines inifr√•n Azure Portal, PowerShell eller CLI, som √§ven erbjuder funktioner f√∂r distribution och hantering.

Med Azure Resource Manager kan du etablera dina program med hj√§lp av en deklarativ mall. I samma mall kan du distribuera flera tj√§nster tillsammans med deras beroenden. Du anv√§nder samma mall f√∂r att distribuera programmet flera g√•nger under varje fas av programmets livs cykel.

Mer information om hur du anv√§nder Resource Manager-mallar finns h√§r:

* [Distribuera och hantera virtuella datorer med hj√§lp av Azure Resource Manager mallar och Azure CLI](../../linux/create-ssh-secured-vm-from-template.md)
* [Hantera virtuella datorer med hj√§lp av Azure Resource Manager och PowerShell][virtual-machines-deploy-rmtemplates-powershell]
* <https://azure.microsoft.com/documentation/templates/>

En annan intressant funktion √§r m√∂jligheten att skapa bilder fr√•n Virtual Machines, vilket g√∂r att du kan f√∂rbereda vissa databaser d√§r du snabbt kan distribuera virtuella dator instanser som uppfyller dina krav.

Mer information om hur du skapar bilder fr√•n Virtual Machines finns i [den h√§r artikeln (Linux)][virtual-machines-linux-capture-image-resource-manager] och [den h√§r artikeln (Windows)][virtual-machines-windows-capture-image-resource-manager].

#### <a name="df49dc09-141b-4f34-a4a2-990913b30358"></a>Fel dom√§ner
Fel dom√§ner representerar en fysisk felenhet, n√§ra relaterad till den fysiska infrastrukturen i Data Center, medan ett fysiskt blad eller en rack kan betraktas som en feldom√§n, det finns ingen direkt mappning mellan de tv√•.

N√§r du distribuerar flera Virtual Machines som en del av ett SAP-system i Microsoft Azure virtuella dator tj√§nster kan du p√•verka Azure Fabric Controller f√∂r att distribuera programmet till olika fel dom√§ner, vilket uppfyller kraven i Microsoft Azure service avtal. Distributionen av fel dom√§ner i en Azure-Scale-enhet (samling av hundratals datornoder eller lagringsnoder och n√§tverk) eller tilldelningen av virtuella datorer till en speciell fel dom√§n √§r dock n√•got som du inte har direkt kontroll √∂ver. F√∂r att dirigera Azure Fabric-styrenheten f√∂r att distribuera en upps√§ttning virtuella datorer √∂ver olika fel dom√§ner m√•ste du tilldela en Azure-tillg√§nglighets upps√§ttning till de virtuella datorerna vid distributions tillf√§llet. Mer information om Azures tillg√§nglighets upps√§ttningar finns i kapitel [tillg√§nglighets upps√§ttningar f√∂r Azure][planning-guide-3.2.3] i det h√§r dokumentet.

#### <a name="fc1ac8b2-e54a-487c-8581-d3cc6625e560"></a>Uppgradera dom√§ner
Uppgraderings dom√§ner representerar en logisk enhet som hj√§lper till att fastst√§lla hur en virtuell dator i ett SAP-system, som best√•r av SAP-instanser som k√∂rs i flera virtuella datorer, uppdateras. Vid en uppgradering g√•r Microsoft Azure igenom processen med att uppdatera uppgraderings dom√§nerna en i taget. Genom att sprida virtuella datorer vid distributions tiden √∂ver olika uppgraderings dom√§ner kan du skydda ditt SAP-system delvis fr√•n potentiella stillest√•nds tider. F√∂r att Azure ska kunna distribuera de virtuella datorerna i ett SAP-system sprids √∂ver olika uppgraderings dom√§ner m√•ste du ange ett s√§rskilt attribut vid distributions tiden f√∂r varje virtuell dator. P√• liknande s√§tt som fel dom√§ner √§r en Azure Scale Unit uppdelad i flera uppgraderings dom√§ner. F√∂r att dirigera Azure Fabric-styrenheten f√∂r att distribuera en upps√§ttning virtuella datorer √∂ver olika uppgraderings dom√§ner m√•ste du tilldela en Azure-tillg√§nglighets upps√§ttning till de virtuella datorerna vid distributions tillf√§llet. Mer information om Azures tillg√§nglighets upps√§ttningar finns i kapitel [tillg√§nglighets upps√§ttningar f√∂r Azure][planning-guide-3.2.3] nedan.

#### <a name="18810088-f9be-4c97-958a-27996255c665"></a>Tillg√§nglighets upps√§ttningar i Azure
Azure-Virtual Machines inom en Azure-tillg√§nglighets upps√§ttning distribueras av Azure Fabric Controller √∂ver olika fel-och uppgraderings dom√§ner. Syftet med distributionen √∂ver olika fel-och uppgraderings dom√§ner √§r att f√∂rhindra att alla virtuella datorer i SAP-system st√§ngs vid infrastruktur underh√•ll eller fel i en fel dom√§n. Som standard ing√•r inte virtuella datorer i en tillg√§nglighets upps√§ttning. Deltagande av en virtuell dator i en tillg√§nglighets upps√§ttning definieras vid distributions tillf√§llet eller senare av en omkonfiguration och omdistribution av en virtuell dator.

L√§s [den h√§r artikeln][virtual-machines-manage-availability] f√∂r att f√∂rst√• konceptet med tillg√§nglighets upps√§ttningar i Azure och hur tillg√§nglighets upps√§ttningar relaterar till fel-och uppgraderings dom√§ner

Om du vill definiera tillg√§nglighets upps√§ttningar f√∂r Azure Resource Manager via en JSON-mall, se [specifikationerna f√∂r REST-API](https://github.com/Azure/azure-rest-api-specs/blob/master/arm-compute/2015-06-15/swagger/compute.json) och S√∂k efter "tillg√§nglighet".

### <a name="a72afa26-4bf4-4a25-8cf7-855d6032157f"></a>Lagring: Microsoft Azure Storage och data diskar
Microsoft Azure Virtual Machines anv√§nder olika lagrings typer. N√§r du implementerar SAP p√• Azure Virtual Machine-tj√§nster √§r det viktigt att f√∂rst√• skillnaderna mellan dessa tv√• huvud typer av lagring:

* Icke-best√§ndig, flyktig lagring.
* Best√§ndig lagring.

Virtuella Azure-datorer erbjuder icke-best√§ndiga diskar n√§r en virtuell dator har distribuerats. I h√§ndelse av en VM-omstart rensas allt inneh√•ll p√• dessa enheter. D√§rf√∂r √§r det en f√∂ruts√§ttning att datafiler och logg-/√•terst√§llnings fil f√∂r databaser inte b√∂r finnas p√• de icke-best√§ndiga enheterna. Det kan finnas undantag f√∂r vissa databaser, d√§r dessa icke-best√§ndiga enheter kan vara l√§mpliga f√∂r tempdb och tempor√§ra tabell utrymmen. Undvik dock att anv√§nda enheterna f√∂r virtuella datorer i A-serien eftersom dessa icke-sparade enheter √§r begr√§nsade i data fl√∂de med den virtuella dator serien. Mer information finns i artikeln [f√∂rst√• den tillf√§lliga enheten p√• virtuella Windows-datorer i Azure](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/)

---
> ![Windows][Logo_Windows] Windows
> 
> Enhets D:\ i en virtuell Azure-dator √§r en icke best√§ndig enhet som backas upp av vissa lokala diskar p√• Azure Compute-noden. Eftersom den inte √§r best√§ndig inneb√§r det att alla √§ndringar som g√∂rs i inneh√•llet p√• D:\ enheten f√∂rloras n√§r den virtuella datorn startas om. Efter "alla √§ndringar", t. ex. filer lagrade, kataloger som skapats, program som installerats osv.
> 
> ![Linux][Logo_Linux] Linux
> 
> Virtuella Linux Azure-datorer monterar automatiskt en enhet p√•/mnt/Resource som √§r en icke best√§ndig enhet som backas upp av lokala diskar p√• Azure Compute-noden. Eftersom den √§r icke-best√§ndig inneb√§r det att alla √§ndringar som g√∂rs i inneh√•llet i/mnt/Resource f√∂rloras n√§r den virtuella datorn startas om. √Ñndringar, t. ex. filer lagrade, kataloger som skapats, program som installerats osv.
> 
> 

---

Microsoft Azure Storage tillhandah√•ller best√§ndig lagring och de typiska skydds niv√•er och redundans som visas p√• SAN-lagring. Diskar som baseras p√• Azure Storage √§r virtuella h√•rd diskar (VHD: er) som finns i Azure Storage-tj√§nsterna. Den lokala OS-disken (Windows C:\, Linux-/dev/sda1) lagras p√• Azure Storage och ytterligare volymer/diskar som monteras p√• den virtuella datorn lagras √§ven d√§r.

Det g√•r att ladda upp en befintlig virtuell h√•rd disk lokalt eller skapa en tom virtuell h√•rd disk i Azure och koppla de virtuella h√•rd diskarna till distribuerade virtuella datorer.

N√§r du har skapat eller laddat upp en virtuell h√•rd disk i Azure Storage kan du montera och koppla dem till en befintlig virtuell dator och kopiera befintliga (demonterade) VHD.

Eftersom de virtuella h√•rd diskarna √§r best√•ende, √§r data och √§ndringar i de virtuella h√•rd diskarna s√§kra n√§r de startar om och √•terskapar en virtuell dator instans. √Ñven om en instans tas bort f√∂rblir de h√§r virtuella h√•rd diskarna s√§kra och kan distribueras om, eller om det g√•r att montera icke-OS-diskar p√• andra virtuella datorer.

Mer information om Azure Storage hittar du h√§r:

* <https://azure.microsoft.com/documentation/services/storage/>
* <https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>
* <https://blogs.msdn.com/b/azuresecurity/archive/2015/11/17/azure-disk-encryption-for-linux-and-windows-virtual-machines-public-preview.aspx>

#### <a name="azure-standard-storage"></a>Azure standard Storage
Azure standard Storage var den typ av lagring som √§r tillg√§nglig n√§r Azure-IaaS sl√§pptes. Det g√§llde IOPS-kvoter per enskild disk. Svars tiden upplevde inte i samma klass som SAN/NAS-enheter som vanligt vis har distribuerats f√∂r avancerade SAP-system som finns lokalt. Azure standard-lagring visat sig vara tillr√§ckligt f√∂r m√•nga hundratals SAP-system under tiden som distribuerats i Azure.

Diskar som lagras p√• Azures standard lagrings konton debiteras baserat p√• faktiska data som lagras, volymen lagrings transaktioner, utg√•ende data √∂verf√∂ringar och alternativ f√∂r redundans som valts. M√•nga diskar kan skapas med maximalt 1 TB storlek, men om de inte √§r tomma √§r det ingen kostnad. Om du sedan fyller en virtuell h√•rd disk med 100 GB, debiteras du f√∂r lagring av 100 GB och inte f√∂r den nominella storlek som den virtuella h√•rd disken skapades med.

#### <a name="ff5ad0f9-f7f4-4022-9102-af07aef3bc92"></a>Azure-Premium Storage
Azure Premium Storage lanserades med m√•let att tillhandah√•lla:

* B√§ttre I/O-latens.
* B√§ttre data fl√∂de.
* Mindre variation i i/O-latens.

I detta syfte har m√•nga √§ndringar inf√∂rts och vilka de tv√• viktigaste √§r:

* Anv√§ndning av SSD-diskar i Azure Storage noder
* En ny Read cache som backas upp av den lokala SSD-noden i en Azure-datornod

I motsats till standard lagring d√§r funktionerna inte √§ndrades beroende p√• storleken p√• disken (eller VHD) har Premium Storage f√∂r n√§rvarande tre olika disk kategorier, som visas i den h√§r artikeln: <https://azure.microsoft.com/pricing/details/storage/unmanaged-disks/>

Du ser att IOPS/disk och disk data fl√∂de/disk √§r beroende av storleks kategorin f√∂r diskarna

Kostnads grund f√∂r Premium Storage √§r inte den faktiska data volym som lagras p√• s√•dana diskar, men storleks kategorin f√∂r en s√•dan disk, oberoende av m√§ngden data som lagras p√• disken.

Du kan ocks√• skapa diskar p√• Premium Storage som inte √§r direkt mappar till de storleks kategorier som visas. Detta kan vara fallet, s√§rskilt n√§r du kopierar diskar fr√•n standard lagring till Premium Storage. I s√•dana fall utf√∂rs en mappning till n√§sta st√∂rsta Premium Storage disk alternativ.

De flesta Azure VM-familjer som certifierats med SAP kan arbeta med Premium Storage och eller en blandning mellan Azure standard och Premium Storage.

Om du checkar ut delen i VM-seriens virtuella datorer i [den h√§r artikeln (Linux)][virtual-machines-sizes-linux] och [den h√§r artikeln (Windows)][virtual-machines-sizes-windows]inser du att det finns data volym begr√§nsningar f√∂r Premium Storage diskar p√• VM-niv√•ns kornig het. Andra virtuella datorer i DS-serien eller GS-serien har ocks√• olika begr√§nsningar f√∂r antalet data diskar som kan monteras. Dessa gr√§nser beskrivs ocks√• i den artikel som n√§mns ovan. Men i grunden inneb√§r det att om du t. ex. monterar 32 x P30-diskar till en enskild DS14 VM kan du inte f√• 32 x maximalt data fl√∂de f√∂r en P30-disk. I st√§llet begr√§nsas det maximala data fl√∂det p√• VM-niv√• enligt beskrivningen i artikeln.

Mer information om Premium Storage hittar du h√§r: <https://azure.microsoft.com/blog/2015/04/16/azure-premium-storage-now-generally-available-2>

#### <a name="azure-storage-accounts"></a>Azure Storage konton

N√§r du distribuerar tj√§nster eller virtuella datorer i Azure kan distribution av virtuella h√•rd diskar och VM-avbildningar ordnas i enheter som kallas Azure Storage-konton. N√§r du planerar en Azure-distribution m√•ste du noggrant √∂verv√§ga begr√§nsningarna i Azure. P√• den ena sidan finns det ett begr√§nsat antal lagrings konton per Azure-prenumeration. √Ñven om varje Azure Storage konto kan inneh√•lla ett stort antal VHD-filer, finns det en fast gr√§ns f√∂r det totala antalet IOPS per lagrings konto. N√§r du distribuerar hundratals virtuella SAP-datorer med DBMS-system som skapar betydande IO-anrop, rekommenderar vi att du distribuerar virtuella IOPS-DBMS virtuella datorer mellan flera Azure Storage-konton. V√•rd m√•ste inte √∂verskrida den aktuella gr√§nsen f√∂r Azure Storage konton per prenumeration. Eftersom lagring √§r en viktig del av databas distributionen f√∂r ett SAP-system, diskuteras det h√§r konceptet i detalj i den redan refererade [DBMS-distributions guiden][dbms-guide].

Mer information om Azure Storage-konton finns i [skalbarhets m√•len f√∂r standard lagrings konton](../../../storage/common/scalability-targets-standard-account.md) och [skalbarhets m√•l f√∂r Premium Page Blob Storage-konton](../../../storage/blobs/scalability-targets-premium-page-blobs.md). Genom att l√§sa de h√§r artiklarna inser du att det finns skillnader i begr√§nsningarna mellan Azure standard Storage-konton och Premium Storage-konton. St√∂rre skillnader √§r m√§ngden data som kan lagras i ett s√•dant lagrings konto. I standard lagring √§r volymen en st√∂rre storlek √§n med Premium Storage. P√• den andra sidan √§r standard lagrings kontot i h√∂g grad begr√§nsat i IOPS (se kolumn **Total beg√§r ande frekvens**), medan Azure Premium Storage-kontot inte har n√•gon s√•dan begr√§nsning. Vi kommer att diskutera information och resultat av dessa skillnader n√§r du diskuterar distributioner av SAP-system, s√§rskilt DBMS-servrarna.

Inom ett lagrings konto har du m√∂jlighet att skapa olika beh√•llare i syfte att organisera och kategorisera olika virtuella h√•rd diskar. Dessa beh√•llare anv√§nds till exempel separata virtuella h√•rd diskar f√∂r olika virtuella datorer. Det finns inga prestanda konsekvenser i att bara anv√§nda en beh√•llare eller flera beh√•llare under ett enda Azure Storage konto.

I Azure visas ett VHD-namn efter f√∂ljande namn anslutning som m√•ste ange ett unikt namn f√∂r den virtuella h√•rd disken i Azure:

    http(s)://<storage account name>.blob.core.windows.net/<container name>/<vhd name>

Str√§ngen ovan m√•ste vara unikt identifiera den virtuella h√•rd disk som lagras p√• Azure Storage.

#### <a name="c55b2c6e-3ca1-4476-be16-16c81927550f"></a>Managed Disks

Managed Disks √§r en ny resurs typ i Azure Resource Manager som kan anv√§ndas i st√§llet f√∂r virtuella h√•rd diskar som lagras i Azure Storage konton. Managed Disks automatiskt justeras mot tillg√§nglighets upps√§ttningen f√∂r den virtuella datorn som de √§r kopplade till och d√§rf√∂r √∂kar tillg√§ngligheten f√∂r den virtuella datorn och de tj√§nster som k√∂rs p√• den virtuella datorn. Mer information finns i [√∂versikts artikeln](https://docs.microsoft.com/azure/storage/storage-managed-disks-overview).

Vi rekommenderar att du anv√§nder hanterad disk, eftersom de f√∂ren klar distributionen och hanteringen av dina virtuella datorer.
SAP st√∂der f√∂r n√§rvarande endast Premium Managed Disks. Mer information finns i SAP NOTE [1928533].

#### <a name="microsoft-azure-storage-resiliency"></a>Microsoft Azure Storage √•terh√§mtning

Microsoft Azure Storage lagrar den grundl√§ggande virtuella h√•rd disken (med OS) och anslutna diskar eller BLOBBAR p√• minst tre separata lagringsnoder. Detta faktum kallas lokalt redundant lagring (LRS). LRS √§r standard f√∂r alla typer av lagring i Azure. 

Det finns flera olika typer av redundans, som beskrivs i artikeln [Azure Storage replikering](https://docs.microsoft.com/azure/storage/common/storage-redundancy?toc=%2fazure%2fstorage%2fqueues%2ftoc.json).

> [!NOTE]
>Fr√•n och med Azure Premium Storage, vilket √§r den rekommenderade typen av lagring f√∂r virtuella DBMS-datorer och diskar som lagrar databas-och logg-/√•terskapa-filer, √§r den enda tillg√§ngliga metoden LRS. D√§rf√∂r m√•ste du konfigurera databas metoder, t. ex. SQL Server Always on, Oracle data Guard eller HANA-systemreplikering f√∂r att aktivera databasreplikering till en annan Azure-region eller en annan Azure-tillg√§nglighets zon.


> [!NOTE]
> F√∂r DBMS-distributioner rekommenderas inte anv√§ndningen av Geo-redundant lagring som tillg√§nglig med Azure standard Storage eftersom den har allvarlig prestanda p√•verkan och inte besvarar Skriv ordningen mellan olika virtuella h√•rd diskar som √§r anslutna till en virtuell dator. Det faktum att det inte g√•r att anv√§nda Skriv ordningen mellan olika virtuella h√•rd diskar √§r en h√∂g potential f√∂r att f√• fram inkonsekventa databaser p√• replikerings sidan om databasen och logg/g√∂r om filer sprids √∂ver flera virtuella h√•rd diskar (s√• ofta fallet) p√• den virtuella k√§ll datorn.


### <a name="61678387-8868-435d-9f8c-450b2424f5bd"></a>Microsoft Azure n√§tverk

Microsoft Azure tillhandah√•ller en n√§tverks infrastruktur som till√•ter mappning av alla scenarier, som vi vill realisera med SAP-programvara. Funktionerna √§r:

* √Ötkomst fr√•n utsidan, direkt till de virtuella datorerna via Windows Terminal Services eller SSH/VNC
* √Ötkomst till tj√§nster och vissa portar som anv√§nds av program i de virtuella datorerna
* Intern kommunikation och namn matchning mellan en grupp virtuella datorer som distribueras som virtuella Azure-datorer
* Anslutning mellan olika platser mellan en kunds lokala n√§tverk och Azure-n√§tverket
* Mellan Azure-region eller data Center anslutning mellan Azure-platser

Mer information finns h√§r: <https://azure.microsoft.com/documentation/services/virtual-network/>

Det finns m√•nga olika m√∂jligheter att konfigurera namn och IP-matchning i Azure. Det finns ocks√• en Azure DNS tj√§nst som kan anv√§ndas i st√§llet f√∂r att konfigurera en egen DNS-server. Mer information finns i [den h√§r artikeln][virtual-networks-manage-dns-in-vnet] och p√• [den h√§r sidan](https://azure.microsoft.com/services/dns/).

F√∂r Cross-premises-eller hybrid scenarier f√∂rlitar vi sig p√• att den lokala AD/OpenLDAP/DNS har ut√∂kats via VPN eller privat anslutning till Azure. F√∂r vissa scenarier som dokumenteras h√§r kan det vara n√∂dv√§ndigt att ha en AD-OpenLDAP-replik installerad i Azure.

Eftersom n√§tverk och namn matchning √§r en viktig del av databas distributionen f√∂r ett SAP-system, diskuteras det h√§r konceptet mer detaljerat i [distributions guiden f√∂r DBMS][dbms-guide].

##### <a name="azure-virtual-networks"></a>Azure Virtual Networks

Genom att skapa en Azure-Virtual Network kan du definiera adress intervallet f√∂r de privata IP-adresser som allokerats av Azure DHCP-funktioner. I scenarier med flera platser allokeras det angivna IP-adressintervallet fortfarande med hj√§lp av DHCP av Azure. Dom√§n namns matchning g√∂rs dock lokalt (f√∂rutsatt att de virtuella datorerna √§r en del av en lokal dom√§n) och d√§rmed kan matcha adresser bortom olika Azure-Cloud Services.

Varje virtuell dator i Azure m√•ste vara ansluten till en Virtual Network.

Mer information hittar du i [den h√§r artikeln][resource-groups-networking] och p√• [den h√§r sidan](https://azure.microsoft.com/documentation/services/virtual-network/).


> [!NOTE]
> N√§r en virtuell dator har distribuerats kan du som standard inte √§ndra Virtual Network-konfigurationen. TCP/IP-inst√§llningarna m√•ste vara kvar p√• Azure DHCP-servern. Standard beteendet √§r dynamisk IP-tilldelning.
>
>

MAC-adressen f√∂r det virtuella n√§tverkskortet kan √§ndras, till exempel efter storleks √§ndring och Windows-eller Linux-g√§sten h√§mtar det nya n√§tverkskortet och automatiskt anv√§nder DHCP f√∂r att tilldela IP-och DNS-adresser i det h√§r fallet.

##### <a name="static-ip-assignment"></a>Statisk IP-tilldelning
Det √§r m√∂jligt att tilldela fasta eller reserverade IP-adresser till virtuella datorer i ett Azure-Virtual Network. Om du k√∂r de virtuella datorerna i ett Azure-Virtual Network √∂ppnas en bra m√∂jlighet att anv√§nda den h√§r funktionen om det beh√∂vs eller kr√§vs f√∂r vissa scenarier. IP-tilldelningen √§r giltig f√∂r hela den virtuella datorn, oberoende av om den virtuella datorn k√∂rs eller st√§ngs av. D√§rf√∂r m√•ste du ange det totala antalet virtuella datorer (som k√∂r och stoppade virtuella datorer) i kontot n√§r du definierar intervallet f√∂r IP-adresser f√∂r Virtual Network. IP-adressen √§r tilldelad antingen tills den virtuella datorn och dess n√§tverks gr√§nssnitt tas bort eller tills IP-adressen tilldelas p√• nytt. Mer information finns i [den h√§r artikeln][virtual-networks-static-private-ip-arm-pportal].

> [!NOTE]
> Du b√∂r tilldela statiska IP-adresser via Azure till enskilda virtuella n√§tverkskort. Du b√∂r inte tilldela statiska IP-adresser i g√§st operativ systemet till en vNIC. Vissa Azure-tj√§nster som Azure Backup-tj√§nsten √§r beroende av att minst prim√§r vNIC √§r inst√§lld p√• DHCP och inte statiska IP-adresser. Se √§ven dokumentet [Fels√∂ka s√§kerhets kopiering av virtuella Azure-datorer](https://docs.microsoft.com/azure/backup/backup-azure-vms-troubleshoot#networking).
>
>

##### <a name="multiple-nics-per-vm"></a>Flera n√§tverkskort per virtuell dator

Du kan definiera flera virtuella n√§tverks gr√§nssnitts kort (vNIC) f√∂r en virtuell Azure-dator. Med m√∂jligheten att ha flera virtuella n√§tverkskort kan du b√∂rja konfigurera n√§tverks trafik separation d√§r exempelvis klient trafik dirigeras genom en vNIC och Server dels trafik dirigeras genom en andra vNIC. Beroende av typen av virtuell dator finns det olika begr√§nsningar f√∂r antalet virtuella n√§tverkskort som en virtuell dator kan ha tilldelats. Detaljerad information, funktioner och begr√§nsningar finns i f√∂ljande artiklar:

* [Skapa en virtuell Windows-dator med flera n√§tverkskort][virtual-networks-multiple-nics-windows]
* [Skapa en virtuell Linux-dator med flera n√§tverkskort][virtual-networks-multiple-nics-linux]
* [Distribuera virtuella datorer med flera n√§tverkskort med en mall][virtual-network-deploy-multinic-arm-template]
* [Distribuera virtuella datorer med flera n√§tverkskort med hj√§lp av PowerShell][virtual-network-deploy-multinic-arm-ps]
* [Distribuera virtuella datorer med flera n√§tverkskort med hj√§lp av Azure CLI][virtual-network-deploy-multinic-arm-cli]

#### <a name="site-to-site-connectivity"></a>Plats-till-plats-anslutning

Virtuella Azure-datorer och lokala n√§tverk √§r l√§nkade till en transparent och permanent VPN-anslutning. Det f√∂rv√§ntas bli det vanligaste distributions m√∂nstret f√∂r SAP i Azure. Antagande √§r att operativa procedurer och processer med SAP-instanser i Azure b√∂r fungera transparent. Det inneb√§r att du b√∂r kunna skriva ut fr√•n dessa system samt anv√§nda SAP transport Management system (TMS) f√∂r att transportera √§ndringar fr√•n ett utvecklings system i Azure till ett test system som distribueras lokalt. Mer dokumentation kring plats-till-plats finns i [den h√§r artikeln][vpn-gateway-create-site-to-site-rm-powershell]

##### <a name="vpn-tunnel-device"></a>VPN-tunnel enhet

F√∂r att skapa en plats-till-plats-anslutning (lokalt Data Center till Azure Data Center) m√•ste du antingen h√§mta och konfigurera en VPN-enhet eller anv√§nda tj√§nsten Routning och fj√§rr√•tkomst (RRAS) som introducerades som en program varu komponent med Windows Server 2012.

* [Skapa ett virtuellt n√§tverk med en plats-till-plats-VPN-anslutning med PowerShell][vpn-gateway-create-site-to-site-rm-powershell]
* [Om VPN-enheter f√∂r plats-till-plats-VPN Gateway-anslutningar][vpn-gateway-about-vpn-devices]
* [Vanliga fr√•gor och svar om VPN Gateway][vpn-gateway-vpn-faq]

![Plats-till-plats-anslutning mellan lokala platser och Azure][planning-guide-figure-600]

Bilden ovan visar tv√• Azure-prenumerationer som har reserverade IP-adresser f√∂r anv√§ndning i virtuella n√§tverk i Azure. Anslutningen fr√•n det lokala n√§tverket till Azure uppr√§ttas via VPN.

#### <a name="point-to-site-vpn"></a>Punkt-till-plats-VPN

Punkt-till-plats-VPN kr√§ver att varje klient dator ansluter med sin egen VPN till Azure. F√∂r SAP-scenarier tittar vi p√•, punkt-till-plats-anslutning √§r inte praktiskt. D√§rf√∂r ges inga ytterligare referenser till punkt-till-plats-VPN-anslutning.

Mer information hittar du h√§r
* [Konfigurera en punkt-till-plats-anslutning till ett VNet med Azure-portalen](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)
* [Konfigurera en punkt-till-plats-anslutning till ett VNet med PowerShell](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps)

#### <a name="multi-site-vpn"></a>VPN f√∂r flera platser

Azure nuf√∂rtiden erbjuder ocks√• m√∂jligheten att skapa VPN-anslutningar p√• flera platser f√∂r en Azure-prenumeration. Tidigare var en enskild prenumeration begr√§nsad till en plats-till-plats-VPN-anslutning. Den h√§r begr√§nsningen gick bort med VPN-anslutningar p√• flera platser f√∂r en enda prenumeration. Detta g√∂r det m√∂jligt att anv√§nda mer √§n en Azure-region f√∂r en speciell prenumeration genom konfigurationer med flera platser.

Mer dokumentation finns i [den h√§r artikeln][vpn-gateway-create-site-to-site-rm-powershell]

#### <a name="vnet-to-vnet-connection"></a>VNet-till-VNet-anslutning

Med VPN f√∂r flera platser m√•ste du konfigurera en separat Azure-Virtual Network i varje region. Du har dock ofta kravet att program komponenterna i de olika regionerna ska kommunicera med varandra. Vi rekommenderar att denna kommunikation inte vidarebefordras fr√•n en Azure-region till en lokal plats och d√§rifr√•n till den andra Azure-regionen. Azure ger dig m√∂jlighet att konfigurera en anslutning fr√•n en Azure-Virtual Network i en region till en annan Azure-Virtual Network som finns i en annan region. Den h√§r funktionen kallas VNet-till-VNet-anslutning. Du hittar mer information om den h√§r funktionen h√§r: <https://azure.microsoft.com/documentation/articles/vpn-gateway-vnet-vnet-rm-ps/>.

#### <a name="private-connection-to-azure-expressroute"></a>Privat anslutning till Azure-ExpressRoute

Med Microsoft Azure ExpressRoute kan du skapa privata anslutningar mellan Azures Data Center och antingen kundens lokala infrastruktur eller i en milj√∂ med en gemensam plats. ExpressRoute erbjuds av olika MPLS-VPN-providers (Packet Switched) eller andra n√§tverks tj√§nst leverant√∂rer. ExpressRoute-anslutningar g√•r inte via offentligt Internet. ExpressRoute-anslutningar ger h√∂gre s√§kerhet, mer tillf√∂rlitlighet genom flera parallella kretsar, snabbare hastigheter och l√§gre f√∂rdr√∂jning √§n vanliga anslutningar via Internet.

Hitta mer information om Azure ExpressRoute och erbjudanden h√§r:

* <https://azure.microsoft.com/documentation/services/expressroute/>
* <https://azure.microsoft.com/pricing/details/expressroute/>
* <https://azure.microsoft.com/documentation/articles/expressroute-faqs/>

Express Route m√∂jligg√∂r flera Azure-prenumerationer via en ExpressRoute-krets som dokumenteras h√§r

* <https://azure.microsoft.com/documentation/articles/expressroute-howto-linkvnet-arm/>
* <https://azure.microsoft.com/documentation/articles/expressroute-howto-circuit-arm/>

#### <a name="forced-tunneling-in-case-of-cross-premises"></a>Tvingad tunnel trafik i h√§ndelse av olika platser
F√∂r virtuella datorer som ansluter till lokala dom√§ner via plats-till-plats-, punkt-till-plats-eller ExpressRoute, m√•ste du se till att Internet-proxyinst√§llningarna inte har distribuerats f√∂r alla anv√§ndare i de virtuella datorerna. Som standard skulle program som k√∂rs i de virtuella datorerna eller anv√§ndare som anv√§nder en webbl√§sare f√∂r att komma √•t Internet inte g√• via f√∂retagets proxy, men skulle ansluta direkt via Azure till Internet. Men √§ven om proxyinst√§llningarna inte √§r en 100%-l√∂sning f√∂r att dirigera trafiken via f√∂retagets proxy, eftersom det √§r ansvars omr√•de och tj√§nster f√∂r att kontrol lera proxyn. Om program som k√∂rs p√• den virtuella datorn inte g√∂r det eller om en administrat√∂r √§ndrar inst√§llningarna kan trafik till Internet tas ur drift direkt via Azure till Internet.

F√∂r att undvika s√•dan direkt Internet anslutning kan du konfigurera Tvingad tunnel trafik med plats-till-plats-anslutning mellan lokalt och Azure. En detaljerad beskrivning av funktionen f√∂r Tvingad tunnel trafik publiceras h√§r <https://azure.microsoft.com/documentation/articles/vpn-gateway-forced-tunneling-rm/>

Tvingad tunnel trafik med ExpressRoute har Aktiver ATS av kunder som skickar en standard v√§g via ExpressRoute BGP-peering-sessioner.

#### <a name="summary-of-azure-networking"></a>√ñversikt √∂ver Azure-n√§tverk

Det h√§r kapitlet inneh√•ller m√•nga viktiga punkter om Azure-n√§tverk. H√§r √§r en sammanfattning av de viktigaste punkterna:

* Med virtuella Azure-n√§tverk kan du lagra en n√§tverks struktur i Azure-distributionen. Virtuella n√§tverk kan vara isolerade mot varandra eller med hj√§lp av n√§tverks s√§kerhets grupps trafik mellan virtuella n√§tverk kan styras.
* Virtuella Azure-n√§tverk kan utnyttjas f√∂r att tilldela IP-adressintervall till virtuella datorer eller tilldela fasta IP-adresser till virtuella datorer
* Om du vill konfigurera en plats-till-plats-eller punkt-till-plats-anslutning m√•ste du f√∂rst skapa en Azure-Virtual Network
* N√§r en virtuell dator har distribuerats g√•r det inte l√§ngre att √§ndra Virtual Network som tilldelats den virtuella datorn

### <a name="quotas-in-azure-virtual-machine-services"></a>Kvoter i Azure Virtual Machine-tj√§nster
Vi m√•ste vara tydliga om det faktum att lagrings-och n√§tverks infrastrukturen delas mellan virtuella datorer som k√∂r en m√§ngd olika tj√§nster i Azure-infrastrukturen. Och precis som i kundens egna data Center, sker √∂veretablering av n√•gra av infrastruktur resurserna i en viss grad. Microsoft Azures plattformen anv√§nder disk, processor, n√§tverk och andra kvoter f√∂r att begr√§nsa resursanv√§ndningen och bevara konsekvent och deterministisk prestanda.  De olika typerna av virtuella datorer (A5, A6 osv.) har olika kvoter f√∂r antalet diskar, CPU: n, RAM-minne och n√§tverk.

> [!NOTE]
> PROCESSOR-och minnes resurser f√∂r de VM-typer som st√∂ds av SAP √§r f√∂rallokerade p√• noderna. Det inneb√§r att n√§r den virtuella datorn har distribuerats √§r resurserna p√• v√§rden tillg√§ngliga som de definieras av VM-typen.
>
>

N√§r du planerar och √§ndrar storlek p√• SAP p√• Azure-l√∂sningar m√•ste kvoterna f√∂r varje virtuell dator storlek beaktas. De virtuella dator kvoterna beskrivs [h√§r (Linux)][virtual-machines-sizes-linux] och [h√§r (Windows)][virtual-machines-sizes-windows].

De kvoter som beskrivs representerar de teoretiska maximala v√§rdena.  Gr√§nsen f√∂r IOPS per disk kan uppn√•s med Small IOs (8 KB), men kanske inte kan uppn√•s med stor IOs (1 MB).  IOPS-gr√§nsen till√§mpas p√• en enskild disk granularitet.

Som ett grovt besluts tr√§d f√∂r att avg√∂ra om ett SAP-system passar in i Azures tj√§nster f√∂r virtuella datorer och dess funktioner eller om ett befintligt system m√•ste konfigureras p√• ett annat s√§tt f√∂r att kunna distribuera systemet p√• Azure, kan besluts tr√§det nedan anv√§ndas:

![Besluts tr√§d f√∂r att best√§mma m√∂jlighet att distribuera SAP p√• Azure][planning-guide-figure-700]

**Steg 1**: den viktigaste informationen att b√∂rja med √§r SAPS-kravet f√∂r ett angivet SAP-system. SAPS-kraven m√•ste delas upp i DBMS-delen och SAP-programdelen, √§ven om SAP-systemet redan har distribuerats lokalt i en konfiguration p√• tv√• niv√•er. F√∂r befintliga system kan SAPS som √§r relaterade till maskin varan som anv√§nds ofta best√§mmas eller ber√§knas utifr√•n befintliga SAP-benchmarks. Du hittar resultaten h√§r: <https://sap.com/about/benchmark.html>.
F√∂r nyligen distribuerade SAP-system b√∂r du ha genomg√•tt en storleks bed√∂mning, vilket b√∂r fastst√§lla systemets krav p√• SAPS.
Se √§ven den h√§r bloggen och det bifogade dokumentet f√∂r SAP-storlek p√• Azure: <https://blogs.msdn.com/b/saponsqlserver/archive/2015/12/01/new-white-paper-on-sizing-sap-solutions-on-azure-public-cloud.aspx>

**Steg 2**: f√∂r befintliga system ska i/o-volymer och i/o-√•tg√§rder per sekund p√• DBMS-servern m√§tas. F√∂r nyligen planerade system b√∂r storleks √∂vningen f√∂r det nya systemet ocks√• ge grova id√©er om I/O-kraven p√• DBMS-sidan. Om du √§r os√§ker m√•ste du utf√∂ra ett koncept bevis.

**Steg 3**: j√§mf√∂r SAPS-kravet f√∂r DBMS-servern med SAPS de olika VM-typerna f√∂r Azure kan tillhandah√•lla. Informationen om SAPS av olika typer av virtuella Azure-datorer finns dokumenterad i SAP NOTE [1928533]. Fokus b√∂r vara p√• den virtuella DBMS-datorn f√∂rst eftersom databas skiktet √§r skiktet i ett SAP NetWeaver-system som inte skalas ut i de flesta distributioner. SAP-programlagret kan d√§remot skalas ut. Om inget av de SAP-typer som st√∂ds av Azure VM-typer kan leverera n√∂dv√§ndiga SAPS, kan arbets belastningen f√∂r det planerade SAP-systemet inte k√∂ras p√• Azure. Du m√•ste antingen distribuera systemet lokalt eller s√• m√•ste du √§ndra arbets belastnings volymen f√∂r systemet.

**Steg 4**: som dokumenteras [h√§r (Linux)][virtual-machines-sizes-linux] och [h√§r (Windows)][virtual-machines-sizes-windows]till√§mpar Azure en IOPS-kvot per disk oberoende om du anv√§nder standard lagring eller Premium Storage. Beroende p√• typ av virtuell dator, antalet data diskar som kan monteras varierar. Det inneb√§r att du kan ber√§kna ett h√∂gsta IOPS-nummer som kan uppn√•s med var och en av de olika typerna av virtuella datorer. Beroende av databasens fillayout kan du g√∂ra stripe-diskar f√∂r att bli en volym i g√§st operativ systemet. Men om den aktuella IOPS-volymen i ett distribuerat SAP-system √∂verskrider de ber√§knade gr√§nserna f√∂r den st√∂rsta VM-typen i Azure och om det inte finns n√•gon risk att kompensera med mer minne, kan arbets belastningen f√∂r SAP-systemet p√•verkas allvarligt. I s√•dana fall kan du trycka p√• en punkt d√§r du inte b√∂r distribuera systemet p√• Azure.

**Steg 5**: s√§rskilt i SAP-system, som distribueras lokalt i konfigurationer p√• tv√• niv√•er, √§r sannolikheten att systemet kan beh√∂va konfigureras p√• Azure i en konfiguration p√• tre niv√•er. I det h√§r steget m√•ste du kontrol lera om det finns en komponent i SAP-programlagret, som inte kan skalas ut och som inte passar in i processor-och minnes resurser som de olika Azure VM-typerna erbjuder. Om det verkligen finns en s√•dan komponent kan inte SAP-systemet och dess arbets belastning distribueras till Azure. Men om du kan skala ut SAP-programkomponenter till flera virtuella Azure-datorer kan systemet distribueras till Azure.

**Steg 6**: om DBMS-och SAP-programmets skikt komponenter kan k√∂ras i virtuella Azure-datorer m√•ste konfigurationen definieras med avseende p√•:

* Antal virtuella Azure-datorer
* VM-typer f√∂r enskilda komponenter
* Antal virtuella h√•rd diskar i DBMS VM f√∂r att tillhandah√•lla tillr√§ckligt med IOPS

## <a name="managing-azure-assets"></a>Hantera Azure-tillg√•ngar

### <a name="azure-portal"></a>Azure-portalen

Azure Portal √§r ett av tre gr√§nssnitt f√∂r att hantera distributioner av virtuella Azure-datorer. De grundl√§ggande hanterings aktiviteterna, t. ex. distribution av virtuella datorer fr√•n avbildningar, kan g√∂ras via Azure Portal. Dessutom √§r skapandet av lagrings konton, virtuella n√§tverk och andra Azure-komponenter ocks√• aktiviteter som Azure Portal kan hantera bra. Funktioner som att ladda upp virtuella h√•rd diskar fr√•n lokala datorer till Azure eller kopiera en virtuell h√•rd disk i Azure √§r dock aktiviteter, vilket kr√§ver verktyg fr√•n tredje part eller administration via PowerShell eller CLI.

![√ñversikt √∂ver Microsoft Azure-portalen virtuell dator][planning-guide-figure-800]


Administrations-och konfigurations uppgifter f√∂r den virtuella dator instansen √§r m√∂jliga i Azure Portal.

F√∂rutom att starta om och st√§nga av en virtuell dator kan du ocks√• koppla, koppla fr√•n och skapa data diskar f√∂r den virtuella dator instansen, f√∂r att avbilda instansen f√∂r avbildnings f√∂rberedelse och konfigurera storleken p√• den virtuella dator instansen.

Azure Portal inneh√•ller grundl√§ggande funktioner f√∂r att distribuera och konfigurera virtuella datorer och m√•nga andra Azure-tj√§nster. Alla tillg√§ngliga funktioner omfattas dock inte av Azure Portal. I Azure Portal g√•r det inte att utf√∂ra uppgifter som:

* Laddar upp VHD: er till Azure
* Kopiera virtuella datorer


### <a name="management-via-microsoft-azure-powershell-cmdlets"></a>Hantering via Microsoft Azure PowerShell-cmdletar

Windows PowerShell √§r ett kraftfullt och ut√∂knings Bart ramverk som har varit mycket omfattande av kunder som distribuerar ett st√∂rre antal system i Azure. Efter installationen av PowerShell-cmdletar p√• en station√§r dator, b√§rbar dator eller dedikerad hanterings Station kan PowerShell-cmdlet: ar k√∂ras via fj√§rr anslutning.

Processen f√∂r att aktivera en lokal station√§r dator/b√§rbar dator f√∂r anv√§ndning av Azure PowerShell-cmdletar och hur du konfigurerar dem f√∂r anv√§ndning med Azure-prenumerationerna beskrivs i [den h√§r artikeln][powershell-install-configure].

Mer detaljerade anvisningar om hur du installerar, uppdaterar och konfigurerar Azure PowerShell-cmdletar finns i [det h√§r kapitlet i distributions guiden][deployment-guide-4.1].

Kund upplevelsen har hittills varit att PowerShell (PS) √§r det mest kraftfulla verktyget f√∂r att distribuera virtuella datorer och att skapa anpassade steg i distributionen av virtuella datorer. Alla kunder som k√∂r SAP-instanser i Azure anv√§nder PS-cmdlet: ar f√∂r att komplettera de hanterings uppgifter som de g√∂r i Azure Portal eller √§ven anv√§nder PS-cmdlet: ar enbart f√∂r att hantera sina distributioner i Azure. Eftersom de Azure-/regionsspecifika cmdletarna delar samma namngivnings konvention som √∂ver 2000 Windows-relaterade cmdlets, √§r det en enkel uppgift f√∂r Windows-administrat√∂rer att utnyttja dessa cmdlets.

Se exemplet h√§r: <https://blogs.technet.com/b/keithmayer/archive/2015/07/07/18-steps-for-end-to-end-iaas-provisioning-in-the-cloud-with-azure-resource-manager-arm-powershell-and-desired-state-configuration-dsc.aspx>


Distribution av Azure-till√§gget f√∂r SAP (se kapitel [Azure-till√§gg f√∂r SAP][planning-guide-9.1] i det h√§r dokumentet) √§r bara m√∂jlig via POWERSHELL eller cli. D√§rf√∂r √§r det n√∂dv√§ndigt att konfigurera och konfigurera PowerShell eller CLI n√§r du distribuerar eller administrerar ett SAP NetWeaver-system i Azure.  

Eftersom Azure tillhandah√•ller fler funktioner kommer nya PS-cmdlets att l√§ggas till som kr√§ver en uppdatering av cmdletarna. D√§rf√∂r √§r det klokt att kontrol lera Azures h√§mtnings plats minst en g√•ng i m√•naden <https://azure.microsoft.com/downloads/> f√∂r en ny version av cmdletarna. Den nya versionen installeras ovanp√• den √§ldre versionen.

En allm√§n lista √∂ver Azure-relaterade PowerShell-kommandon finns h√§r: <https://docs.microsoft.com/powershell/azure/overview>.

### <a name="management-via-microsoft-azure-cli-commands"></a>Hantering via Microsoft Azure CLI-kommandon

F√∂r kunder som anv√§nder Linux och vill hantera Azure-resurser kan det h√§nda att PowerShell inte √§r ett alternativ. Microsoft erbjuder Azure CLI som ett alternativ.
Azure CLI inneh√•ller en upps√§ttning kommandon med √∂ppen k√§llkod, plattforms oberoende funktioner f√∂r att arbeta med Azure-plattformen. Azure CLI inneh√•ller m√•nga av de funktioner som finns i Azure Portal.

Information om installation, konfiguration och hur du anv√§nder CLI-kommandon f√∂r att utf√∂ra Azure-aktiviteter finns i

* [Installera den klassiska Azure CLI][xplat-cli]
* [Distribuera och hantera virtuella datorer med hj√§lp av Azure Resource Manager-mallar och Azure CLI] [../../linux/create-ssh-secured-vm-from-template.md]
* [Anv√§nd den klassiska Azure-CLI: en f√∂r Mac, Linux och Windows med Azure Resource Manager][xplat-cli-azure-resource-manager]

L√§s √§ven kapitel [Azure CLI f√∂r virtuella Linux-datorer][deployment-guide-4.5.2] i [distributions guiden][planning-guide] f√∂r hur du anv√§nder Azure CLI f√∂r att distribuera Azure-till√§gget f√∂r SAP.

## <a name="different-ways-to-deploy-vms-for-sap-in-azure"></a>Olika s√§tt att distribuera virtuella datorer f√∂r SAP i Azure

I det h√§r kapitlet f√•r du l√§ra dig olika s√§tt att distribuera en virtuell dator i Azure. Ytterligare f√∂rberedelse procedurer, samt hantering av virtuella h√•rd diskar och virtuella datorer i Azure, beskrivs i det h√§r kapitlet.

### <a name="deployment-of-vms-for-sap"></a>Distribution av virtuella datorer f√∂r SAP

Microsoft Azure erbjuder flera olika s√§tt att distribuera virtuella datorer och tillh√∂r ande diskar. Det √§r d√§rf√∂r viktigt att f√∂rst√• skillnaderna eftersom virtuella datorers f√∂rberedelser kan variera beroende p√• distributions metoden. I allm√§nhet tar vi en titt p√• f√∂ljande scenarier:

#### <a name="4d175f1b-7353-4137-9d2f-817683c26e53"></a>Flytta en virtuell dator fr√•n lokal plats till Azure med en icke-generaliserad disk

Du planerar att flytta ett angivet SAP-system fr√•n en lokal plats till Azure. Detta kan g√∂ras genom att ladda upp den virtuella h√•rd disken som inneh√•ller operativ systemet, SAP-bin√§rfiler och DBMS-bin√§rfiler plus de virtuella h√•rd diskarna med data-och loggfilerna f√∂r DBMS till Azure. Till skillnad fr√•n [scenario #2 nedan][planning-guide-5.1.2]beh√•ller du anv√§ndar kontona f√∂r v√§rd namnet, SAP sid och SAP p√• den virtuella Azure-datorn som de konfigurerades i den lokala milj√∂n. D√§rf√∂r √§r det inte n√∂dv√§ndigt att generalisera avbildningen. Se kapitel [f√∂rberedelser f√∂r att flytta en virtuell dator fr√•n en lokal plats till Azure med en icke-generaliserad disk][planning-guide-5.2.1] i det h√§r dokumentet f√∂r de lokala f√∂rberedelse stegen och √∂verf√∂ra icke-generaliserade virtuella datorer eller virtuella h√•rd diskar till Azure. L√§s kapitel [Scenario 3: flytta en virtuell dator fr√•n en lokal plats med en icke-generaliserad virtuell Azure-dator med SAP][deployment-guide-3.4] i [distributions guiden][deployment-guide] f√∂r detaljerade anvisningar om hur du distribuerar en s√•dan avbildning i Azure.

#### <a name="e18f7839-c0e2-4385-b1e6-4538453a285c"></a>Distribuera en virtuell dator med en kundspecifik avbildning

P√• grund av s√§rskilda krav p√• uppdatering av operativ system-eller DBMS-versionen kanske de angivna avbildningarna p√• Azure Marketplace inte passar dina behov. D√§rf√∂r kan du beh√∂va skapa en virtuell dator med en egen privat OS/DBMS VM-avbildning, som kan distribueras flera g√•nger efter√•t. F√∂r att f√∂rbereda en s√•dan privat avbildning f√∂r duplicering m√•ste f√∂ljande objekt beaktas:

---
> ![Windows][Logo_Windows] Windows
>
> Se mer information h√§r: <https://docs.microsoft.com/azure/virtual-machines/windows/upload-generalized-managed> Windows-inst√§llningarna (t. ex. Windows SID och v√§rdnamn) m√•ste vara abstrakta/generaliserade p√• den lokala virtuella datorn via Sysprep-kommandot.
>
>
> ![Linux][Logo_Linux] Linux
>
> F√∂lj stegen som beskrivs i de h√§r artiklarna f√∂r [SUSE][virtual-machines-linux-create-upload-vhd-suse], [Red Hat][virtual-machines-linux-redhat-create-upload-vhd]eller [Oracle Linux][virtual-machines-linux-create-upload-vhd-oracle]f√∂r att f√∂rbereda en virtuell h√•rd disk som ska √∂verf√∂ras till Azure.
>
>

---
Om du redan har installerat SAP-inneh√•ll i din lokala virtuella dator (s√§rskilt f√∂r 2-niv√• system) kan du anpassa inst√§llningarna f√∂r SAP-systemet efter distributionen av den virtuella Azure-datorn via den instans namn procedur som st√∂ds av SAP Software Provisioning Manager (SAP NOTE [1619720]). Se kapitel [f√∂rberedelser f√∂r att distribuera en virtuell dator med en kundspecifik avbildning f√∂r SAP][planning-guide-5.2.2] och [Ladda upp en virtuell h√•rd disk fr√•n lokalt till Azure][planning-guide-5.3.2] i det h√§r dokumentet f√∂r lokala f√∂rberedelse steg och uppladdning av en generaliserad virtuell dator till Azure. L√§s kapitel [Scenario 2: Distribuera en virtuell dator med en anpassad avbildning f√∂r SAP][deployment-guide-3.3] i [distributions guiden][deployment-guide] f√∂r detaljerade anvisningar om hur du distribuerar en s√•dan avbildning i Azure.

#### <a name="deploying-a-vm-out-of-the-azure-marketplace"></a>Distribuera en virtuell dator fr√•n Azure Marketplace

Du vill anv√§nda en virtuell dator avbildning fr√•n Microsoft eller tredje part fr√•n Azure Marketplace f√∂r att distribuera den virtuella datorn. N√§r du har distribuerat den virtuella datorn i Azure f√∂ljer du samma rikt linjer och verktyg f√∂r att installera SAP-programvaran och/eller DBMS i den virtuella datorn som du skulle g√∂ra i en lokal milj√∂. Mer detaljerad distributions beskrivning finns i kapitel [Scenario 1: Distribuera en virtuell dator fr√•n Azure Marketplace f√∂r SAP][deployment-guide-3.2] i [distributions guiden][deployment-guide].

### <a name="6ffb9f41-a292-40bf-9e70-8204448559e7"></a>F√∂rbereda virtuella datorer med SAP f√∂r Azure

Innan du √∂verf√∂r virtuella datorer till Azure m√•ste du se till att de virtuella datorerna och de virtuella h√•rd diskarna uppfyller vissa krav. Det finns sm√• skillnader beroende p√• vilken distributions metod som anv√§nds.

#### <a name="1b287330-944b-495d-9ea7-94b83aff73ef"></a>F√∂rberedelser f√∂r att flytta en virtuell dator fr√•n en lokal plats till Azure med en icke-generaliserad disk

En vanlig distributions metod √§r att flytta en befintlig virtuell dator, som k√∂r ett SAP-system fr√•n lokal plats till Azure. Den virtuella datorn och SAP-systemet p√• den virtuella datorn b√∂r bara k√∂ras i Azure med samma v√§rdnamn och f√∂rmodligen samma SAP-SID. I det h√§r fallet b√∂r g√§st operativ systemet f√∂r den virtuella datorn inte generaliseras f√∂r flera distributioner. Om det lokala n√§tverket har ut√∂kats till Azure kan √§ven samma dom√§n konton anv√§ndas i den virtuella datorn som de anv√§ndes innan lokalt.

Krav n√§r du f√∂rbereder din egen Azure VM-disk:

* Den virtuella h√•rd disken som inneh√•ller operativ systemet kan endast ha en maximal storlek p√• 127GB. Den h√§r begr√§nsningen togs bort i slutet av mars 2015. Nu kan den virtuella h√•rd disken som inneh√•ller operativ systemet vara upp till 1 TB i storlek som andra Azure Storage v√§rdbaserade virtuella h√•rd diskar ocks√•.
* Den m√•ste vara i det fasta VHD-formatet. Dynamiska virtuella h√•rd diskar eller virtuella h√•rd diskar i VHDx-format st√∂ds √§nnu inte i Azure. Dynamiska virtuella h√•rd diskar konverteras till statiska virtuella h√•rd diskar n√§r du laddar upp den virtuella h√•rd disken med PowerShell-cmdletarna eller CLI
* Virtuella h√•rd diskar, som monteras p√• den virtuella datorn och ska monteras igen i Azure till den virtuella datorn m√•ste ocks√• ha ett fast VHD-format. L√§s [den h√§r artikeln (Linux)](../../linux/managed-disks-overview.md) och [den h√§r artikeln (Windows)](../../windows/managed-disks-overview.md)) f√∂r storleks gr√§nser f√∂r data diskar. Dynamiska virtuella h√•rd diskar konverteras till statiska virtuella h√•rd diskar n√§r du laddar upp den virtuella h√•rd disken med PowerShell-cmdletarna eller CLI
* L√§gg till ett annat lokalt konto med administrat√∂rs beh√∂righet, som kan anv√§ndas av Microsoft support eller som kan tilldelas som kontext f√∂r tj√§nster och program som ska k√∂ras i tills den virtuella datorn har distribuerats och mer l√§mpliga anv√§ndare kan anv√§ndas.
* L√§gg till andra lokala konton som de kan beh√∂va f√∂r det angivna distributions scenariot.

---
> ![Windows][Logo_Windows] Windows
>
> I det h√§r scenariot kr√§vs ingen generalisering (Sysprep) av den virtuella datorn f√∂r att ladda upp och distribuera den virtuella datorn i Azure.
> Kontrol lera att enheten D:\ anv√§nds inte.
> Ange automonterad disk f√∂r anslutna diskar enligt beskrivningen i kapitel [Ange automontera f√∂r anslutna diskar][planning-guide-5.5.3] i det h√§r dokumentet.
>
> ![Linux][Logo_Linux] Linux
>
> I det h√§r scenariot kr√§vs ingen generalisering (waagent) av den virtuella datorn f√∂r att ladda upp och distribuera den virtuella datorn i Azure.
> Se till att/mnt/Resource inte anv√§nds och att alla diskar √§r monterade via uuid. F√∂r OS-disken kontrollerar du att Start programmet ocks√• √•terspeglar den UUID-baserade monteringen.
>
>

---
#### <a name="57f32b1c-0cba-4e57-ab6e-c39fe22b6ec3"></a>F√∂rberedelser inf√∂r distribution av en virtuell dator med en kundspecifik avbildning f√∂r SAP

VHD-filer som inneh√•ller ett generaliserat operativ system lagras i beh√•llare p√• Azure Storage konton eller som hanterade disk avbildningar. Du kan distribuera en ny virtuell dator fr√•n en s√•dan avbildning genom att referera till den virtuella h√•rd disken eller den hanterade disk avbildningen som en k√§lla i mallen f√∂r distributions mal len enligt beskrivningen i kapitel [Scenario 2: Distribuera en virtuell dator med en anpassad avbildning f√∂r SAP][deployment-guide-3.3] i [distributions guiden][deployment-guide].

Krav n√§r du f√∂rbereder din egen Azure VM-avbildning:

* Den virtuella h√•rd disken som inneh√•ller operativ systemet kan endast ha en maximal storlek p√• 127GB. Den h√§r begr√§nsningen togs bort i slutet av mars 2015. Nu kan den virtuella h√•rd disken som inneh√•ller operativ systemet vara upp till 1 TB i storlek som andra Azure Storage v√§rdbaserade virtuella h√•rd diskar ocks√•.
* Den m√•ste vara i det fasta VHD-formatet. Dynamiska virtuella h√•rd diskar eller virtuella h√•rd diskar i VHDx-format st√∂ds √§nnu inte i Azure. Dynamiska virtuella h√•rd diskar konverteras till statiska virtuella h√•rd diskar n√§r du laddar upp den virtuella h√•rd disken med PowerShell-cmdletarna eller CLI
* Virtuella h√•rd diskar, som monteras p√• den virtuella datorn och ska monteras igen i Azure till den virtuella datorn m√•ste ocks√• ha ett fast VHD-format. L√§s [den h√§r artikeln (Linux)](../../windows/managed-disks-overview.md) och [den h√§r artikeln (Windows)](../../linux/managed-disks-overview.md) f√∂r storleks gr√§nser f√∂r data diskar. Dynamiska virtuella h√•rd diskar konverteras till statiska virtuella h√•rd diskar n√§r du laddar upp den virtuella h√•rd disken med PowerShell-cmdletarna eller CLI
* L√§gg till andra lokala konton som de kan beh√∂va f√∂r det angivna distributions scenariot.
* Om avbildningen inneh√•ller en installation av SAP-NetWeaver och omnamnering av v√§rd namnet fr√•n det ursprungliga namnet vid Azure-distributionen √§r troligt, rekommenderar vi att du kopierar de senaste versionerna av SAP Software Provisioning Manager-DVD: n till mallen. P√• s√• s√§tt kan du enkelt anv√§nda de funktioner f√∂r SAP som har angetts f√∂r att anpassa det √§ndrade v√§rd namnet och/eller √§ndra SID f√∂r SAP-systemet i den distribuerade virtuella dator avbildningen s√• fort en ny kopia startas.

---
> ![Windows][Logo_Windows] Windows
>
> Kontrol lera att enheten D:\ anv√§nds inte ange automonterad disk f√∂r anslutna diskar enligt beskrivningen i kapitel [Ange automontera f√∂r anslutna diskar][planning-guide-5.5.3] i det h√§r dokumentet.
>
> ![Linux][Logo_Linux] Linux
>
> Se till att/mnt/Resource inte anv√§nds och att alla diskar √§r monterade via uuid. F√∂r OS-disken kontrollerar du att Start programmet ocks√• √•terspeglar den UUID-baserade monteringen.
>
>

---
* SAP GUI (f√∂r administration och konfigurations syfte) kan vara f√∂rinstallerat i en s√•dan mall.
* Annan program vara som kr√§vs f√∂r att k√∂ra de virtuella datorerna i scenarier med flera platser kan installeras s√• l√§nge den h√§r program varan kan arbeta med den virtuella datorns namnbyte.

Om den virtuella datorn √§r f√∂r beredd f√∂r att vara generisk och slutligen oberoende av konton/anv√§ndare som inte √§r tillg√§ngliga i det riktade scenariot f√∂r Azure-distribution, utf√∂rs det senaste f√∂rberedelse steget f√∂r att generalisera s√•dan avbildning.

##### <a name="generalizing-a-vm"></a>Generalisera en virtuell dator
---
> ![Windows][Logo_Windows] Windows
>
> Det sista steget √§r att logga in p√• en virtuell dator med ett administrat√∂rs konto. √ñppna ett Windows-kommando f√∂nster som *administrat√∂r*. G√• till%windir%\windows\system32\sysprep och k√∂r Sysprep. exe.
> Ett litet f√∂nster visas. Det √§r viktigt att kontrol lera **generalize** -alternativet (Standardv√§rdet √§r avmarkerat) och √§ndra avst√§ngnings alternativet fr√•n standardv√§rdet ' reboot ' till ' shutdown '. Den h√§r proceduren f√∂ruts√§tter att Sysprep-processen k√∂rs lokalt i g√§st operativ systemet p√• en virtuell dator.
> Om du vill utf√∂ra proceduren med en virtuell dator som redan k√∂rs i Azure f√∂ljer du stegen som beskrivs i [den h√§r artikeln](https://docs.microsoft.com/azure/virtual-machines/windows/capture-image-resource).
>
> ![Linux][Logo_Linux] Linux
>
> [S√• h√§r avbildar du en virtuell Linux-dator som ska anv√§ndas som mall f√∂r Resource Manager][capture-image-linux-step-2-create-vm-image]
>
>

---
### <a name="transferring-vms-and-vhds-between-on-premises-to-azure"></a>√ñverf√∂ra virtuella datorer och virtuella h√•rd diskar mellan lokala datorer och Azure
Eftersom det inte g√•r att ladda upp VM-avbildningar och diskar till Azure via Azure Portal m√•ste du anv√§nda Azure PowerShell-cmdletar eller CLI. En annan m√∂jlighet √§r att anv√§nda verktyget ' AzCopy '. Verktyget kan kopiera virtuella h√•rd diskar mellan lokalt och Azure (i b√•da riktningarna). Den kan ocks√• kopiera virtuella h√•rd diskar mellan Azure-regioner. L√§s [den h√§r dokumentationen][storage-use-azcopy] f√∂r h√§mtning och anv√§ndning av AzCopy.

Ett tredje alternativ √§r att anv√§nda olika verktyg som √§r orienterade fr√•n andra tillverkare. Se dock till att dessa verktyg st√∂der Azure Page blobbar. I v√•rt syfte m√•ste vi anv√§nda Azure Page BLOB Store (skillnaderna beskrivs h√§r: <https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>). De verktyg som tillhandah√•lls av Azure √§r ocks√• effektiva f√∂r att komprimera virtuella datorer och virtuella h√•rd diskar, som m√•ste √∂verf√∂ras. Detta √§r viktigt eftersom den h√§r effektiviteten i komprimeringen minskar uppladdnings tiden (som varierar beroende p√• uppladdnings l√§nken till Internet fr√•n den lokala anl√§ggningen och det riktade Azure-distributions omr√•det). Det √§r ett rimligt antagande att det tar l√§ngre tid att ladda upp en virtuell dator eller en virtuell h√•rd disk fr√•n den europeiska platsen till de amerikanska Azure-datacenterna √§n att ladda upp samma virtuella datorer/virtuella h√•rd diskar till de europeiska Azure-datacenterna.

#### <a name="a43e40e6-1acc-4633-9816-8f095d5a7b6a"></a>Ladda upp en virtuell h√•rd disk fr√•n lokal plats till Azure
F√∂r att √∂verf√∂ra en befintlig virtuell dator eller virtuell h√•rd disk fr√•n det lokala n√§tverket m√•ste en virtuell dator eller virtuell h√•rd disk uppfylla kraven som anges i kapitel [f√∂rberedelser f√∂r att flytta en virtuell dator fr√•n en lokal plats till Azure med en icke-generaliserad disk][planning-guide-5.2.1] i det h√§r dokumentet.

S√•dan virtuell dator beh√∂ver inte generaliseras och kan laddas upp i det tillst√•nd och den form den har efter avst√§ngning p√• den lokala sidan. Detsamma g√§ller f√∂r ytterligare virtuella h√•rd diskar, som inte inneh√•ller n√•got operativ system.

##### <a name="uploading-a-vhd-and-making-it-an-azure-disk"></a>Ladda upp en virtuell h√•rd disk och g√∂ra den till en Azure-disk
I det h√§r fallet vill vi ladda upp en virtuell h√•rd disk, antingen med eller utan ett operativ system, och montera den p√• en virtuell dator som en data disk eller anv√§nda den som en operativ system disk. Detta √§r en process med flera steg

**PowerShell**

* Logga in p√• din prenumeration med *Connect-AzAccount*
* Ange prenumerationen f√∂r din kontext med *set-AzContext* och parametern SubscriptionId eller SubscriptionName-se <https://docs.microsoft.com/powershell/module/az.accounts/set-Azcontext>
* Ladda upp den virtuella h√•rd disken med *Add-AzVhd* till ett Azure Storage konto ‚Äì se <https://docs.microsoft.com/powershell/module/az.compute/add-Azvhd>
* Valfritt Skapa en hanterad disk fr√•n den virtuella h√•rd disken med *New-AzDisk* -se <https://docs.microsoft.com/powershell/module/az.compute/new-Azdisk>
* Ange operativ system disken f√∂r en ny VM-konfiguration till den virtuella h√•rd disken eller hanterad disk med *set-AzVMOSDisk* ‚Äì se <https://docs.microsoft.com/powershell/module/az.compute/set-Azvmosdisk>
* Skapa en ny virtuell dator fr√•n den virtuella dator konfigurationen med *New-AzVM* -se <https://docs.microsoft.com/powershell/module/az.compute/new-Azvm>
* L√§gg till en datadisk till en ny virtuell dator med *Add-AzVMDataDisk* -se <https://docs.microsoft.com/powershell/module/az.compute/add-Azvmdatadisk>

**Azure CLI**

* Logga in p√• din prenumeration med *AZ-inloggning*
* V√§lj din prenumeration med *AZ-konto upps√§ttning--prenumerations `<subscription name or id`>*
* Ladda upp den virtuella h√•rd disken med *AZ Storage BLOB upload* -se [anv√§nda Azure CLI med Azure Storage][storage-azure-cli]
* Valfritt Skapa en hanterad disk fr√•n den virtuella h√•rd disken med *AZ disk Create* -se https://docs.microsoft.com/cli/azure/disk
* Skapa en ny virtuell dator som anger den √∂verf√∂rda virtuella h√•rd disken eller hanterade diskar som OS-disk med *AZ VM Create* och parameter *--Attach-OS-disk*
* L√§gg till en datadisk till en ny virtuell dator med *AZ VM disk Attach* och parameter *-New*

**Mall**

* Ladda upp den virtuella h√•rd disken med PowerShell eller Azure CLI
* Valfritt Skapa en hanterad disk fr√•n den virtuella h√•rd disken med PowerShell, Azure CLI eller Azure Portal
* Distribuera den virtuella datorn med en JSON-mall som refererar till den virtuella h√•rd disken som visas i [den h√§r exempel-JSON-mallen](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vm-specialized-vhd-new-or-existing-vnet/azuredeploy.json) eller med Managed disks som visas i [den h√§r exempel-JSON-mallen](https://github.com/Azure/azure-quickstart-templates/blob/master/sap-2-tier-user-image-md/azuredeploy.json)

#### <a name="deployment-of-a-vm-image"></a>Distribution av en VM-avbildning
Om du vill √∂verf√∂ra en befintlig virtuell dator eller virtuell h√•rd disk fr√•n det lokala n√§tverket m√•ste du, f√∂r att kunna anv√§nda den som en virtuell Azure-dator avbildning, s√• att en virtuell dator eller virtuell h√•rd disk uppfyller kraven som anges i kapitel [f√∂rberedelser f√∂r att distribuera en virtuell dator med en kundspecifik avbildning f√∂r SAP][planning-guide-5.2.2] av det h√§r dokumentet.

* Anv√§nd *Sysprep* p√• Windows eller *waagent-deetablering* i Linux f√∂r att generalisera din virtuella dator ‚Äì se [Sysprep teknisk referens](https://technet.microsoft.com/library/cc766049.aspx) f√∂r Windows eller [s√• h√§r avbildar du en virtuell Linux-dator som ska anv√§ndas som en Resource Manager-mall][capture-image-linux-step-2-create-vm-image] f√∂r Linux
* Logga in p√• din prenumeration med *Connect-AzAccount*
* Ange prenumerationen f√∂r din kontext med *set-AzContext* och parametern SubscriptionId eller SubscriptionName-se <https://docs.microsoft.com/powershell/module/az.accounts/set-Azcontext>
* Ladda upp den virtuella h√•rd disken med *Add-AzVhd* till ett Azure Storage konto ‚Äì se <https://docs.microsoft.com/powershell/module/az.compute/add-Azvhd>
* Valfritt Skapa en hanterad disk avbildning fr√•n den virtuella h√•rd disken med *New-AzImage* -se <https://docs.microsoft.com/powershell/module/az.compute/new-Azimage>
* Ange operativ system disken f√∂r en ny VM-konfiguration till
  * VHD med *set-AzVMOSDisk-SourceImageUri-CreateOption fromImage* -se <https://docs.microsoft.com/powershell/module/az.compute/set-Azvmosdisk>
  * Hanterad disk avbildnings *upps√§ttning ‚Äì AzVMSourceImage* ‚Äì se <https://docs.microsoft.com/powershell/module/az.compute/set-Azvmsourceimage>
* Skapa en ny virtuell dator fr√•n den virtuella dator konfigurationen med *New-AzVM* -se <https://docs.microsoft.com/powershell/module/az.compute/new-Azvm>

**Azure CLI**

* Anv√§nd *Sysprep* p√• Windows eller *waagent-deetablering* i Linux f√∂r att generalisera din virtuella dator ‚Äì se [Sysprep teknisk referens](https://technet.microsoft.com/library/cc766049.aspx) f√∂r Windows eller [s√• h√§r avbildar du en virtuell Linux-dator som ska anv√§ndas som en Resource Manager-mall][capture-image-linux-step-2-create-vm-image] f√∂r Linux
* Logga in p√• din prenumeration med *AZ-inloggning*
* V√§lj din prenumeration med *AZ-konto upps√§ttning--prenumerations `<subscription name or id`>*
* Ladda upp den virtuella h√•rd disken med *AZ Storage BLOB upload* -se [anv√§nda Azure CLI med Azure Storage][storage-azure-cli]
* Valfritt Skapa en hanterad disk avbildning fr√•n den virtuella h√•rd disken med *AZ avbildning Create* -se https://docs.microsoft.com/cli/azure/image
* Skapa en ny virtuell dator som anger den √∂verf√∂rda virtuella h√•rd disken eller hanterade disk avbildningen som en OS-disk med *AZ VM Create* och parameter *--image*

**Mall**

* Anv√§nd *Sysprep* p√• Windows eller *waagent-deetablering* i Linux f√∂r att generalisera din virtuella dator ‚Äì se [Sysprep teknisk referens](https://technet.microsoft.com/library/cc766049.aspx) f√∂r Windows eller [s√• h√§r avbildar du en virtuell Linux-dator som ska anv√§ndas som en Resource Manager-mall][capture-image-linux-step-2-create-vm-image] f√∂r Linux
* Ladda upp den virtuella h√•rd disken med PowerShell eller Azure CLI
* Valfritt Skapa en hanterad disk avbildning fr√•n den virtuella h√•rd disken med PowerShell, Azure CLI eller Azure Portal
* Distribuera den virtuella datorn med en JSON-mall som refererar till avbildningens virtuella h√•rd disk som visas i [den h√§r exempel-JSON-mallen](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vm-specialized-vhd-new-or-existing-vnet/azuredeploy.json) eller med hj√§lp av den hanterade disk avbildningen som du ser i [det h√§r exemplet](https://github.com/Azure/azure-quickstart-templates/blob/master/sap-2-tier-user-image-md/azuredeploy.json)

#### <a name="downloading-vhds-or-managed-disks-to-on-premises"></a>Laddar ned VHD: er eller Managed Disks till lokalt
Azure-infrastruktur som en tj√§nst √§r inte en enkelriktad gata som bara kan ladda upp virtuella h√•rd diskar och SAP-system. Du kan ocks√• flytta SAP-system fr√•n Azure tillbaka till den lokala v√§rlden.

Under h√§mtningen kan de virtuella h√•rd diskarna eller Managed Disks inte vara aktiva. √Ñven n√§r du laddar ned diskar, som √§r monterade p√• virtuella datorer, m√•ste den virtuella datorn st√§ngas av och frig√∂ras. Om du bara vill h√§mta det databas inneh√•ll som ska anv√§ndas f√∂r att konfigurera ett nytt system lokalt och om det √§r acceptabelt under h√§mtningen och installationen av det nya systemet som systemet i Azure fortfarande kan fungera kan du undvika en l√•ng stillest√•nds tid genom att utf√∂ra en komprimerad s√§kerhets kopiering av databasen till en disk och bara ladda ned den disken i st√§llet f√∂r att √§ven h√§mta den virtuella datorn f√∂r OS-basen.

#### <a name="powershell"></a>PowerShell

* Laddar ned en hanterad disk  
  Du m√•ste f√∂rst f√• √•tkomst till den underliggande blobben f√∂r den hanterade disken. Sedan kan du kopiera den underliggande blobben till ett nytt lagrings konto och ladda ned blobben fr√•n det h√§r lagrings kontot.

  ```powershell
  $access = Grant-AzDiskAccess -ResourceGroupName <resource group> -DiskName <disk name> -Access Read -DurationInSecond 3600
  $key = (Get-AzStorageAccountKey -ResourceGroupName <resource group> -Name <storage account name>)[0].Value
  $destContext = (New-AzStorageContext -StorageAccountName <storage account name -StorageAccountKey $key)
  Start-AzStorageBlobCopy -AbsoluteUri $access.AccessSAS -DestContainer <container name> -DestBlob <blob name> -DestContext $destContext
  # Wait for blob copy to finish
  Get-AzStorageBlobCopyState -Container <container name> -Blob <blob name> -Context $destContext
  Save-AzVhd -SourceUri <blob in new storage account> -LocalFilePath <local file path> -StorageKey $key
  # Wait for download to finish
  Revoke-AzDiskAccess -ResourceGroupName <resource group> -DiskName <disk name>
  ```

* H√§mta en virtuell h√•rd disk  
  N√§r SAP-systemet har stoppats och den virtuella datorn st√§ngs av kan du anv√§nda PowerShell-cmdleten Save-AzVhd p√• det lokala m√•let f√∂r att ladda ned VHD-diskarna tillbaka till den lokala v√§rlden. F√∂r att g√∂ra det beh√∂ver du webb adressen till den virtuella h√•rd disken, som du hittar i "lagrings avsnittet" i Azure Portal (du m√•ste navigera till lagrings kontot och lagrings beh√•llaren d√§r den virtuella h√•rd disken skapades) och du m√•ste veta var den virtuella h√•rd disken ska kopieras.

  Sedan kan du anv√§nda kommandot genom att definiera parametern SourceUri som URL f√∂r den virtuella h√•rd disk som ska laddas ned och LocalFilePath som den fysiska platsen f√∂r den virtuella h√•rd disken (inklusive dess namn). Kommandot kan se ut s√• h√§r:

  ```powerhell
  Save-AzVhd -ResourceGroupName <resource group name of storage account> -SourceUri http://<storage account name>.blob.core.windows.net/<container name>/sapidedata.vhd -LocalFilePath E:\Azure_downloads\sapidesdata.vhd
  ```

  Mer information om cmdleten Save-AzVhd finns h√§r <https://docs.microsoft.com/powershell/module/az.compute/save-Azvhd>.

#### <a name="azure-cli"></a>Azure CLI
* Laddar ned en hanterad disk  
  Du m√•ste f√∂rst f√• √•tkomst till den underliggande blobben f√∂r den hanterade disken. Sedan kan du kopiera den underliggande blobben till ett nytt lagrings konto och ladda ned blobben fr√•n det h√§r lagrings kontot.
  ```
  az disk grant-access --ids "/subscriptions/<subscription id>/resourceGroups/<resource group>/providers/Microsoft.Compute/disks/<disk name>" --duration-in-seconds 3600
  az storage blob download --sas-token "<sas token>" --account-name <account name> --container-name <container name> --name <blob name> --file <local file>
  az disk revoke-access --ids "/subscriptions/<subscription id>/resourceGroups/<resource group>/providers/Microsoft.Compute/disks/<disk name>"
  ```

* H√§mta en virtuell h√•rd disk   
  N√§r SAP-systemet har stoppats och den virtuella datorn st√§ngs av kan du anv√§nda Azure CLI-kommandot _Azure Storage BLOB-h√§mtning_ p√• det lokala m√•let f√∂r att ladda ned VHD-diskarna tillbaka till den lokala v√§rlden. F√∂r att g√∂ra det m√•ste du ha namnet och den virtuella h√•rd diskens beh√•llare, som du hittar i "lagrings avsnittet" i Azure Portal (m√•ste g√• till lagrings kontot och lagrings beh√•llaren d√§r den virtuella h√•rd disken skapades) och du m√•ste veta var den virtuella h√•rd disken ska vara COP IED till.

  Sedan kan du anv√§nda kommandot genom att definiera parameter-blob och beh√•llare f√∂r den virtuella h√•rd disken som ska laddas ned och m√•let som den fysiska m√•l platsen f√∂r den virtuella h√•rd disken (inklusive dess namn). Kommandot kan se ut s√• h√§r:

  ```
  az storage blob download --name <name of the VHD to download> --container-name <container of the VHD to download> --account-name <storage account name of the VHD to download> --account-key <storage account key> --file <destination of the VHD to download>
  ```

### <a name="transferring-vms-and-disks-within-azure"></a>√ñverf√∂ra virtuella datorer och diskar i Azure

#### <a name="copying-sap-systems-within-azure"></a>Kopiera SAP-system i Azure

Ett SAP-system eller en dedikerad DBMS-server som har st√∂d f√∂r ett SAP-program skikt kommer sannolikt att best√• av flera diskar, som inneh√•ller antingen operativ systemet med bin√§rfilerna eller data-och loggfilerna f√∂r SAP-databasen. Varken Azure-funktionen f√∂r att kopiera diskar eller Azure-funktionerna f√∂r att spara diskar p√• en lokal disk har en mekanism f√∂r synkronisering, som √∂gonblicks bilder av flera diskar p√• ett konsekvent s√§tt. D√§rf√∂r skulle statusen f√∂r de kopierade eller sparade diskarna √§ven om de √§r monterade mot samma virtuella dator vara annorlunda. Det inneb√§r att i det konkreta fallet att ha olika data och loggfiler som finns i de olika diskarna skulle databasen i slutet vara inkonsekvent.

**Slutsats: f√∂r att kopiera eller spara diskar som ing√•r i en SAP-systemkonfiguration m√•ste du stoppa SAP-systemet och √§ven beh√∂va st√§nga av den distribuerade virtuella datorn. Du kan bara kopiera eller ladda ned disk upps√§ttningen f√∂r att antingen skapa en kopia av SAP-systemet i Azure eller lokalt.**

Data diskar kan lagras som VHD-filer i ett Azure Storage konto och kan kopplas direkt till en virtuell dator eller anv√§ndas som en avbildning. I det h√§r fallet kopieras den virtuella h√•rd disken till en annan plats innan den kopplas till den virtuella datorn. Det fullst√§ndiga namnet p√• VHD-filen i Azure m√•ste vara unikt inom Azure. Som tidigare n√§mnts √§r namnet en typ av namn p√• tre delar som ser ut s√• h√§r:

    http(s)://<storage account name>.blob.core.windows.net/<container name>/<vhd name>

Det g√•r ocks√• att Managed Disks data diskar. I det h√§r fallet anv√§nds den hanterade disken f√∂r att skapa en ny hanterad disk innan den kopplas till den virtuella datorn. Namnet p√• den hanterade disken m√•ste vara unikt inom en resurs grupp.

##### <a name="powershell"></a>PowerShell

Du kan anv√§nda Azure PowerShell cmdlets f√∂r att kopiera en virtuell h√•rd disk som visas i [den h√§r artikeln][storage-powershell-guide-full-copy-vhd]. Om du vill skapa en ny hanterad disk anv√§nder du New-AzDiskConfig och New-AzDisk som visas i f√∂ljande exempel.

```powershell
$config = New-AzDiskConfig -CreateOption Copy -SourceUri "/subscriptions/<subscription id>/resourceGroups/<resource group>/providers/Microsoft.Compute/disks/<disk name>" -Location <location>
New-AzDisk -ResourceGroupName <resource group name> -DiskName <disk name> -Disk $config
```

##### <a name="azure-cli"></a>Azure CLI

Du kan anv√§nda Azure CLI f√∂r att kopiera en virtuell h√•rd disk som visas i [den h√§r artikeln][storage-azure-cli-copy-blobs]. Om du vill skapa en ny hanterad disk anv√§nder du *AZ disk Create* som visas i f√∂ljande exempel.

```
az disk create --source "/subscriptions/<subscription id>/resourceGroups/<resource group>/providers/Microsoft.Compute/disks/<disk name>" --name <disk name> --resource-group <resource group name> --location <location>
```

##### <a name="azure-storage-tools"></a>Azure Storage verktyg

* <https://storageexplorer.com/>

Professional-versioner av Azure Storage Explorer hittar du h√§r:

* <https://www.cerebrata.com/>
* <https://clumsyleaf.com/products/cloudxplorer>

Kopieringen av en virtuell h√•rd disk i ett lagrings konto √§r en process som bara tar n√•gra sekunder (liknande SAN-maskinvara som skapar √∂gonblicks bilder med Lazy Copy och kopiering vid skrivning). N√§r du har en kopia av VHD-filen kan du koppla den till en virtuell dator eller anv√§nda den som en avbildning f√∂r att koppla kopior av den virtuella h√•rd disken till virtuella datorer.

##### <a name="powershell"></a>PowerShell

```powershell
# attach a vhd to a vm
$vm = Get-AzVM -ResourceGroupName <resource group name> -Name <vm name>
$vm = Add-AzVMDataDisk -VM $vm -Name newdatadisk -VhdUri <path to vhd> -Caching <caching option> -DiskSizeInGB $null -Lun <lun, for example 0> -CreateOption attach
$vm | Update-AzVM

# attach a managed disk to a vm
$vm = Get-AzVM -ResourceGroupName <resource group name> -Name <vm name>
$vm = Add-AzVMDataDisk -VM $vm -Name newdatadisk -ManagedDiskId <managed disk id> -Caching <caching option> -DiskSizeInGB $null -Lun <lun, for example 0> -CreateOption attach
$vm | Update-AzVM

# attach a copy of the vhd to a vm
$vm = Get-AzVM -ResourceGroupName <resource group name> -Name <vm name>
$vm = Add-AzVMDataDisk -VM $vm -Name <disk name> -VhdUri <new path of vhd> -SourceImageUri <path to image vhd> -Caching <caching option> -DiskSizeInGB $null -Lun <lun, for example 0> -CreateOption fromImage
$vm | Update-AzVM

# attach a copy of the managed disk to a vm
$vm = Get-AzVM -ResourceGroupName <resource group name> -Name <vm name>
$diskConfig = New-AzDiskConfig -Location $vm.Location -CreateOption Copy -SourceUri <source managed disk id>
$disk = New-AzDisk -DiskName <disk name> -Disk $diskConfig -ResourceGroupName <resource group name>
$vm = Add-AzVMDataDisk -VM $vm -Caching <caching option> -Lun <lun, for example 0> -CreateOption attach -ManagedDiskId $disk.Id
$vm | Update-AzVM
```
##### <a name="azure-cli"></a>Azure CLI

```

# attach a vhd to a vm
az vm unmanaged-disk attach --resource-group <resource group name> --vm-name <vm name> --vhd-uri <path to vhd>

# attach a managed disk to a vm
az vm disk attach --resource-group <resource group name> --vm-name <vm name> --disk <managed disk id>

# attach a copy of the vhd to a vm
# this scenario is currently not possible with Azure CLI. A workaround is to manually copy the vhd to the destination.

# attach a copy of a managed disk to a vm
az disk create --name <new disk name> --resource-group <resource group name> --location <location of target virtual machine> --source <source managed disk id>
az vm disk attach --disk <new disk name or managed disk id> --resource-group <resource group name> --vm-name <vm name> --caching <caching option> --lun <lun, for example 0>
```

#### <a name="9789b076-2011-4afa-b2fe-b07a8aba58a1"></a>Kopiera diskar mellan Azure Storage-konton
Det g√•r inte att utf√∂ra den h√§r uppgiften p√• Azure Portal. Du kan anv√§nda Azure PowerShell-cmdletar, Azure CLI eller en lagrings webbl√§sare fr√•n tredje part. PowerShell-cmdletarna eller CLI-kommandona kan skapa och hantera blobbar, bland annat m√∂jligheten att asynkront kopiera blobbar mellan lagrings konton och mellan regioner i Azure-prenumerationen.

##### <a name="powershell"></a>PowerShell
Du kan ocks√• kopiera virtuella h√•rd diskar mellan prenumerationer. Mer information finns i [den h√§r artikeln][storage-powershell-guide-full-copy-vhd].

Basic-fl√∂det f√∂r PS-cmdlet-logiken ser ut s√• h√§r:

* Skapa en lagrings konto kontext f√∂r **k√§ll** lagrings kontot med *New-AzStorageContext* -se <https://docs.microsoft.com/powershell/module/az.storage/new-AzStoragecontext>
* Skapa en lagrings konto kontext f√∂r **m√•l** lagrings kontot med *New-AzStorageContext* -se <https://docs.microsoft.com/powershell/module/az.storage/new-AzStoragecontext>
* Starta kopian med

```powershell
Start-AzStorageBlobCopy -SrcBlob <source blob name> -SrcContainer <source container name> -SrcContext <variable containing context of source storage account> -DestBlob <target blob name> -DestContainer <target container name> -DestContext <variable containing context of target storage account>
```

* Kontrol lera status f√∂r kopian i en slinga med

```powershell
Get-AzStorageBlobCopyState -Blob <target blob name> -Container <target container name> -Context <variable containing context of target storage account>
```

* Koppla den nya virtuella h√•rd disken till en virtuell dator enligt beskrivningen ovan.

Exempel finns i [den h√§r artikeln][storage-powershell-guide-full-copy-vhd].

##### <a name="azure-cli"></a>Azure CLI
* Starta kopian med

```
az storage blob copy start --source-blob <source blob name> --source-container <source container name> --source-account-name <source storage account name> --source-account-key <source storage account key> --destination-container <target container name> --destination-blob <target blob name> --account-name <target storage account name> --account-key <target storage account name>
```

* Kontrol lera status om kopian fortfarande finns i en slinga med

```
az storage blob show --name <target blob name> --container <target container name> --account-name <target storage account name> --account-key <target storage account name>
```

* Koppla den nya virtuella h√•rd disken till en virtuell dator enligt beskrivningen ovan.

Exempel finns i [den h√§r artikeln][storage-azure-cli-copy-blobs].

### <a name="disk-handling"></a>Disk hantering

#### <a name="4efec401-91e0-40c0-8e64-f2dceadff646"></a>VM/disk struktur f√∂r SAP-distributioner

Vi rekommenderar att hanteringen av strukturen f√∂r en virtuell dator och de tillh√∂r ande diskarna √§r enkla. I lokala installationer har kunder utvecklat m√•nga olika s√§tt att strukturera en server installation.

* En bas disk som inneh√•ller operativ systemet och alla bin√§rfiler f√∂r DBMS och/eller SAP. Sedan mars 2015 kan disken vara upp till 1 TB i st√§llet f√∂r tidigare begr√§nsningar som √§r begr√§nsad till 127GB.
* En eller flera diskar som inneh√•ller DBMS-loggfilen f√∂r SAP-databasen och logg filen f√∂r det DBMS-baserade lagrings utrymmet (om DBMS st√∂der detta). Om kraven f√∂r databas logg IOPS √§r h√∂ga m√•ste du Stripa flera diskar f√∂r att uppn√• den IOPS-volym som kr√§vs.
* Ett antal diskar som inneh√•ller en eller tv√• databasfiler f√∂r SAP-databasen och data DBMS Temp-datafilerna ocks√• (om DBMS st√∂der detta).

![Referens konfiguration f√∂r Azure IaaS VM f√∂r SAP][planning-guide-figure-1300]


---
> ![Windows][Logo_Windows] Windows
>
> Med m√•nga kunder s√•g vi konfigurationer d√§r till exempel SAP-och DBMS-bin√§rfiler inte har installerats p√• c:\ enhet d√§r operativ systemet installerades. Det fanns olika orsaker till detta, men n√§r vi gick tillbaka till roten var det vanligt vis att enheterna var sm√• och operativ system uppgraderingar beh√∂vde ytterligare utrymme 10-15 √•r sedan. B√•da villkoren g√§ller inte f√∂r ofta l√§ngre. I dag √§r c:\ enheten kan mappas p√• stora volym diskar eller virtuella datorer. F√∂r att h√•lla distributionerna enkla i deras struktur rekommenderar vi att du f√∂ljer f√∂ljande distributions m√∂nster f√∂r SAP NetWeaver-system i Azure
>
> V√§xlings filen f√∂r Windows-operativsystemet b√∂r vara p√• D: enhet (icke-best√§ndig disk)
>
> ![Linux][Logo_Linux] Linux
>
> Placera Linux-swapfile under/mnt/mnt/Resource p√• Linux enligt beskrivningen i [den h√§r artikeln][virtual-machines-linux-agent-user-guide]. V√§xlings filen kan konfigureras i konfigurations filen f√∂r Linux-agentens/etc/waagent.conf. L√§gg till eller √§ndra f√∂ljande inst√§llningar:
>
>

```
ResourceDisk.EnableSwap=y
ResourceDisk.SwapSizeMB=30720
```

Om du vill aktivera √§ndringarna m√•ste du starta om Linux-agenten med

```
sudo service waagent restart
```

L√§s SAP NOTE [1597355] f√∂r mer information om den rekommenderade v√§xlings filens storlek

---
Antalet diskar som anv√§nds f√∂r DBMS-datafilerna och vilken typ av Azure Storage diskarna √§r v√§rd f√∂r, b√∂r fastst√§llas av IOPS-kraven och den latens som kr√§vs. Exakta kvoter beskrivs i [den h√§r artikeln (Linux)][virtual-machines-sizes-linux] och [den h√§r artikeln (Windows)][virtual-machines-sizes-windows].

Erfarenhet av SAP-distributioner under de senaste tv√• √•ren √§r n√•gra lektioner, som kan sammanfattas som:

* IOPS-trafik till olika datafiler √§r inte alltid samma eftersom befintliga kund system kan ha olika storleks data filer som representerar sina SAP-databaser. Detta inneb√§r att det √§r b√§ttre att anv√§nda en RAID-konfiguration √∂ver flera diskar f√∂r att placera datafilerna som LUN-h√§mtas fr√•n dem. Det finns situationer, s√§rskilt med Azure standard Storage d√§r en IOPS-taxa n√•r kvoten f√∂r en enskild disk mot DBMS-transaktionshanteraren. I s√•dana scenarier rekommenderar vi att du anv√§nder Premium Storage, eller att du kan aggregera flera standard lagrings diskar med en programs rand.

---
> ![Windows][Logo_Windows] Windows
>
> * [Prestandametodtips f√∂r SQL Server i Azure Virtual Machines][virtual-machines-sql-server-performance-best-practices]
>
> ![Linux][Logo_Linux] Linux
>
> * [Konfigurera programvaru-RAID p√• Linux][virtual-machines-linux-configure-raid]
> * [Konfigurera LVM p√• en virtuell Linux-dator i Azure][virtual-machines-linux-configure-lvm]
> * [Azure Storage hemligheter och I/O-optimeringar I Linux](https://blogs.msdn.com/b/igorpag/archive/2014/10/23/azure-storage-secrets-and-linux-i-o-optimizations.aspx)
>
>

---
* Premium Storage visar betydande b√§ttre prestanda, s√§rskilt f√∂r viktiga skrivningar i transaktions loggen. F√∂r SAP-scenarier som f√∂rv√§ntas leverera produktion som prestanda rekommenderar vi starkt att du anv√§nder VM-serien som kan utnyttja Azure Premium Storage.

T√§nk p√• att disken som inneh√•ller operativ systemet, och som vi rekommenderar, bin√§rfilerna f√∂r SAP och databasen (bas-VM) ocks√• inte l√§ngre √§r begr√§nsad till 127GB. Det kan nu ha upp till 1 TB storlek. Detta b√∂r vara tillr√§ckligt med utrymme f√∂r att beh√•lla all n√∂dv√§ndig fil, inklusive t. ex. SAP batch job-loggar.

Mer information och mer information, specifikt f√∂r virtuella DBMS-datorer, finns i [distributions guiden f√∂r DBMS][dbms-guide]

#### <a name="disk-handling"></a>Disk hantering

I de flesta fall m√•ste du skapa ytterligare diskar f√∂r att kunna distribuera SAP-databasen till den virtuella datorn. Vi har talat om √∂verv√§ganden om antalet diskar i kapitlet om [VM/disk Structure f√∂r SAP-distributioner][planning-guide-5.5.1] av det h√§r dokumentet. Med Azure Portal kan du ansluta och koppla fr√•n diskar n√§r en virtuell bas dator har distribuerats. Diskarna kan kopplas/kopplas fr√•n n√§r den virtuella datorn √§r ig√•ng samt n√§r den har stoppats. N√§r du kopplar en disk, Azure Portal erbjuda en tom disk eller en befintlig disk, vilket vid tidpunkten inte √§r kopplat till en annan virtuell dator.

**Obs**: diskar kan bara kopplas till en virtuell dator vid en best√§md tidpunkt.

![Ansluta/koppla fr√•n diskar med Azure standard Storage][planning-guide-figure-1400]

Under distributionen av en ny virtuell dator kan du v√§lja om du vill anv√§nda Managed Disks eller placera diskarna p√• Azure Storage-konton. Om du vill anv√§nda Premium Storage rekommenderar vi att du anv√§nder Managed Disks.

D√§refter m√•ste du best√§mma om du vill skapa en ny och en tom disk eller om du vill v√§lja en befintlig disk som √∂verf√∂rdes tidigare och som ska kopplas till den virtuella datorn nu.

**Viktigt**: du vill **inte** anv√§nda cachelagring av v√§rdar med Azure standard Storage. Du b√∂r l√§mna inst√§llningen f√∂r v√§rd-cachen till standardv√§rdet NONE. Med Azure Premium Storage b√∂r du aktivera cachelagring av filer om I/O-variabeln huvudsakligen l√§ser som typisk I/O-trafik mot datafiler I databasen. I h√§ndelse av databas transaktions logg filen rekommenderas ingen cachelagring.

---
> ![Windows][Logo_Windows] Windows
>
> [S√• h√§r ansluter du en datadisk i Azure Portal][virtual-machines-linux-attach-disk-portal]
>
> Om diskarna √§r anslutna m√•ste du logga in p√• den virtuella datorn f√∂r att √∂ppna Windows Disk Manager. Om automount inte √§r aktiverat enligt rekommendationer i kapitel [inst√§llningen automontera f√∂r anslutna diskar][planning-guide-5.5.3], m√•ste den nyligen anslutna volymen tas online och initieras.
>
> ![Linux][Logo_Linux] Linux
>
> Om diskarna √§r anslutna m√•ste du logga in p√• den virtuella datorn och initiera diskarna enligt beskrivningen i [den h√§r artikeln][virtual-machines-linux-how-to-attach-disk-how-to-initialize-a-new-data-disk-in-linux]
>
>

---
Om den nya disken √§r en tom disk, m√•ste du √§ven formatera disken. F√∂r formatering, s√§rskilt f√∂r DBMS-data och loggfiler, samma rekommendationer som f√∂r distribution utan operativ system i DBMS till√§mpas.

Som redan n√§mnts i kapitlet [Microsoft Azure begreppet virtuell dator][planning-guide-3.2]ger ett Azure Storage konto inte n√•gra o√§ndliga resurser vad g√§ller i/O-volym, IOPS och data volym. Virtuella DBMS-datorer p√•verkas vanligt vis av detta. Det kan vara b√§st att anv√§nda ett separat lagrings konto f√∂r varje virtuell dator om du har n√•gra virtuella datorer i/O-volymer som ska distribueras f√∂r att ligga inom gr√§nsen f√∂r Azure Storage kontots volym. Annars m√•ste du se hur du kan balansera de virtuella datorerna mellan olika lagrings konton utan att anv√§nda gr√§nsen f√∂r varje enskilt lagrings konto. Mer information beskrivs i [distributions guiden f√∂r DBMS][dbms-guide]. Du b√∂r ocks√• ha de h√§r begr√§nsningarna i √•tanke f√∂r virtuella datorer i SAP-programservern eller andra virtuella datorer, vilket kan kr√§va ytterligare virtuella h√•rd diskar. Dessa begr√§nsningar g√§ller inte om du anv√§nder hanterad disk. Om du planerar att anv√§nda Premium Storage rekommenderar vi att du anv√§nder hanterad disk.

Ett annat √§mne, som √§r relevant f√∂r lagrings konton √§r om de virtuella h√•rd diskarna i ett lagrings konto f√•r geo-replikeras. Geo-replikering √§r aktiverat eller inaktiverat p√• lagrings konto niv√•n och inte p√• VM-niv√•n. Om geo-replikering √§r aktiverat replikeras de virtuella h√•rd diskarna i lagrings kontot till ett annat Azure-datacenter inom samma region. Innan du best√§mmer detta b√∂r du t√§nka p√• f√∂ljande begr√§nsning:

Azure geo-replikering fungerar lokalt p√• varje virtuell h√•rd disk i en virtuell dator och replikerar inte IOs i kronologisk ordning √∂ver flera virtuella h√•rd diskar i en virtuell dator. D√§rf√∂r replikeras den virtuella h√•rd disken som representerar den virtuella bas datorn samt eventuella ytterligare virtuella h√•rd diskar som √§r anslutna till den virtuella datorn oberoende av varandra. Det inneb√§r att det inte finns n√•gon synkronisering mellan √§ndringarna i de olika virtuella h√•rd diskarna. Det faktum att IOs replikeras oberoende av i vilken ordning de skrivs, inneb√§r att geo-replikering inte √§r ett v√§rde f√∂r databas servrar som har sina databaser distribuerade √∂ver flera virtuella h√•rd diskar. F√∂rutom DBMS kan det ocks√• finnas andra program d√§r processer skriver eller manipulerar data i olika virtuella h√•rd diskar och d√§r det √§r viktigt att beh√•lla √§ndrings ordningen. Om det √§r ett krav b√∂r geo-replikering i Azure inte aktive ras. Beroende p√• om du beh√∂ver eller vill anv√§nda geo-replikering f√∂r en upps√§ttning virtuella datorer, men inte f√∂r en annan upps√§ttning, kan du redan kategorisera virtuella datorer och deras relaterade virtuella h√•rd diskar till olika lagrings konton som har geo-replikering aktiverat eller inaktiverat.

#### <a name="17e0d543-7e8c-4160-a7da-dd7117a1ad9d"></a>St√§ller in automontering f√∂r anslutna diskar
---
> ![Windows][Logo_Windows] Windows
>
> F√∂r virtuella datorer, som skapas fr√•n egna avbildningar eller diskar, √§r det n√∂dv√§ndigt att kontrol lera och eventuellt ange parametern f√∂r automontering. Genom att ange den h√§r parametern kan den virtuella datorn efter en omstart eller omdistribution i Azure montera de anslutna/monterade enheterna igen automatiskt.
> Parametern anges f√∂r de avbildningar som tillhandah√•lls av Microsoft p√• Azure Marketplace.
>
> Information om hur du st√§ller in den h√§r monterings kontrollen finns i dokumentationen f√∂r den k√∂rbara kommando rads programmet DiskPart. exe h√§r:
>
> * [Kommando rads alternativ f√∂r DiskPart](https://technet.microsoft.com/library/bb490893.aspx)
> * [Automount](https://technet.microsoft.com/library/cc753703.aspx)
>
> Windows kommando rads f√∂nster b√∂r √∂ppnas som administrat√∂r.
>
> Om diskarna √§r anslutna m√•ste du logga in p√• den virtuella datorn f√∂r att √∂ppna Windows Disk Manager. Om automount inte √§r aktiverat enligt rekommendationer i kapitel [inst√§llningen automontera f√∂r anslutna diskar][planning-guide-5.5.3], m√•ste den nyligen anslutna volymen > tas online och initieras.
>
> ![Linux][Logo_Linux] Linux
>
> Du m√•ste initiera en nyligen ansluten tom disk enligt beskrivningen i [den h√§r artikeln][virtual-machines-linux-how-to-attach-disk-how-to-initialize-a-new-data-disk-in-linux].
> Du m√•ste ocks√• l√§gga till nya diskar i/etc/fstab.
>
>

---
### <a name="final-deployment"></a>Slutlig distribution

F√∂r den slutliga distributionen och de exakta stegen, s√§rskilt vad g√§ller distributionen av Azure-till√§gget f√∂r SAP, se [distributions guiden][deployment-guide].

## <a name="accessing-sap-systems-running-within-azure-vms"></a>√Ötkomst till SAP-system som k√∂rs i virtuella Azure-datorer

F√∂ljande procedurer m√•ste till√§mpas f√∂r scenarier d√§r du vill ansluta till dessa SAP-system via det offentliga Internet som anv√§nder SAP-gr√§nssnittet.

Senare i dokumentet diskuterar vi det andra st√∂rre scenariot, ansluter till SAP-system i distributioner mellan platser, som har en plats-till-plats-anslutning (VPN-tunnel) eller en Azure ExpressRoute-anslutning mellan de lokala systemen och Azure-systemen.

### <a name="remote-access-to-sap-systems"></a>Fj√§rr√•tkomst till SAP-system

Med Azure Resource Manager finns det inte l√§ngre n√•gra standard slut punkter som i den tidigare klassiska modellen. Alla portar i en Azure Resource Manager VM √§r √∂ppna s√• l√§nge:

1. Ingen n√§tverks s√§kerhets grupp har definierats f√∂r under n√§tet eller n√§tverks gr√§nssnittet. N√§tverks trafik till virtuella Azure-datorer kan skyddas via s√• kallade "n√§tverks s√§kerhets grupper". Mer information finns i [Vad √§r en n√§tverkss√§kerhetsgrupp?][virtual-networks-nsg]
2. Ingen Azure Load Balancer har definierats f√∂r n√§tverks gr√§nssnittet   

Se skillnaden mellan den klassiska modellen och ARM-arkitekturen enligt beskrivningen i [den h√§r artikeln][virtual-machines-azure-resource-manager-architecture].

#### <a name="configuration-of-the-sap-system-and-sap-gui-connectivity-over-the-internet"></a>Konfiguration av SAP-systemet och SAP GUI-anslutning via Internet

I den h√§r artikeln beskrivs information i det h√§r avsnittet: <https://blogs.msdn.com/b/saponsqlserver/archive/2014/06/24/sap-gui-connection-closed-when-connecting-to-sap-system-in-azure.aspx>

#### <a name="changing-firewall-settings-within-vm"></a>√Ñndra brand V√§ggs inst√§llningar i VM

Det kan vara n√∂dv√§ndigt att konfigurera brand v√§ggen p√• dina virtuella datorer f√∂r att till√•ta inkommande trafik till SAP-systemet.

---
> ![Windows][Logo_Windows] Windows
>
> Som standard √§r Windows-brandv√§ggen i en distribuerad Azure-dator aktive rad. Du m√•ste nu till√•ta SAP-porten att √∂ppnas, annars kan inte SAP-ANV√ÑNDARGR√ÑNSSNITTET ansluta.
> G√∂r s√• h√§r:
>
> * √ñppna kontroll Kontrollpanelen\system och s√§kerhet-brandv√§ggen till **Avancerade inst√§llningar**.
> * H√∂gerklicka p√• regler f√∂r inkommande trafik och v√§lj **ny regel**.
> * I f√∂ljande guide v√§ljer du att skapa en ny **port** regel.
> * I n√§sta steg i guiden l√§mnar du inst√§llningen vid TCP och skriver in det port nummer som du vill √∂ppna. Eftersom v√•rt SAP-instans-ID √§r 00 tog vi 3200. Om instansen har ett annat instans nummer, ska porten du definierade tidigare utifr√•n instans numret √∂ppnas.
> * I n√§sta del av guiden m√•ste du l√§mna objektet **Till√•t anslutning** markerat.
> * I n√§sta steg i guiden m√•ste du definiera om regeln g√§ller f√∂r dom√§n, privat och offentligt n√§tverk. Justera det om det beh√∂vs f√∂r dina behov. Men om du ansluter med SAP-GUI fr√•n utsidan via det offentliga n√§tverket m√•ste du ha regeln till√§mpad p√• det offentliga n√§tverket.
> * I det sista steget i guiden namnger du regeln och sparar genom att trycka p√• **Slutf√∂r**.
>
> Regeln b√∂rjar g√§lla omedelbart.
>
> ![Definition av port regel][planning-guide-figure-1600]
>
> ![Linux][Logo_Linux] Linux
>
> Linux-avbildningarna i Azure Marketplace aktiverar inte program varan iptables-brandv√§ggen som standard och anslutningen till ditt SAP-system b√∂r fungera. Om du har aktiverat program varan iptables eller en annan brand v√§gg, se dokumentationen f√∂r program varan iptables eller den anv√§nda brand v√§ggen f√∂r att till√•ta inkommande TCP-trafik till port 32xx (d√§r xx √§r system numret f√∂r ditt SAP-system).
>
>

---
#### <a name="security-recommendations"></a>S√§kerhetsrekommendationer

Det grafiska anv√§ndar gr√§nssnittet f√∂r SAP ansluter inte direkt till n√•gon av SAP-instanserna (port 32xx) som k√∂rs, men ansluter f√∂rst via porten som √∂ppnas till SAP Message Server-processen (port 36xx). Tidigare anv√§ndes samma port av meddelande servern f√∂r intern kommunikation till program instanserna. F√∂r att f√∂rhindra att lokala program servrar kommunicerar med en meddelande server i Azure kan de interna kommunikations portarna √§ndras. Vi rekommenderar starkt att du √§ndrar den interna kommunikationen mellan SAP-meddelande servern och dess program instanser till ett annat port nummer p√• system som har klonas fr√•n lokala system, till exempel en klon av utveckling f√∂r projekt testning osv. Detta kan g√∂ras med standard profil parametern:

> rdisp/msserv_internal
>
>

som dokumenteras i [s√§kerhets inst√§llningar f√∂r SAP Message Server](https://help.sap.com/saphelp_nwpi71/helpdata/en/47/c56a6938fb2d65e10000000a42189c/content.htm)


### <a name="3e9c3690-da67-421a-bc3f-12c520d99a30"></a>Enkel virtuell dator med SAP NetWeaver demo/utbildnings scenario

![Att k√∂ra en enda virtuell dator SAP demo system med samma VM-namn, isolerade i Azure Cloud Services][planning-guide-figure-1700]

I det h√§r scenariot implementerar vi ett typiskt scenario f√∂r utbildning/demonstrations system d√§r det fullst√§ndiga scenariot f√∂r utbildning/demonstration finns i en enda virtuell dator. Vi antar att distributionen g√∂rs via mallar f√∂r VM-avbildningar. Vi f√∂ruts√§tter ocks√• att flera av de virtuella datorerna f√∂r demo/utbildning m√•ste distribueras med de virtuella datorerna med samma namn. Hela utbildnings systemen har ingen anslutning till dina lokala resurser och √§r en motsats till en hybrid distribution.

Antagandet √§r att du har skapat en avbildning av en virtuell dator som beskrivs i vissa avsnitt av kapitlet att [f√∂rbereda virtuella datorer med SAP f√∂r Azure][planning-guide-5.2] i det h√§r dokumentet.

H√§ndelse ordningen f√∂r att implementera scenariot ser ut s√• h√§r:

##### <a name="powershell"></a>PowerShell

* Skapa en ny resurs grupp f√∂r varje utbildning/demo liggande

```powershell
$rgName = "SAPERPDemo1"
New-AzResourceGroup -Name $rgName -Location "North Europe"
```
* Skapa ett nytt lagrings konto om du inte vill anv√§nda Managed Disks

```powershell
$suffix = Get-Random -Minimum 100000 -Maximum 999999
$account = New-AzStorageAccount -ResourceGroupName $rgName -Name "saperpdemo$suffix" -SkuName Standard_LRS -Kind "Storage" -Location "North Europe"
```

* Skapa ett nytt virtuellt n√§tverk f√∂r varje utbildning/demo landskap f√∂r att aktivera anv√§ndningen av samma v√§rdnamn och IP-adresser. Det virtuella n√§tverket skyddas av en n√§tverks s√§kerhets grupp som endast till√•ter trafik till port 3389 f√∂r att aktivera √•tkomst till fj√§rr skrivbord och port 22 f√∂r SSH.

```powershell
# Create a new Virtual Network
$rdpRule = New-AzNetworkSecurityRuleConfig -Name SAPERPDemoNSGRDP -Protocol * -SourcePortRange * -DestinationPortRange 3389 -Access Allow -Direction Inbound -SourceAddressPrefix * -DestinationAddressPrefix * -Priority 100
$sshRule = New-AzNetworkSecurityRuleConfig -Name SAPERPDemoNSGSSH -Protocol * -SourcePortRange * -DestinationPortRange 22 -Access Allow -Direction Inbound -SourceAddressPrefix * -DestinationAddressPrefix * -Priority 101
$nsg = New-AzNetworkSecurityGroup -Name SAPERPDemoNSG -ResourceGroupName $rgName -Location  "North Europe" -SecurityRules $rdpRule,$sshRule

$subnetConfig = New-AzVirtualNetworkSubnetConfig -Name Subnet1 -AddressPrefix  10.0.1.0/24 -NetworkSecurityGroup $nsg
$vnet = New-AzVirtualNetwork -Name SAPERPDemoVNet -ResourceGroupName $rgName -Location "North Europe"  -AddressPrefix 10.0.1.0/24 -Subnet $subnetConfig
```

* Skapa en ny offentlig IP-adress som kan anv√§ndas f√∂r att f√• √•tkomst till den virtuella datorn fr√•n Internet

```powershell
# Create a public IP address with a DNS name
$pip = New-AzPublicIpAddress -Name SAPERPDemoPIP -ResourceGroupName $rgName -Location "North Europe" -DomainNameLabel $rgName.ToLower() -AllocationMethod Dynamic
```

* Skapa ett nytt n√§tverks gr√§nssnitt f√∂r den virtuella datorn

```powershell
# Create a new Network Interface
$nic = New-AzNetworkInterface -Name SAPERPDemoNIC -ResourceGroupName $rgName -Location "North Europe" -Subnet $vnet.Subnets[0] -PublicIpAddress $pip
```

* Skapa en virtuell dator. I det h√§r scenariot har varje virtuell dator samma namn. SAP SID f√∂r SAP NetWeaver-instanserna i de virtuella datorerna √§r ocks√• samma. I Azure-resurs gruppen m√•ste namnet p√• den virtuella datorn vara unikt, men i olika Azure-resurs grupper kan du k√∂ra virtuella datorer med samma namn. Standard kontot administrat√∂r f√∂r Windows eller root f√∂r Linux √§r inte giltiga. Ett nytt administrat√∂rs anv√§ndar namn m√•ste d√§rf√∂r definieras tillsammans med ett l√∂sen ord. Storleken p√• den virtuella datorn m√•ste ocks√• definieras.

```powershell
#####
# Create a new virtual machine with an official image from the Azure Marketplace
#####
$cred=Get-Credential -Message "Type the name and password of the local administrator account."
$vmconfig = New-AzVMConfig -VMName SAPERPDemo -VMSize Standard_D11

# select image
$vmconfig = Set-AzVMSourceImage -VM $vmconfig -PublisherName "MicrosoftWindowsServer" -Offer "WindowsServer" -Skus "2012-R2-Datacenter" -Version "latest"
$vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Windows -ComputerName "SAPERPDemo" -Credential $cred -ProvisionVMAgent -EnableAutoUpdate
# $vmconfig = Set-AzVMSourceImage -VM $vmconfig -PublisherName "SUSE" -Offer "SLES-SAP" -Skus "12-SP1" -Version "latest"
# $vmconfig = Set-AzVMSourceImage -VM $vmconfig -PublisherName "RedHat" -Offer "RHEL" -Skus "7.2" -Version "latest"
# $vmconfig = Set-AzVMSourceImage -VM $vmconfig -PublisherName "Oracle" -Offer "Oracle-Linux" -Skus "7.2" -Version "latest"
# $vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Linux -ComputerName "SAPERPDemo" -Credential $cred

$vmconfig = Add-AzVMNetworkInterface -VM $vmconfig -Id $nic.Id

$vmconfig = Set-AzVMBootDiagnostics -Disable -VM $vmconfig
$vm = New-AzVM -ResourceGroupName $rgName -Location "North Europe" -VM $vmconfig
```

```powershell
#####
# Create a new virtual machine with a VHD that contains the private image that you want to use
#####
$cred=Get-Credential -Message "Type the name and password of the local administrator account."
$vmconfig = New-AzVMConfig -VMName SAPERPDemo -VMSize Standard_D11

$vmconfig = Add-AzVMNetworkInterface -VM $vmconfig -Id $nic.Id

$diskName="osfromimage"
$osDiskUri=$account.PrimaryEndpoints.Blob.ToString() + "vhds/" + $diskName  + ".vhd"

$vmconfig = Set-AzVMOSDisk -VM $vmconfig -Name $diskName -VhdUri $osDiskUri -CreateOption fromImage -SourceImageUri <path to VHD that contains the OS image> -Windows
$vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Windows -ComputerName "SAPERPDemo" -Credential $cred
#$vmconfig = Set-AzVMOSDisk -VM $vmconfig -Name $diskName -VhdUri $osDiskUri -CreateOption fromImage -SourceImageUri <path to VHD that contains the OS image> -Linux
#$vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Linux -ComputerName "SAPERPDemo" -Credential $cred

$vmconfig = Set-AzVMBootDiagnostics -Disable -VM $vmconfig
$vm = New-AzVM -ResourceGroupName $rgName -Location "North Europe" -VM $vmconfig
```

```powershell
#####
# Create a new virtual machine with a Managed Disk Image
#####
$cred=Get-Credential -Message "Type the name and password of the local administrator account."
$vmconfig = New-AzVMConfig -VMName SAPERPDemo -VMSize Standard_D11

$vmconfig = Add-AzVMNetworkInterface -VM $vmconfig -Id $nic.Id

$vmconfig = Set-AzVMSourceImage -VM $vmconfig -Id <Id of Managed Disk Image>
$vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Windows -ComputerName "SAPERPDemo" -Credential $cred
#$vmconfig = Set-AzVMOperatingSystem -VM $vmconfig -Linux -ComputerName "SAPERPDemo" -Credential $cred

$vmconfig = Set-AzVMBootDiagnostics -Disable -VM $vmconfig
$vm = New-AzVM -ResourceGroupName $rgName -Location "North Europe" -VM $vmconfig
```

* Du kan ocks√• l√§gga till ytterligare diskar och √•terst√§lla n√∂dv√§ndigt inneh√•ll. Alla BLOB-namn (URL: er till Blobbarna) m√•ste vara unika i Azure.

```powershell
# Optional: Attach additional VHD data disks
$vm = Get-AzVM -ResourceGroupName $rgName -Name SAPERPDemo
$dataDiskUri = $account.PrimaryEndpoints.Blob.ToString() + "vhds/datadisk.vhd"
Add-AzVMDataDisk -VM $vm -Name datadisk -VhdUri $dataDiskUri -DiskSizeInGB 1023 -CreateOption empty | Update-AzVM

# Optional: Attach additional Managed Disks
$vm = Get-AzVM -ResourceGroupName $rgName -Name SAPERPDemo
Add-AzVMDataDisk -VM $vm -Name datadisk -DiskSizeInGB 1023 -CreateOption empty -Lun 0 | Update-AzVM
```

##### <a name="cli"></a>CLI

F√∂ljande exempel kod kan anv√§ndas i Linux. F√∂r Windows kan du antingen anv√§nda PowerShell som det beskrivs ovan eller anpassa exemplet f√∂r att anv√§nda% rgName% i st√§llet f√∂r $rgName och ange milj√∂variabeln med hj√§lp av Windows-kommando *upps√§ttningen*.

* Skapa en ny resurs grupp f√∂r varje utbildning/demo liggande

```
rgName=SAPERPDemo1
rgNameLower=saperpdemo1
az group create --name $rgName --location "North Europe"
```

* Skapa ett nytt lagringskonto

```
az storage account create --resource-group $rgName --location "North Europe" --kind Storage --sku Standard_LRS --name $rgNameLower
```

* Skapa ett nytt virtuellt n√§tverk f√∂r varje utbildning/demo landskap f√∂r att aktivera anv√§ndningen av samma v√§rdnamn och IP-adresser. Det virtuella n√§tverket skyddas av en n√§tverks s√§kerhets grupp som endast till√•ter trafik till port 3389 f√∂r att aktivera √•tkomst till fj√§rr skrivbord och port 22 f√∂r SSH.

```
az network nsg create --resource-group $rgName --location "North Europe" --name SAPERPDemoNSG
az network nsg rule create --resource-group $rgName --nsg-name SAPERPDemoNSG --name SAPERPDemoNSGRDP --protocol \* --source-address-prefix \* --source-port-range \* --destination-address-prefix \* --destination-port-range 3389 --access Allow --priority 100 --direction Inbound
az network nsg rule create --resource-group $rgName --nsg-name SAPERPDemoNSG --name SAPERPDemoNSGSSH --protocol \* --source-address-prefix \* --source-port-range \* --destination-address-prefix \* --destination-port-range 22 --access Allow --priority 101 --direction Inbound

az network vnet create --resource-group $rgName --name SAPERPDemoVNet --location "North Europe" --address-prefixes 10.0.1.0/24
az network vnet subnet create --resource-group $rgName --vnet-name SAPERPDemoVNet --name Subnet1 --address-prefix 10.0.1.0/24 --network-security-group SAPERPDemoNSG
```

* Skapa en ny offentlig IP-adress som kan anv√§ndas f√∂r att f√• √•tkomst till den virtuella datorn fr√•n Internet

```
az network public-ip create --resource-group $rgName --name SAPERPDemoPIP --location "North Europe" --dns-name $rgNameLower --allocation-method Dynamic
```

* Skapa ett nytt n√§tverks gr√§nssnitt f√∂r den virtuella datorn

```
az network nic create --resource-group $rgName --location "North Europe" --name SAPERPDemoNIC --public-ip-address SAPERPDemoPIP --subnet Subnet1 --vnet-name SAPERPDemoVNet
```

* Skapa en virtuell dator. I det h√§r scenariot har varje virtuell dator samma namn. SAP SID f√∂r SAP NetWeaver-instanserna i de virtuella datorerna √§r ocks√• samma. I Azure-resurs gruppen m√•ste namnet p√• den virtuella datorn vara unikt, men i olika Azure-resurs grupper kan du k√∂ra virtuella datorer med samma namn. Standard kontot administrat√∂r f√∂r Windows eller root f√∂r Linux √§r inte giltiga. Ett nytt administrat√∂rs anv√§ndar namn m√•ste d√§rf√∂r definieras tillsammans med ett l√∂sen ord. Storleken p√• den virtuella datorn m√•ste ocks√• definieras.

```
#####
# Create virtual machines using storage accounts
#####
az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image MicrosoftWindowsServer:WindowsServer:2012-R2-Datacenter:latest --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image SUSE:SLES-SAP:12-SP1:latest --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os --authentication-type password
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image RedHat:RHEL:7.2:latest --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os --authentication-type password
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image "Oracle:Oracle-Linux:7.2:latest" --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os --authentication-type password

#####
# Create virtual machines using Managed Disks
#####
az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image MicrosoftWindowsServer:WindowsServer:2012-R2-Datacenter:latest --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image SUSE:SLES-SAP:12-SP1:latest --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os --authentication-type password
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image RedHat:RHEL:7.2:latest --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os --authentication-type password
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --image "Oracle:Oracle-Linux:7.2:latest" --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os --authentication-type password
```

```
#####
# Create a new virtual machine with a VHD that contains the private image that you want to use
#####
az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --os-type Windows --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os --image <path to image vhd>
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --os-type Linux --admin-username <username> --admin-password <password> --size Standard_D11 --use-unmanaged-disk --storage-account $rgNameLower --storage-container-name vhds --os-disk-name os --image <path to image vhd> --authentication-type password

#####
# Create a new virtual machine with a Managed Disk Image
#####
az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os --image <managed disk image id>
#az vm create --resource-group $rgName --location "North Europe" --name SAPERPDemo --nics SAPERPDemoNIC --admin-username <username> --admin-password <password> --size Standard_DS11_v2 --os-disk-name os --image <managed disk image id> --authentication-type password
```

* Du kan ocks√• l√§gga till ytterligare diskar och √•terst√§lla n√∂dv√§ndigt inneh√•ll. Alla BLOB-namn (URL: er till Blobbarna) m√•ste vara unika i Azure.

```
# Optional: Attach additional VHD data disks
az vm unmanaged-disk attach --resource-group $rgName --vm-name SAPERPDemo --size-gb 1023 --vhd-uri https://$rgNameLower.blob.core.windows.net/vhds/data.vhd  --new

# Optional: Attach additional Managed Disks
az vm disk attach --resource-group $rgName --vm-name SAPERPDemo --size-gb 1023 --disk datadisk --new
```

##### <a name="template"></a>Mall

Du kan anv√§nda exemplen p√• lagrings platsen f√∂r Azure-snabb start-mallar p√• GitHub.

* [Enkel virtuell Linux-dator](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-simple-linux)
* [Enkel virtuell Windows-dator](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-simple-windows)
* [Virtuell dator fr√•n avbildning](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-from-user-image)

### <a name="implement-a-set-of-vms-that-communicate-within-azure"></a>Implementera en upps√§ttning virtuella datorer som kommunicerar i Azure

Detta icke-hybrid scenario √§r ett typiskt scenario f√∂r utbildnings-och demo syfte d√§r program varan som representerar demo-/utbildnings scenariot sprids √∂ver flera virtuella datorer. De olika komponenterna som installeras p√• de olika virtuella datorerna m√•ste kommunicera med varandra. I det h√§r scenariot beh√∂vs det ingen lokal n√§tverkskommunikation eller ett scenario mellan platser.

Det h√§r scenariot √§r en ut√∂kning av den installation som beskrivs i kapitel [Single VM with demo/Training scenario f√∂r NetWeaver][planning-guide-7.1] i det h√§r dokumentet. I det h√§r fallet kommer fler virtuella datorer att l√§ggas till i en befintlig resurs grupp. I f√∂ljande exempel best√•r utbildningen av en virtuell SAP ASCS/SCS-dator, en virtuell dator som k√∂r ett DBMS och en virtuell SAP Application Server-instans.

Innan du skapar det h√§r scenariot m√•ste du t√§nka p√• grundl√§ggande inst√§llningar som redan har utnyttjats i scenariot innan.

#### <a name="resource-group-and-virtual-machine-naming"></a>Resurs grupp och namngivning av virtuella datorer

Alla resurs grupp namn m√•ste vara unika. Utveckla ditt eget namngivnings schema f√∂r dina resurser, till exempel `<rg-name`> suffix.

Det virtuella dator namnet m√•ste vara unikt inom resurs gruppen.

#### <a name="set-up-network-for-communication-between-the-different-vms"></a>Konfigurera n√§tverk f√∂r kommunikation mellan olika virtuella datorer

![Upps√§ttning virtuella datorer i ett Azure-Virtual Network][planning-guide-figure-1900]

F√∂r att f√∂rhindra att namnge kollisioner med kloner av samma utbildning/demonstration-landskap m√•ste du skapa ett Azure-Virtual Network f√∂r varje landskap. DNS-namnmatchning kommer att tillhandah√•llas av Azure eller s√• kan du konfigurera din egen DNS-server utanf√∂r Azure (ska inte diskuteras h√§r). I det h√§r scenariot konfigurerar vi inte v√•r egen DNS. F√∂r alla virtuella datorer i en Azure-Virtual Network aktive ras kommunikation via v√§rdnamn.

Anledningen till att separata utbildnings-eller demonstrations landskap av virtuella n√§tverk och inte bara resurs grupper kan vara:

* SAP landskap som kon figurer ATS kr√§ver sin egen AD/OpenLDAP och en dom√§n Server m√•ste vara en del av varje landskap.  
* SAP-landskapet som kon figurer ATS har komponenter som m√•ste fungera med fasta IP-adresser.

Mer information om virtuella Azure-n√§tverk och hur du definierar dem finns i [den h√§r artikeln][virtual-networks-create-vnet-arm-pportal].

## <a name="deploying-sap-vms-with-corporate-network-connectivity-cross-premises"></a>Distribuera virtuella SAP-datorer med f√∂retags n√§tverks anslutning (mellan platser)

Du k√∂r ett SAP-landskap och vill dela upp distributionen mellan Bare-Metal f√∂r avancerade DBMS-servrar, lokala virtualiserade milj√∂er f√∂r program lager och mindre 2-Tier konfigurerade SAP-system och Azure-IaaS. Det grundl√§ggande antagandet √§r att SAP-system i ett SAP-landskap m√•ste kommunicera med varandra och med m√•nga andra program varu komponenter som distribueras i f√∂retaget, oberoende av deras distributions formul√§r. Det b√∂r inte heller finnas n√•gra skillnader i distributions formul√§ret f√∂r slutanv√§ndaren som ansluter till SAP-ANV√ÑNDARGR√ÑNSSNITTET eller andra gr√§nssnitt. Dessa villkor kan bara uppfyllas n√§r vi har de lokala Active Directory-och OpenLDAP-och DNS-tj√§nsterna ut√∂kade till Azure-systemen via plats-till-plats/anslutning till flera platser eller privata anslutningar som Azure ExpressRoute.



### <a name="scenario-of-an-sap-landscape"></a>Scenario f√∂r ett SAP-landskap

Det kors-eller hybrid scenariot kan vara grovt beskrivet som i bilden nedan:

![Plats-till-plats-anslutning mellan lokala och Azure-tillg√•ngar][planning-guide-figure-2100]

Minimi kravet √§r att anv√§nda s√§kra kommunikations protokoll som SSL/TLS f√∂r webb l√§sar √•tkomst eller VPN-baserade anslutningar f√∂r system √•tkomst till Azure-tj√§nsterna. Antagandet √§r att f√∂retag hanterar VPN-anslutningen mellan f√∂retagets n√§tverk och Azure p√• olika s√§tt. Vissa f√∂retag kan √∂ppna alla portar i ett tomt fall. Vissa andra f√∂retag kanske vill vara precis p√• vilka portar de beh√∂ver √∂ppna osv.

I tabellen nedan visas typiska SAP-kommunikations portar. I princip r√§cker det att √∂ppna SAP Gateway-porten.

<!-- sapms is prefix of a SAP service name and not a spelling error -->

| Tj√§nst | Portnamn | Exempel `<nn`> = 01 | Standard intervall (min-max) | Kommentar |
| --- | --- | --- | --- | --- |
| Dispatcher |sapdp`<nn>` se * |3201 |3200 - 3299 |SAP dispatcher, som anv√§nds av SAP GUI f√∂r Windows och Java |
| Meddelande Server |sapms`<sid`> Se * * |3600 |gratis sapms`<anySID`> |sid = SAP-system-ID |
| Gateway |sapgw`<nn`> Se * |3301 |free |SAP-Gateway, som anv√§nds f√∂r CPIC-och RFC-kommunikation |
| SAP-router |sapdp99 |3299 |free |Endast CI (Central instans) tj√§nst namn kan omtilldelas i/etc/Services till ett godtyckligt v√§rde efter installationen. |

*) NN = SAP instance Number

\* *) sid = SAP-system-ID

Mer detaljerad information om portar som kr√§vs f√∂r olika SAP-produkter och-tj√§nster av SAP-produkter finns h√§r <https://scn.sap.com/docs/DOC-17124>.
Med det h√§r dokumentet b√∂r du kunna √∂ppna s√§rskilda portar i VPN-enheten som kr√§vs f√∂r s√§rskilda SAP-produkter och-scenarier.

Andra s√§kerhets √•tg√§rder n√§r du distribuerar virtuella datorer i ett s√•dant scenario kan vara att skapa en [n√§tverks s√§kerhets grupp][virtual-networks-nsg] f√∂r att definiera √•tkomst regler.

### <a name="dealing-with-different-virtual-machine-series"></a>Hantera olika serier f√∂r virtuella datorer

Microsoft har lagt till m√•nga fler typer av virtuella datorer som skiljer sig √•t antingen i antal virtuella processorer, minne eller viktigare p√• maskin vara som den k√∂rs p√•. Alla de virtuella datorerna st√∂ds inte med SAP (se VM-typer som st√∂ds i SAP NOTE [1928533]). N√•gra av de virtuella datorerna k√∂rs p√• olika v√§rdars maskin varu generationer. Dessa v√§rden f√∂r maskin varu generationer distribueras i kornig het i en Azure-Scale-enhet. Det kan uppst√• fall d√§r de olika VM-typerna du v√§ljer inte kan k√∂ras p√• samma Scale-Unit. En tillg√§nglighets upps√§ttning √§r begr√§nsad i m√∂jligheten att t√§cka skalnings enheter baserat p√• olika maskin vara.  Om du till exempel k√∂r SAP-DBMS-skiktet p√• en E64s_v3, en virtuell dator som finns i en tillg√§nglighets upps√§ttning tillsammans med den virtuella datorn som k√∂r den sekund√§ra DBMS-instansen i en HA-konfiguration, kan du inte bara stoppa och starta om den sekund√§ra virtuella datorn som virtuell dator i M-serien, eftersom du kanske vill pgrade den virtuella datorn. Orsak √§r att virtuella datorer i M-serien och virtuella datorer i Ev3-serien k√∂rs p√• olika maskin vara och med det i olika skalnings enheter. Du m√•ste skapa en ny tillg√§nglighets upps√§ttning, ta bort den sekund√§ra virtuella datorn Ev3, utan att ta bort lagringen, och sedan distribuera om den virtuella datorn som M-seriens virtuella dator till den nya tillg√§nglighets upps√§ttningen.

#### <a name="printing-on-a-local-network-printer-from-sap-instance-in-azure"></a>Skriva ut p√• en lokal n√§tverks skrivare fr√•n SAP-instansen i Azure

##### <a name="printing-over-tcpip-in-cross-premises-scenario"></a>Skriva ut √∂ver TCP/IP i ett scenario med flera platser

Konfiguration av lokala TCP/IP-baserade n√§tverks skrivare i en virtuell Azure-dator √§r samma som i f√∂retagets n√§tverk, f√∂rutsatt att du har en VPN-anslutning f√∂r plats-till-plats-tunnel eller ExpressRoute-anslutning uppr√§ttad.

---
> ![Windows][Logo_Windows] Windows
>
> G√∂r s√• h√§r:
>
> * Vissa n√§tverks skrivare levereras med en konfigurations guide som g√∂r det enkelt att konfigurera skrivaren i en virtuell Azure-dator. Om ingen guide program vara har distribuerats med skrivaren √§r det manuella s√§ttet att konfigurera skrivaren att skapa en ny TCP/IP-skrivarport.
> * √ñppna kontroll panelen ‚Äì > enheter och skrivare ‚Äì > l√§gga till en skrivare
> * V√§lj L√§gg till en skrivare med en TCP/IP-adress eller ett v√§rdnamn
> * Ange skrivarens IP-adress
> * Skrivar port standard 9100
> * Installera l√§mplig skrivar driv rutin manuellt om det beh√∂vs.
>
> ![Linux][Logo_Linux] Linux
>
> * precis som f√∂r Windows f√∂ljer du standard proceduren f√∂r att installera en n√§tverks skrivare
> * F√∂lj bara de offentliga Linux-guiderna f√∂r [SUSE](https://www.suse.com/documentation/sles-12/book_sle_deployment/data/sec_y2_hw_print.html) eller [Red Hat och Oracle Linux](https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Printer_Configuration.html) om hur du l√§gger till en skrivare.
>
>

---
![N√§tverks utskrift][planning-guide-figure-2200]

##### <a name="host-based-printer-over-smb-shared-printer-in-cross-premises-scenario"></a>V√§rdbaserad skrivare √∂ver SMB (delad skrivare) i ett scenario med flera platser

V√§rdbaserade skrivare √§r inte n√§tverks kompatibla genom design. Men en v√§rdbaserad skrivare kan delas mellan datorer i ett n√§tverk f√∂rutsatt att skrivaren √§r ansluten till en dator som √§r p√•slagen. Anslut f√∂retagets n√§tverk till antingen plats-till-plats eller ExpressRoute och dela din lokala skrivare. SMB-protokollet anv√§nder NetBIOS i st√§llet f√∂r DNS as Name Service. NetBIOS-v√§rdnamnet kan vara ett annat √§n DNS-v√§rdnamnet. Standard fallet √§r att NetBIOS-v√§rdnamnet och DNS-v√§rdnamnet √§r identiska. DNS-dom√§nen √§r inte begriplig i NetBIOS-namnomr√•det. Detta √§r att det fullst√§ndigt kvalificerade DNS-v√§rdnamnet som best√•r av DNS-v√§rdnamnet och DNS-dom√§nen inte f√•r anv√§ndas i NetBIOS-namn utrymmet.

Skrivar resursen identifieras med ett unikt namn i n√§tverket:

* V√§rd namnet f√∂r SMB-v√§rden (alltid n√∂dv√§ndigt).
* Namnet p√• resursen (alltid n√∂dv√§ndigt).
* Namnet p√• dom√§nen om skrivar resursen inte finns i samma dom√§n som SAP-systemet.
* Dessutom kan ett anv√§ndar namn och ett l√∂sen ord kr√§vas f√∂r att f√• √•tkomst till skrivar resursen.

Anvisningar:

---
> ![Windows][Logo_Windows] Windows
>
> Dela din lokala skrivare.
> I den virtuella Azure-datorn √∂ppnar du Utforskaren och skriver in skrivarens resurs namn.
> En installations guide f√∂r skrivare v√§gleder dig genom installations processen.
>
> ![Linux][Logo_Linux] Linux
>
> H√§r f√∂ljer n√•gra exempel p√• dokumentation om hur du konfigurerar n√§tverks skrivare i Linux eller inkluderar ett kapitel ang√•ende utskrift i Linux. Den fungerar p√• samma s√§tt i en virtuell Azure Linux-dator s√• l√§nge den virtuella datorn ing√•r i ett VPN:
>
> * SLES <https://en.opensuse.org/SDB:Printing_via_SMB_(Samba)_Share_or_Windows_Share>
> * RHEL eller Oracle Linux <https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/sec-Printer_Configuration.html#s1-printing-smb-printer>
>
>

---
##### <a name="usb-printer-printer-forwarding"></a>USB-skrivare (vidarebefordring av skrivare)

I Azure √§r m√∂jligheten f√∂r Fj√§rrskrivbordstj√§nster att ge anv√§ndarna √•tkomst till sina lokala skrivar enheter i en fj√§rrsession inte tillg√§nglig.

---
> ![Windows][Logo_Windows] Windows
>
> Mer information om hur du skriver ut med Windows finns h√§r: <https://technet.microsoft.com/library/jj590748.aspx>.
>
>

---
#### <a name="integration-of-sap-azure-systems-into-correction-and-transport-system-tms-in-cross-premises"></a>Integrering av SAP Azure-system i korrigerings-och transport system (TMS) i olika platser

TMS (SAP Change and transport system) m√•ste konfigureras f√∂r att exportera och importera transport beg√§r Anden mellan system i liggande format. Vi f√∂ruts√§tter att utvecklings instanserna f√∂r ett SAP-system (DEV) finns i Azure, medan kvalitets s√§krings systemet (fr√•gor och svar) och produktiva system (PRD) √§r lokalt. Dessutom f√∂ruts√§tter vi att det finns en central √∂verf√∂rings katalog.

##### <a name="configuring-the-transport-domain"></a>Konfigurera transport dom√§nen

Konfigurera transport dom√§nen p√• det system som du angav som transport dom√§n kontrol Lanterna enligt beskrivningen i [Konfigurera transport](https://help.sap.com/erp2005_ehp_04/helpdata/en/44/b4a0b47acc11d1899e0000e829fbbd/content.htm)dom√§nkontrollanten. En systemuser-TMSADM skapas och den obligatoriska RFC-destinationen skapas. Du kan kontrol lera dessa RFC-anslutningar med transaktions SM59. Hostname-matchning m√•ste vara aktiverat i din transport dom√§n.

Anvisningar:

* I v√•rt scenario best√§mde vi att det lokala QAS-systemet √§r den CTS-dom√§nkontrollanten. Anropa transaktion STMS. Dialog rutan TMS visas. Dialog rutan konfigurera transport dom√§n visas. (Den h√§r dialog rutan visas bara om du √§nnu inte har konfigurerat en transport dom√§n.)
* Se till att den automatiskt skapade anv√§ndaren TMSADM √§r auktoriserad (SM59-> ABAP Connection-> TMSADM@E61.DOMAIN_E61-> information ‚Äì > Utilities (M) ‚Äì > Authorization test). Den f√∂rsta sk√§rmen i transaktions STMS b√∂r visa att SAP-systemet nu fungerar som styrenhet f√∂r transport dom√§nen som visas h√§r:

![Inledande sk√§rm f√∂r transaktions STMS p√• dom√§nkontrollanten][planning-guide-figure-2300]

#### <a name="including-sap-systems-in-the-transport-domain"></a>Inklusive SAP-system i transport dom√§nen

Sekvensen inklusive ett SAP-system i en transport dom√§n ser ut s√• h√§r:

* I DEV-systemet i Azure g√•r du till transport systemet (Client 000) och anropar Transaction STMS. V√§lj annan konfiguration i dialog rutan och forts√§tt med inkludera system i dom√§n. Ange dom√§nkontrollanten som m√•l v√§rd ([inklusive SAP-system i transport dom√§nen](https://help.sap.com/erp2005_ehp_04/helpdata/en/44/b4a0c17acc11d1899e0000e829fbbd/content.htm?frameset=/en/44/b4a0b47acc11d1899e0000e829fbbd/frameset.htm)). Systemet v√§ntar nu p√• att tas med i transport dom√§nen.
* Av s√§kerhets sk√§l m√•ste du g√• tillbaka till dom√§nkontrollanten f√∂r att bekr√§fta din beg√§ran. V√§lj system √∂versikt och godk√§nn v√§ntar p√• systemet. Bekr√§fta sedan fr√•gan och konfigurationen kommer att distribueras.

Detta SAP-system inneh√•ller nu n√∂dv√§ndig information om alla andra SAP-system i transport dom√§nen. P√• samma tidpunkt skickas adress data f√∂r det nya SAP-systemet till alla andra SAP-system, och SAP-systemet anges i transport kontroll programmets transport profil. Kontrol lera om RFC: er och √•tkomst till dom√§nens transport katalog fungerar.

Forts√§tt med konfigurationen av ditt transport system som vanligt enligt beskrivningen i dokumentations [√§ndrings-och transport systemet](https://help.sap.com/saphelp_nw70ehp3/helpdata/en/48/c4300fca5d581ce10000000a42189c/content.htm?frameset=/en/44/b4a0b47acc11d1899e0000e829fbbd/frameset.htm).

Anvisningar:

* Kontrol lera att din STMS lokalt √§r korrekt konfigurerad.
* Se till att v√§rd namnet f√∂r transport dom√§nkontrollanten kan l√∂sas av den virtuella datorn p√• Azure och vice visum.
* Anropa Transaction STMS-> andra konfigurations-> inkludera system i dom√§n.
* Bekr√§fta anslutningen i det lokala TMS-systemet.
* Konfigurera transport v√§gar, grupper och lager som vanligt.

I scenarier med plats-till-plats ansluten mellan olika platser kan svars tiden mellan lokala och Azure fortfarande vara betydande. Om vi f√∂ljer ordningen f√∂r att transportera objekt via utvecklings-och test system till produktion eller om du t√§nker anv√§nda transporter eller support paket p√• olika system, inser du att, beroende p√• platsen f√∂r den centrala transport katalogen, vissa av systemen kommer att drabbas av h√∂g latens vid l√§sning eller skrivning av data i den centrala transport katalogen. Situationen liknar konfigurationer i SAP landskap d√§r de olika systemen sprids genom olika data Center med ett stort avst√•nd mellan data centren.

F√∂r att undvika svars tid och l√•ta systemet arbeta snabbt vid l√§sning eller skrivning till eller fr√•n transport katalogen, kan du konfigurera tv√• STMS transport dom√§ner (en f√∂r lokal och en med system i Azure och l√§nka transport dom√§nerna. L√§s den h√§r dokumentationen, som f√∂rklarar principerna bakom det h√§r konceptet i SAP-TMS: <https://help.sap.com/saphelp_me60/helpdata/en/c4/6045377b52253de10000009b38f889/content.htm?frameset=/en/57/38dd924eb711d182bf0000e829fbfe/frameset.htm>.

Anvisningar:

* Konfigurera en transport dom√§n p√• varje plats (lokalt och Azure) med Transaction STMS <https://help.sap.com/saphelp_nw70ehp3/helpdata/en/44/b4a0b47acc11d1899e0000e829fbbd/content.htm>
* L√§nka dom√§nerna till en dom√§n l√§nk och bekr√§fta l√§nken mellan de tv√• dom√§nerna.
  <https://help.sap.com/saphelp_nw73ehp1/helpdata/en/a3/139838280c4f18e10000009b38f8cf/content.htm>
* Distribuera konfigurationen till det l√§nkade systemet.

#### <a name="rfc-traffic-between-sap-instances-located-in-azure-and-on-premises-cross-premises"></a>RFC-trafik mellan SAP-instanser som finns i Azure och lokalt (mellan platser)

RFC-trafik mellan system, som √§r lokalt och i Azure, m√•ste fungera. Konfigurera en SM59 f√∂r anslutnings anrop i ett k√§ll system d√§r du m√•ste definiera en RFC-anslutning till m√•l systemet. Konfigurationen liknar standard konfigurationen av en RFC-anslutning.

Vi antar att de virtuella datorerna i det kors lokala scenariot som k√∂r SAP-system som m√•ste kommunicera med varandra finns i samma dom√§n. Konfigurationen av en RFC-anslutning mellan SAP-system skiljer sig d√§rf√∂r inte fr√•n installations stegen och indatan i lokala scenarier.

#### <a name="accessing-local-fileshares-from-sap-instances-located-in-azure-or-vice-versa"></a>√Ötkomst till lokala fil resurser fr√•n SAP-instanser som finns i Azure eller vice versa

SAP-instanser som finns i Azure beh√∂ver komma √•t fil resurser som finns i f√∂retags lokal. Dessutom beh√∂ver lokala SAP-instanser √•tkomst till fil resurser som finns i Azure. Om du vill aktivera fil resurserna m√•ste du konfigurera beh√∂righeter och delnings alternativ p√• det lokala systemet. Se till att √∂ppna portarna p√• VPN-eller ExpressRoute-anslutningen mellan Azure och ditt data Center.

## <a name="supportability"></a>Support

### <a name="6f0a47f3-a289-4090-a053-2521618a28c3"></a>Azure-till√§gg f√∂r SAP

F√∂r att kunna mata in viss del av Azures infrastruktur information om verksamhets kritiska SAP-system till SAP-v√§rd agent instanserna som √§r installerade p√• virtuella datorer, m√•ste ett Azure-till√§gg (VM) f√∂r SAP installeras f√∂r de distribuerade virtuella datorerna. Eftersom de krav som publicerades av SAP var speciella f√∂r SAP-program, beslutade Microsoft inte att generiskt implementera de n√∂dv√§ndiga funktionerna i Azure, men l√§mna dem f√∂r kunderna att distribuera n√∂dv√§ndig VM-till√§gg och konfigurationer till Virtual Machines som k√∂rs i Azure. Distribution och livs cykel hantering av Azure VM-till√§gget f√∂r SAP kommer dock att automatiseras av Azure.

#### <a name="solution-design"></a>L√∂sningsdesign

L√∂sningen som har utvecklats f√∂r att m√∂jligg√∂ra att SAP-v√§rd agent f√•r n√∂dv√§ndig information baseras p√• arkitekturen i Azure VM agent och till√§gg ramverket. Id√©n med Azure VM-agenten och till√§gg ramverket √§r att till√•ta att program vara som √§r tillg√§ngliga i Azures till√§gg f√∂r virtuella Azure-till√§gg i en virtuell dator kan installeras. Princip id√©n bakom detta begrepp √§r att till√•ta (i de fall som Azure-till√§gget f√∂r SAP), distributionen av s√§rskilda funktioner till en virtuell dator och konfigurationen av s√•dan program vara vid distributions tillf√§llet.

Azure VM-agenten som m√∂jligg√∂r hantering av vissa Azure VM-till√§gg i den virtuella datorn matas in i virtuella Windows-datorer som standard n√§r du skapar virtuella datorer i Azure Portal. Om det g√§ller SUSE, Red Hat eller Oracle Linux √§r VM-agenten redan en del av Azure Marketplace-avbildningen. Om en virtuell Linux-dator skulle √∂verf√∂ras fr√•n lokal plats till Azure m√•ste VM-agenten installeras manuellt.

De grundl√§ggande Bygg stenarna i l√∂sningen f√∂r att tillhandah√•lla Azure-infrastruktur information till SAP-v√§rd agenten i Azure ser ut s√• h√§r:

![Microsoft Azure till√§ggs komponenter][planning-guide-figure-2400]

Som du ser i block diagrammet ovan, finns en del av l√∂sningen i Azure VM-avbildningen och Azure Extension Gallery, som √§r en globalt replikerad lagrings plats som hanteras av Azure-√•tg√§rder. Det √§r ansvaret f√∂r det gemensamma SAP/MS-teamet som arbetar med Azure-implementeringen av SAP f√∂r att arbeta med Azure-√•tg√§rder f√∂r att publicera nya versioner av Azure-till√§gget f√∂r SAP.

N√§r du distribuerar en ny virtuell Windows-dator l√§ggs Azure VM-agenten automatiskt till i den virtuella datorn. Den h√§r agentens funktion √§r att samordna inl√§sningen och konfigurationen av de virtuella datorernas Azure-till√§gg. F√∂r virtuella Linux-datorer ing√•r Azure VM-agenten redan i Azure Marketplace OS-avbildningen.

Det finns dock ett steg som fortfarande m√•ste utf√∂ras av kunden. Detta √§r inaktiverat och konfigurationen av prestanda insamling. Processen som √§r relaterad till konfigurationen automatiseras av ett PowerShell-skript eller CLI-kommando. PowerShell-skriptet kan laddas ned i Microsoft Azure Script Center enligt beskrivningen i [distributions guiden][deployment-guide].

Den √∂vergripande arkitekturen f√∂r Azure-till√§gget f√∂r SAP ser ut s√• h√§r:

![Azure-till√§gg f√∂r SAP ][planning-guide-figure-2500]

**Om du vill ha mer information om hur du anv√§nder dessa PowerShell-cmdletar eller CLI-kommandot under distributioner f√∂ljer du anvisningarna i [distributions guiden][deployment-guide].**

### <a name="integration-of-azure-located-sap-instance-into-saprouter"></a>Integrering av Azure finns SAP-instans i SAProuter

SAP-instanser som k√∂rs i Azure m√•ste ocks√• vara tillg√§ngliga fr√•n SAProuter.

![SAP-router n√§tverks anslutning][planning-guide-figure-2600]

En SAProuter aktiverar TCP/IP-kommunikationen mellan deltagande system om det inte finns n√•gon direkt IP-anslutning. Detta ger f√∂rdelen att ingen anslutning fr√•n slut punkt till slut punkt mellan kommunikations partners √§r n√∂dv√§ndig p√• n√§tverks niv√•. SAProuter lyssnar p√• port 3299 som standard.
Om du vill ansluta SAP-instanser via en SAProuter m√•ste du ge SAProuter-str√§ngen och v√§rd namnet med alla f√∂rs√∂k att ansluta.

## <a name="sap-netweaver-as-java"></a>SAP NetWeaver som Java

Hittills har dokumentet varit SAP-NetWeaver i allm√§nhet eller SAP NetWeaver ABAP-stacken. I det h√§r sm√• avsnittet visas information om de olika aspekterna f√∂r SAP Java-stacken. En av de viktigaste SAP NetWeaver Java-baserade program √§r SAP-Enterprise Portal. Andra SAP NetWeaver-baserade program som SAP PI och SAP Solution Manager anv√§nder b√•de SAP NetWeaver-ABAP och Java-stackar. D√§rf√∂r √§r det verkligen n√∂dv√§ndigt att √∂verv√§ga vissa aspekter som r√∂r SAP NetWeaver Java-stacken.

### <a name="sap-enterprise-portal"></a>SAP-Enterprise Portal

Installationen av en SAP-Portal p√• en virtuell Azure-dator skiljer sig inte fr√•n en lokal installation om du distribuerar i scenarier med olika platser. Eftersom DNS g√∂rs av lokalt kan port inst√§llningarna f√∂r de enskilda instanserna g√∂ras som konfigurerade lokalt. Rekommendationerna och begr√§nsningarna som beskrivs i det h√§r dokumentet g√§ller f√∂r ett program som SAP Enterprise Portal eller SAP NetWeaver Java stack i allm√§nhet.

![Exponerade SAP-Portal][planning-guide-figure-2700]

Ett s√§rskilt distributions scenario av vissa kunder √§r den direkta exponeringen hos SAP-Enterprise Portal till Internet medan den virtuella v√§rden √§r ansluten till f√∂retagets n√§tverk via plats-till-plats-VPN-tunnel eller ExpressRoute. F√∂r ett s√•dant scenario m√•ste du se till att vissa portar √§r √∂ppna och inte blockeras av brand v√§ggen eller n√§tverks s√§kerhets gruppen. 

Den inledande portalens URI √§r http (s):`<Portalserver`>: 5XX00/irj d√§r porten bildas som dokumenterad av SAP i <https://help.sap.com/saphelp_nw70ehp1/helpdata/de/a2/f9d7fed2adc340ab462ae159d19509/frameset.htm>.

![Slut punkts konfiguration][planning-guide-figure-2800]

Om du vill anpassa URL: en och/eller portarna f√∂r din SAP-Enterprise Portal, se den h√§r dokumentationen:

* [√Ñndra portal-URL](https://wiki.scn.sap.com/wiki/display/EP/Change+Portal+URL)
* [√Ñndra standard port nummer, Portal port nummer](https://wiki.scn.sap.com/wiki/display/NWTech/Change+Default++port+numbers%2C+Portal+port+numbers)

## <a name="high-availability-ha-and-disaster-recovery-dr-for-sap-netweaver-running-on-azure-virtual-machines"></a>H√∂g tillg√§nglighet (HA) och haveri beredskap (DR) f√∂r SAP-NetWeaver som k√∂rs p√• Azure Virtual Machines

### <a name="definition-of-terminologies"></a>Definition av terminologi

Termen **h√∂g tillg√§nglighet (ha)** √§r i allm√§nhet relaterad till en upps√§ttning tekniker som MINIMERAr IT-avbrott genom att ge IT-tj√§nster verksamhets kontinuitet genom redundanta, feltoleranta eller redundansv√§xling skyddade komponenter i **samma** Data Center. I v√•rt fall, inom en Azure-region.

**Haveri beredskap (Dr)** √§r ocks√• riktad mot att minimera IT-tj√§nstens avbrott och √•terst√§llningen, men √∂ver **olika** Data Center, som vanligt vis finns hundratals kilo meters avst√•nd. I v√•rt fall √§r det vanligt vis mellan olika Azure-regioner i samma politiska region eller som du har fastst√§llt som kund.

### <a name="overview-of-high-availability"></a>√ñversikt √∂ver h√∂g tillg√§nglighet

Vi kan dela upp diskussionen om SAP h√∂g tillg√§nglighet i Azure i tv√• delar:

* **Azure-infrastruktur med h√∂g tillg√§nglighet**, till exempel ha f√∂r ber√§kning (VM), n√§tverk, lagring osv. och dess f√∂rdelar f√∂r att √∂ka tillg√§ngligheten f√∂r SAP-program.
* **SAP-program h√∂g tillg√§nglighet**, till exempel ha av SAP-program varu komponenter:
  * SAP-program servrar
  * SAP ASCS/SCS-instans
  * DB-server

och hur det kan kombineras med Azure-infrastruktur HA.

SAP h√∂g tillg√§nglighet i Azure har vissa skillnader j√§mf√∂rt med SAP h√∂g tillg√§nglighet i en lokal fysisk eller virtuell milj√∂. F√∂ljande dokument fr√•n SAP beskriver standard konfigurationerna f√∂r SAP med h√∂g tillg√§nglighet i virtualiserade milj√∂er i Windows: <https://scn.sap.com/docs/DOC-44415>. Det finns ingen sapinst-integrerad SAP-HA-konfiguration f√∂r Linux som den finns f√∂r Windows. Om du har en lokal SAP-tillg√§nglighet f√∂r Linux hittar du mer information h√§r: <https://scn.sap.com/docs/DOC-8541>.

### <a name="azure-infrastructure-high-availability"></a>H√∂g tillg√§nglighet f√∂r Azure-infrastruktur

Det finns f√∂r n√§rvarande ett service avtal med en virtuell dator p√• 99,9%. F√∂r att f√• en uppfattning om hur tillg√§ngligheten f√∂r en enskild virtuell dator kan se ut s√• kan du skapa produkten av de olika tillg√§ngliga Azure-service avtal: <https://azure.microsoft.com/support/legal/sla/>.

Basen f√∂r ber√§kningen √§r 30 dagar per m√•nad eller 43200 minuter. D√§rf√∂r motsvarar 0,05% nedtid till 21,6 minuter. Som vanligt kommer tillg√§ngligheten f√∂r de olika tj√§nsterna att multipliceras p√• f√∂ljande s√§tt:

(Tillg√§nglighets tj√§nst #1/100) * (tillg√§nglighets tj√§nst #2/100) * (tillg√§nglighets tj√§nst #3/100) 

Likadan

(99,95/100) * (99,9/100) * (99,9/100) = 0,9975 eller en √∂vergripande tillg√§nglighet p√• 99,75%.

#### <a name="virtual-machine-vm-high-availability"></a>H√∂g tillg√§nglighet f√∂r virtuell dator (VM)

Det finns tv√• typer av Azure Platform-h√§ndelser som kan p√•verka tillg√§ngligheten f√∂r dina virtuella datorer: planerat underh√•ll och oplanerat underh√•ll.

* Planerade underh√•lls h√§ndelser √§r periodiska uppdateringar som g√∂rs av Microsoft till den underliggande Azure-plattformen f√∂r att f√∂rb√§ttra den √∂vergripande tillf√∂rlitligheten, prestandan och s√§kerheten f√∂r den plattforms infrastruktur som dina virtuella datorer k√∂rs p√•.
* Oplanerade underh√•lls h√§ndelser intr√§ffar n√§r den maskin vara eller den fysiska infrastruktur som underliggande den virtuella datorn har misslyckats p√• n√•got s√§tt. Det kan vara lokala n√§tverksfel, lokala diskfel eller andra fel p√• rackniv√•. N√§r ett s√•dant fel uppt√§cks, kommer Azure-plattformen automatiskt att migrera den virtuella datorn fr√•n den ej h√§lsofysiska server som √§r v√§rd f√∂r den virtuella datorn till en felfri fysisk server. Den h√§r typen av h√§ndelser kan ocks√• g√∂ra att den virtuella datorn startas om, men det √§r ovanligt.

Mer information finns i den h√§r dokumentationen: <https://azure.microsoft.com/documentation/articles/virtual-machines-manage-availability>

#### <a name="azure-storage-redundancy"></a>Azure Storage Redundancy

Data i ditt Microsoft Azure Storage-konto replikeras alltid f√∂r att s√§kerst√§lla h√•llbarhet och h√∂g tillg√§nglighet, vilket uppfyller Azure Storage service avtal √§ven i de flesta tillf√§lliga maskin varu haverier.

Eftersom Azure Storage h√•ller tre avbildningar av data som standard beh√∂vs inte RAID5 eller RAID1 √∂ver flera Azure-diskar.

Mer information hittar du i den h√§r artikeln: <https://azure.microsoft.com/documentation/articles/storage-redundancy/>

#### <a name="utilizing-azure-infrastructure-vm-restart-to-achieve-higher-availability-of-sap-applications"></a>Anv√§nda en omstart av Azure Infrastructure VM f√∂r att uppn√• h√∂gre tillg√§nglighet f√∂r SAP-program

Om du v√§ljer att inte anv√§nda funktioner som Windows Server Failover Clustering (WSFC) eller pacemaker p√• Linux (f√∂r n√§rvarande endast f√∂r SLES 12 och h√∂gre) anv√§nds Azure VM-omstart f√∂r att skydda ett SAP-system mot planerad och oplanerad stillest√•nds tid f√∂r Azure fysisk server infrastruktur och den √∂vergripande underliggande Azure-plattformen.

> [!NOTE]
> Det √§r viktigt att n√§mna att Azure VM-omstart fr√§mst skyddar virtuella datorer och inte program. VM-omstart erbjuder inte h√∂g tillg√§nglighet f√∂r SAP-program, men det erbjuder en viss niv√• av infrastruktur tillg√§nglighet och d√§rf√∂r indirekt tillg√§nglighet f√∂r SAP-system. Det finns inte heller n√•got service avtal f√∂r den tid det tar att starta om en virtuell dator efter ett planerat eller oplanerat v√§rd avbrott. D√§rf√∂r √§r den h√§r metoden f√∂r h√∂g tillg√§nglighet inte l√§mplig f√∂r kritiska komponenter i ett SAP-system som (A) SCS eller DBMS.
>
>

Ett annat viktigt infrastruktur element f√∂r h√∂g tillg√§nglighet √§r lagring. Till exempel √§r Azure Storage service avtal 99,9% tillg√§nglighet. Om en distribuerar alla virtuella datorer med sina diskar till ett enda Azure Storage-konto, kommer potentiella Azure Storage otillg√§ngligheten att orsaka att alla virtuella datorer som placerats i det Azure Storage kontot och alla SAP-komponenter som k√∂rs i de virtuella datorerna √§r tillg√§ngliga.  

I st√§llet f√∂r att l√§gga till alla virtuella datorer i ett enda Azure Storage konto kan du ocks√• anv√§nda dedikerade lagrings konton f√∂r varje virtuell dator och p√• s√• s√§tt √∂ka den √∂vergripande VM-och SAP-programmets tillg√§nglighet genom att anv√§nda flera oberoende Azure Storage-konton.

Azure Managed Disks placeras automatiskt i fel dom√§nen f√∂r den virtuella dator som de √§r kopplade till. Om du placerar tv√• virtuella datorer i en tillg√§nglighets upps√§ttning och anv√§nder Managed Disks, tar plattformen hand om att distribuera Managed Disks till olika fel dom√§ner. Om du planerar att anv√§nda Premium Storage rekommenderar vi starkt att du anv√§nder hantera diskar √§ven.

En exempel arkitektur f√∂r ett SAP NetWeaver-system som anv√§nder Azures infrastruktur HA och lagrings konton kan se ut s√• h√§r:

![Anv√§nda Azure-infrastruktur HA f√∂r att f√• SAP-program h√∂gre tillg√§nglighet][planning-guide-figure-2900]

En exempel arkitektur f√∂r ett SAP NetWeaver-system som anv√§nder Azures infrastruktur HA och Managed Disks kan se ut s√• h√§r:

![Anv√§nda Azure-infrastruktur HA f√∂r att f√• SAP-program h√∂gre tillg√§nglighet][planning-guide-figure-2901]

F√∂r kritiska SAP-komponenter har vi uppn√•tt f√∂ljande hittills:

* H√∂g tillg√§nglighet f√∂r SAP-programservrar (AS)

  SAP Application Server-instanser √§r redundanta komponenter. Varje SAP AS-instans distribueras p√• en egen virtuell dator, som k√∂rs i en annan Azure-fel-och uppgraderings dom√§n (se kapitlen [fel dom√§ner][planning-guide-3.2.1] och [uppgraderings dom√§ner][planning-guide-3.2.2]). Detta s√§kerst√§lls med hj√§lp av Azures tillg√§nglighets upps√§ttningar (se kapitel [tillg√§nglighets upps√§ttningar f√∂r Azure][planning-guide-3.2.3]). Potentiell planerad eller oplanerad otillg√§nglig tillg√§nglighet f√∂r en Azure-fel eller uppgraderings dom√§n kommer att orsaka att ett begr√§nsat antal virtuella datorer inte √§r tillg√§ngliga med SAP som-instanser.

  Varje SAP AS-instans placeras i ett eget Azure Storage konto ‚Äì m√∂jligt att inte f√• till g√•ng till ett Azure Storage konto inneb√§r att det bara finns en virtuell dator med sin SAP som instans. T√§nk dock p√• att det finns en gr√§ns f√∂r Azure Storage konton i en Azure-prenumeration. F√∂r att s√§kerst√§lla att den automatiska starten av (A) SCS-instansen efter den virtuella datorn har startats om, m√•ste du ange Autostart-parametern i (A) SCS-instansens start profil som beskrivs i kapitlet [anv√§nda Autostart f√∂r SAP-instanser][planning-guide-11.5]
  L√§s √§ven kapitel [h√∂g tillg√§nglighet f√∂r SAP-program servrar][planning-guide-11.4.1] f√∂r mer information.

  √Ñven om du anv√§nder Managed Disks lagras dessa diskar ocks√• i ett Azure Storage konto och kan vara otillg√§ngliga i h√§ndelse av ett lagrings avbrott.

* *H√∂gre* Tillg√§nglighet f√∂r SAP (A) SCS-instans

  H√§r anv√§nder vi Azure VM-omstart f√∂r att skydda den virtuella datorn med en installerad SCS-instans (A). Om du har planerat eller oplanerat avbrott i Azure-servrarna startas virtuella datorer om p√• en annan tillg√§nglig server. Som tidigare n√§mnts kan Azure VM-omstart fr√§mst skydda virtuella datorer och inte program, i det h√§r fallet (A) SCS-instansen. Genom den virtuella datorn startar vi om indirekt h√∂gre tillg√§nglighet f√∂r SAP (A) SCS-instansen. F√∂r att f√∂rs√§kra dig om att den automatiska starten av (A) SCS-instansen efter den virtuella datorn har startats om m√•ste du ange Autostart-parametern i (A) SCS-instansens start profil som beskrivs i kapitlet [anv√§nda Autostart f√∂r SAP][planning-guide-11.5] Det inneb√§r att (A) SCS-instansen som en enskild felpunkt (SPOF) som k√∂rs i en enskild virtuell dator √§r den avbrotts faktor som √§r tillg√§nglig f√∂r hela SAP-landskapet.

* *H√∂gre* Tillg√§nglighet f√∂r DBMS-Server

  P√• liknande s√§tt som i SAP (A) SCS-instansen anv√§nder vi Azure VM-omstart f√∂r att skydda den virtuella datorn med ett installerat DBMS-program och vi uppn√•r h√∂gre tillg√§nglighet f√∂r DBMS-programvara via omstart av virtuella datorer.
  DBMS som k√∂rs i en enda virtuell dator √§r ocks√• en SPOF och det √§r den avvecklings faktor som √§r tillg√§nglig f√∂r hela SAP-landskapet.

### <a name="sap-application-high-availability-on-azure-iaas"></a>H√∂g tillg√§nglighet f√∂r SAP-program p√• Azure-IaaS

F√∂r att uppn√• full tillg√§nglighet f√∂r SAP-systemet m√•ste vi skydda alla viktiga SAP-system komponenter, till exempel redundanta SAP-programservrar och unika komponenter (till exempel en enskild felpunkt) som SAP (A) SCS-instans och DBMS.

#### <a name="5d9d36f9-9058-435d-8367-5ad05f00de77"></a>H√∂g tillg√§nglighet f√∂r SAP-programservrar

F√∂r instansen SAP-programservrar/-dialog √§r det inte n√∂dv√§ndigt att t√§nka p√• en specifik l√∂sning f√∂r h√∂g tillg√§nglighet. H√∂g tillg√§nglighet uppn√•s genom redundans och d√§rmed tillr√§ckligt m√•nga av dem p√• olika virtuella datorer. De b√∂r placeras i samma Azures tillg√§nglighets upps√§ttning f√∂r att undvika att de virtuella datorerna kan uppdateras samtidigt under avbrott i planerat underh√•ll. De grundl√§ggande funktionerna, som bygger p√• olika uppgraderings-och fel dom√§ner i en Azure-Scale-enhet, har redan introducerats i kapitel [uppgraderings dom√§ner][planning-guide-3.2.2]. Azures tillg√§nglighets upps√§ttningar presenterades i kapitel [Azures tillg√§nglighets upps√§ttningar][planning-guide-3.2.3] i det h√§r dokumentet.

Det finns inget obegr√§nsat antal fel-och uppgraderings dom√§ner som kan anv√§ndas av en Azure-tillg√§nglighets upps√§ttning i en Azure-Scale-enhet. Det inneb√§r att du placerar ett antal virtuella datorer i en tillg√§nglighets upps√§ttning, f√∂rr eller senare mer √§n en virtuell dator i samma fel-eller uppgraderings dom√§n.

Distribution av n√•gra SAP Application Server-instanser i sina dedikerade virtuella datorer och vi antar att vi fick fem uppgraderings dom√§ner visas f√∂ljande bild i slutet. Det faktiska max antalet fel-och uppdaterings dom√§ner i en tillg√§nglighets upps√§ttning kan √§ndras i framtiden:

![HA av SAP-program servrar i Azure][planning-guide-figure-3000]

Mer information finns i den h√§r dokumentationen: <https://azure.microsoft.com/documentation/articles/virtual-machines-manage-availability>

#### <a name="high-availability-for-sap-central-services-on-azure"></a>H√∂g tillg√§nglighet f√∂r SAP Central Services p√• Azure

F√∂r h√∂g tillg√§nglighets arkitektur i SAP Central Services p√• Azure, se artikeln [h√∂g tillg√§nglighets arkitektur och scenarier f√∂r SAP NetWeaver](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-high-availability-architecture-scenarios) som information. Artikeln pekar p√• mer detaljerade beskrivningar f√∂r specifika operativ system.

#### <a name="high-availability-for-the-sap-database-instance"></a>H√∂g tillg√§nglighet f√∂r SAP Database-instansen

Den typiska SAP-DBMS HA-installationen baseras p√• tv√• DBMS-datorer d√§r DBMS-funktioner med h√∂g tillg√§nglighet anv√§nds f√∂r att replikera data fr√•n den aktiva DBMS-instansen till den andra virtuella datorn i en passiv DBMS-instans.

Funktioner f√∂r h√∂g tillg√§nglighet och haveri beredskap f√∂r DBMS i allm√§nhet samt vissa DBMS beskrivs i [distributions guiden f√∂r DBMS][dbms-guide].

#### <a name="end-to-end-high-availability-for-the-complete-sap-system"></a>H√∂g tillg√§nglighet fr√•n slut punkt till slut punkt f√∂r hela SAP-systemet

H√§r f√∂ljer tv√• exempel p√• en komplett SAP NetWeaver HA-arkitektur i Azure ‚Äì en f√∂r Windows och en f√∂r Linux.

Endast ohanterade diskar: begreppen som beskrivs nedan kan beh√∂va komprometteras n√§r du distribuerar m√•nga SAP-system och antalet distribuerade virtuella datorer √∂verskrider max gr√§nsen f√∂r lagrings konton per prenumeration. I s√•dana fall m√•ste virtuella h√•rd diskar i virtuella datorer kombineras inom ett lagrings konto. Vanligt vis skulle du g√∂ra detta genom att kombinera virtuella h√•rd diskar med SAP-programlager p√• olika SAP-system.  Vi har ocks√• kombinerat olika virtuella h√•rd diskar av olika DBMS-VM: er f√∂r olika SAP-system i ett Azure Storage-konto. Att bevara de IOPS-gr√§nser som Azure Storage konton i √•tanke (<https://azure.microsoft.com/documentation/articles/storage-scalability-targets>)


##### <a name="windowslogo_windows-ha-on-windows"></a>![Windows][Logo_Windows] HA p√• Windows

![SAP NetWeaver Application HA-arkitektur med SQL Server i Azure IaaS][planning-guide-figure-3200]

F√∂ljande Azure-konstruktioner anv√§nds f√∂r SAP NetWeaver-systemet f√∂r att minimera p√•verkan p√• infrastruktur problem och v√§rd korrigering:

* Hela systemet distribueras p√• Azure (n√∂dv√§ndigt-DBMS-lager, (A) SCS-instans och fullst√§ndigt program lager m√•ste k√∂ras p√• samma plats).
* Hela systemet k√∂rs i en Azure-prenumeration (kr√§vs).
* Hela systemet k√∂rs i en Azure-Virtual Network (kr√§vs).
* Det g√•r att separera de virtuella datorerna i ett SAP-system i tre tillg√§nglighets upps√§ttningar √§ven med alla virtuella datorer som tillh√∂r samma Virtual Network.
* Varje lager (till exempel DBMS, ASCS, program servrar) m√•ste anv√§nda en dedikerad tillg√§nglighets upps√§ttning.
* Alla virtuella datorer som k√∂r DBMS-instanser av ett SAP-system finns i en tillg√§nglighets upps√§ttning. Vi f√∂ruts√§tter att det finns mer √§n en virtuell dator som k√∂r DBMS-instanser per system sedan ursprungligt DBMS h√∂g tillg√§nglighets funktioner anv√§nds, till exempel SQL Server AlwaysOn eller Oracle data Guard.
* Alla virtuella datorer som k√∂r DBMS-instanser anv√§nder sina egna lagrings konton. DBMS-data och loggfiler replikeras fr√•n ett lagrings konto till ett annat lagrings konto med hj√§lp av DBMS-funktioner med h√∂g tillg√§nglighet som synkroniserar data. Om du inte kan f√• till g√•ng till ett lagrings konto kan du inte f√• till g√•ng till en SQL-klusternod i Windows, men inte hela SQL Servers tj√§nsten.
* Alla virtuella datorer som k√∂r (A) SCS-instans av ett SAP-system finns i en tillg√§nglighets upps√§ttning. Ett WSFC-kluster (Windows Server failover Cluster) √§r konfigurerat i de virtuella datorerna f√∂r att skydda (A) SCS-instansen.
* Alla virtuella datorer som k√∂r (A) SCS-instanser anv√§nder sina egna lagrings konton. En SCS-instanser och globala SAP-mappar replikeras fr√•n ett lagrings konto till ett annat lagrings konto med hj√§lp av SIOS DataKeeper-replikering. Om ett lagrings konto inte √§r tillg√§ngligt kommer det att leda till att en (A) SCS-klusternod (a) inte √§r tillg√§nglig, men inte hela SCS-tj√§nsten (A).
* ALLA virtuella datorer som representerar SAP Application Server-lagret finns i en tredje tillg√§nglighets upps√§ttning.
* ALLA virtuella datorer som k√∂r SAP-programservrar anv√§nder sina egna lagrings konton. Om ett lagrings konto inte √§r tillg√§ngligt kan en SAP-Programserver bli otillg√§nglig, d√§r andra SAP-programservrar forts√§tter att k√∂ras.

F√∂ljande figur illustrerar samma liggande med Managed Disks.

![SAP NetWeaver Application HA-arkitektur med SQL Server i Azure IaaS][planning-guide-figure-3201]

##### <a name="linuxlogo_linux-ha-on-linux"></a>![Linux][Logo_Linux] HA p√• Linux

Arkitekturen f√∂r SAP HA p√• Linux p√• Azure √§r i princip samma som f√∂r Windows enligt beskrivningen ovan. Se SAP NOTE [1928533] f√∂r en lista √∂ver l√∂sningar med h√∂g tillg√§nglighet som st√∂ds.

### <a name="4e165b58-74ca-474f-a7f4-5e695a93204f"></a>Anv√§nda Autostart f√∂r SAP-instanser

SAP erbj√∂d funktionen att starta SAP-instanser direkt efter att operativ systemet startades p√• den virtuella datorn. De exakta stegen dokumenterades i Knowledge Base-artikeln [1909114]i SAP. Men SAP rekommenderar inte att du anv√§nder inst√§llningen l√§ngre eftersom det inte finns n√•gon kontroll i ordningen p√• instansen som startas om, f√∂rutsatt att fler √§n en virtuell dator har p√•verkat eller flera instanser har k√∂rts per virtuell dator. Om du antar ett typiskt Azure-scenario f√∂r en SAP Application Server-instans i en virtuell dator och om en enskild virtuell dator kommer att komma ig√•ng, √§r den autostarten inte kritisk och kan aktive ras genom att l√§gga till f√∂ljande parameter:

    Autostart = 1

I Start-profilen f√∂r SAP-ABAP och/eller Java-instansen.

> [!NOTE]
> Den Autostart-parametern kan ocks√• ha vissa downfalls. I detalj √§r parametern utl√∂ser starten av en SAP-ABAP eller Java-instans n√§r den relaterade Windows/Linux-tj√§nsten f√∂r instansen startas. Det √§r verkligen fallet n√§r operativ systemet startas. Omstarter av SAP-tj√§nster √§r dock ocks√• vanliga f√∂r SAP-funktioner f√∂r program livs cykel hantering, till exempel SUM eller andra uppdateringar och uppgraderingar. Dessa funktioner f√∂rv√§ntas inte att en instans ska startas om automatiskt. D√§rf√∂r b√∂r den Autostart-parametern inaktive ras innan aktiviteter k√∂rs. Autostart-parametern b√∂r inte heller anv√§ndas f√∂r SAP-instanser som √§r klustrade, som ASCS/SCS/CI.
>
>

Se ytterligare information om Autostart f√∂r SAP-instanser h√§r:

* [Starta/stoppa SAP tillsammans med din UNIX-server starta/stoppa](https://scn.sap.com/community/unix/blog/2012/08/07/startstop-sap-along-with-your-unix-server-startstop)
* [Starta och stoppa SAP NetWeaver-hanterings agenter](https://help.sap.com/saphelp_nwpi711/helpdata/en/49/9a15525b20423ee10000000a421938/content.htm)
* [S√• h√§r aktiverar du automatisk start av HANA-databas](http://sapbasisinfo.com/blog/2016/08/15/enabling-autostart-of-sap-hana-database-on-server-boot-situation/)

### <a name="larger-3-tier-sap-systems"></a>St√∂rre SAP-system p√• 3 niv√•er
H√∂g tillg√§nglighets aspekter av SAP-konfigurationer p√• tre niv√•er beskrivs redan i tidigare avsnitt. Men vad h√§nder om system d√§r DBMS-serverns krav √§r f√∂r stort f√∂r att det ska finnas i Azure, men SAP-programlagret kan distribueras till Azure?

#### <a name="location-of-3-tier-sap-configurations"></a>Plats f√∂r SAP-konfigurationer p√• 3 niv√•er
Det finns inte st√∂d f√∂r att dela upp sj√§lva program niv√•n eller program-och DBMS-niv√•n mellan lokalt och Azure. Ett SAP-system √§r antingen fullst√§ndigt distribuerat lokalt eller i Azure. Det finns inte heller st√∂d f√∂r att vissa program servrar ska k√∂ras lokalt och andra i Azure. Det √§r diskussionens start punkt. Vi st√∂der inte heller att DBMS-komponenterna i ett SAP-system och SAP-program Server-lagret distribueras i tv√• olika Azure-regioner. Till exempel DBMS i v√§stra USA och SAP-program skikt i Central USA. Anledningen till att inte st√∂dja s√•dana konfigurationer √§r f√∂rdr√∂jnings k√§nsligheten f√∂r SAP NetWeaver-arkitekturen.

Men under de senaste √•ren har data Center partners utvecklat samplaceringar till Azure-regioner. Dessa samplatser √§r ofta i n√§ra n√§rhet till de fysiska Azure-datacenterna i en Azure-region. Det korta avst√•ndet och anslutningen till till g√•ngarna i samplaceringen via ExpressRoute till Azure kan resultera i en latens som √§r mindre √§n 2ms. I s√•dana fall √§r det m√∂jligt att hitta DBMS-skiktet (inklusive SAN/NAS) i en s√•dan samplacering och SAP-Programskiktet i Azure. [Hana-stora instanser](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture). 

### <a name="offline-backup-of-sap-systems"></a>Offline-s√§kerhetskopiering av SAP-system
Beroende av den valda SAP-konfigurationen (2-eller 3-skikt) kan du beh√∂va s√§kerhetskopiera. Inneh√•llet i den virtuella datorn och f√∂r att ha en s√§kerhets kopia av databasen. De DBMS-relaterade s√§kerhets kopiorna f√∂rv√§ntas g√∂ras med databas metoder. En detaljerad beskrivning av de olika databaserna finns i DBMS- [Guide][dbms-guide]. √Ö andra sidan kan SAP-data s√§kerhets kopie ras p√• ett offline-s√§tt (inklusive databas inneh√•llet) enligt beskrivningen i det h√§r avsnittet eller online enligt beskrivningen i n√§sta avsnitt.

Offline-s√§kerhetskopiering kr√§ver i princip en omstart av den virtuella datorn via Azure Portal och en kopia av den virtuella bas-VM-disken plus alla anslutna diskar till den virtuella datorn. Detta bevarar en tidpunkts avbildning av den virtuella datorn och den tillh√∂r ande disken. Vi rekommenderar att du kopierar s√§kerhets kopiorna till ett annat Azure Storage konto. D√§rf√∂r g√§ller proceduren som beskrivs i kapitlet [kopiera diskar mellan Azure Storage konton][planning-guide-5.4.2] i det h√§r dokumentet.
F√∂rutom avst√§ngning med Azure Portal kan du ocks√• g√∂ra det via PowerShell eller CLI enligt beskrivningen h√§r: <https://azure.microsoft.com/documentation/articles/virtual-machines-deploy-rmtemplates-powershell/>

En √•terst√§llning av detta tillst√•nd skulle best√• i att ta bort den virtuella bas datorn samt de ursprungliga diskarna f√∂r den virtuella bas datorn och monterade diskar, kopiera de sparade diskarna till det ursprungliga lagrings kontot eller resurs gruppen f√∂r hanterade diskar och sedan distribuera om systemet.
Den h√§r artikeln visar ett exempel p√• hur du kan skripta processen i PowerShell: <http://www.westerndevs.com/azure-snapshots/>

Se till att installera en ny SAP-licens eftersom √•terst√§llning av en VM-s√§kerhetskopiering enligt beskrivningen ovan skapar en ny maskin varu nyckel.

### <a name="online-backup-of-an-sap-system"></a>Online-s√§kerhetskopiering av ett SAP-system

S√§kerhets kopiering av DBMS utf√∂rs med DBMS-/regionsspecifika metoder som beskrivs i DBMS- [guiden][dbms-guide].

Andra virtuella datorer i SAP-systemet kan s√§kerhets kopie ras med hj√§lp av funktionen f√∂r s√§kerhets kopiering av virtuella Azure-datorer. S√§kerhets kopiering av virtuella Azure-datorer √§r en standard metod f√∂r att s√§kerhetskopiera en komplett virtuell dator i Azure. Azure Backup lagrar s√§kerhets kopiorna i Azure och g√∂r det m√∂jligt att √•terst√§lla en virtuell dator igen.

> [!NOTE]
> Fr√•n och med dec 2015 beh√•ller inte det unika VM-ID som anv√§nds f√∂r SAP-licensiering med den virtuella datorns s√§kerhets kopiering. Det inneb√§r att en √•terst√§llning fr√•n en s√§kerhets kopia av en virtuell dator kr√§ver installation av en ny SAP-licens nyckel eftersom den √•terst√§llda virtuella datorn anses vara en ny virtuell dator och inte en ers√§ttning f√∂r den tidigare sparade.
>
> ![Windows][Logo_Windows] Windows
>
> Teoretiskt sett kan virtuella datorer som k√∂r databaser s√§kerhets kopie ras p√• ett konsekvent s√§tt √§ven om DBMS-systemet st√∂der Windows VSS (tj√§nsten Volume Shadow Copy <https://msdn.microsoft.com/library/windows/desktop/bb968832(v=vs.85).aspx>) som exempelvis SQL Server g√∂r.
> T√§nk dock p√• att det inte g√•r att anv√§nda en s√§kerhets kopia av virtuella Azure-s√§kerhetskopieringar f√∂r att √•terst√§lla databasen. Rekommendationen √§r d√§rf√∂r att s√§kerhetskopiera databaser med DBMS-funktioner i st√§llet f√∂r att f√∂rlita dig p√• s√§kerhets kopiering av virtuella Azure-datorer.
>
> Om du vill bekanta dig med s√§kerhets kopiering av virtuella Azure-datorer h√§r: <https://docs.microsoft.com/azure/backup/backup-azure-vms>.
>
> Andra m√∂jligheter √§r att anv√§nda en kombination av Microsoft-Data Protection Manager som √§r installerade p√• en virtuell Azure-dator och Azure Backup f√∂r att s√§kerhetskopiera/√•terst√§lla databaser. Mer information hittar du h√§r: <https://docs.microsoft.com/azure/backup/backup-azure-dpm-introduction>.  
>
> ![Linux][Logo_Linux] Linux
>
> Det finns ingen motsvarighet till Windows VSS i Linux. D√§rf√∂r √§r bara filkonsekventa s√§kerhets kopieringar m√∂jliga, men inte programkonsekventa s√§kerhets kopieringar. S√§kerhets kopieringen av SAP-DBMS b√∂r g√∂ras med hj√§lp av DBMS-funktioner. Fil systemet som inneh√•ller SAP-relaterade data kan sparas, till exempel genom att anv√§nda tj√§ra som beskrivs h√§r: <https://help.sap.com/saphelp_nw70ehp2/helpdata/en/d3/c0da3ccbb04d35b186041ba6ac301f/content.htm>
>
>

### <a name="azure-as-dr-site-for-production-sap-landscapes"></a>Azure as DR-webbplats f√∂r produktion SAP-landskap

Sedan mellan 2014 √§r till√§gg till olika komponenter runt Hyper-V, System Center och Azure att aktivera anv√§ndningen av Azure som en DR-plats f√∂r virtuella datorer som k√∂rs lokalt baserat p√• Hyper-V.

En blogg som beskriver hur du distribuerar den h√§r l√∂sningen finns dokumenterad h√§r: <https://blogs.msdn.com/b/saponsqlserver/archive/2014/11/19/protecting-sap-solutions-with-azure-site-recovery.aspx>.

## <a name="summary"></a>Sammanfattning

De viktigaste punkterna med h√∂g tillg√§nglighet f√∂r SAP-system i Azure √§r:

* Vid det h√§r tillf√§llet g√•r det inte att skydda SAP-felpunkten exakt p√• samma s√§tt som den kan g√∂ras i lokala distributioner. Orsaken √§r att delade disk kluster √§nnu inte har skapats i Azure utan anv√§ndning av program fr√•n tredje part.
* F√∂r DBMS-skiktet m√•ste du anv√§nda DBMS-funktioner som inte f√∂rlitar sig p√• delad disk kluster teknik. Information finns dokumenterad i [DBMS-guiden][dbms-guide].
* F√∂r att minimera effekten av problem inom fel dom√§ner i Azure-infrastrukturen eller v√§rd underh√•llet, b√∂r du anv√§nda Azures tillg√§nglighets upps√§ttningar:
  * Vi rekommenderar att du har en tillg√§nglighets upps√§ttning f√∂r SAP-program skiktet.
  * Vi rekommenderar att du har en separat tillg√§nglighets upps√§ttning f√∂r SAP-DBMS-skiktet.
  * Vi rekommenderar inte att du anv√§nder samma tillg√§nglighets upps√§ttning f√∂r virtuella datorer i olika SAP-system.
  * Vi rekommenderar att du anv√§nder Premium Managed Disks.
* F√∂r s√§kerhets kopiering av SAP DBMS-skiktet kontrollerar du [DBMS-guiden][dbms-guide].
* Att s√§kerhetskopiera SAP-dialogrutor √§r mycket bra eftersom det vanligt vis √§r snabbare att omdistribuera enkla dialog instanser.
* S√§kerhets kopiering av den virtuella datorn, som inneh√•ller den globala katalogen i SAP-systemet och med alla profiler f√∂r de olika instanserna, √§r begriplig och b√∂r utf√∂ras med Windows s√§kerhets kopiering eller, till exempel tar p√• Linux. Eftersom det finns skillnader mellan Windows Server 2008 (R2) och Windows Server 2012 (R2), vilket g√∂r det enklare att s√§kerhetskopiera med hj√§lp av de senaste Windows Server-versionerna, rekommenderar vi att du k√∂r Windows Server 2012 (R2) som Windows g√§st operativ system.

## <a name="next-steps"></a>N√§sta steg
L√§s artiklarna:

- [Azure Virtual Machines-distribution f√∂r SAP NetWeaver](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/deployment-guide)
- [√ñverv√§ganden f√∂r Azure Virtual Machines DBMS-distribution f√∂r SAP-arbetsbelastningar](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/dbms_guide_general)
- [SAP HANA infrastruktur konfiguration och √•tg√§rder p√• Azure] (https://docs.microsoft.com/
- Azure/Virtual-Machines/arbets belastningar/SAP/HANA ‚Äì VM-√•tg√§rder)
